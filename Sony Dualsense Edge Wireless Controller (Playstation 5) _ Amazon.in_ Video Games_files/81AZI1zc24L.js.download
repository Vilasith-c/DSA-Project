/*
 For license information please see legacy_bundle.js.LICENSE.txt */
(function(ka){var c=window.AmazonUIPageJS||window.P,$a=c._namespace||c.attributeErrors,R=$a?$a("RufusPanelWebAssetsBuild@legacy","RufusCriticalAssetsBuild"):c;R.guardFatal?R.guardFatal(ka)(R,window):R.execute(function(){ka(R,window)})})(function(ka,c,$a){!function(){function R(g){var c=Cb[g];if(void 0!==c)return c.exports;c=Cb[g]={exports:{}};return $a[g](c,c.exports,R),c.exports}var $a={214:function(g){g.exports=JSON.parse('{"de":{"strings":{"completed_generating_a_response":"Rufus hat die Generierung einer Antwort abgeschlossen","currently_generating_a_response":"Rufus generiert gerade eine Antwort","default_error_message":"Etwas ist schief gelaufen. Bitte versuch es später erneut.","general_error_message":"Es tut uns leid, aber etwas ist schief gelaufen.","offline_error_message":"Oh nein, wir haben die Verbindung verloren.\\nÜberprüfe noch einmal dein Internet und lass es uns dann noch einmal versuchen.","rufus_panel_close":"Rufus-Panel schließen","rufus_panel_open":"Rufus-Panel öffnen"}}}')},
254:function(g){g.exports=JSON.parse('{"und":{"strings":{"completed_generating_a_response":"Rufus has completed generating a response","currently_generating_a_response":"Rufus is currently generating a response","default_error_message":"Something went wrong. Please try again later.","general_error_message":"Sorry, but something went wrong.","offline_error_message":"Oh no, we lost connection.\\nDouble check your internet, then let\'s try this again.","rufus_panel_close":"Close Rufus panel","rufus_panel_open":"Open Rufus panel"}}}')},
602:function(g){g.exports=JSON.parse('{"he":{"strings":{"completed_generating_a_response":"Rufus סיים לייצר תגובה","currently_generating_a_response":"Rufus מייצר עכשיו תגובה","default_error_message":"משהו השתבש. נא לנסות שוב מאוחר יותר.","general_error_message":"מצטערים, אבל משהו השתבש.","offline_error_message":"אוי לא, החיבור אבד.\\nיש לבדוק שוב את האינטרנט שלך, וננסה את זה שוב.","rufus_panel_close":"סגור את חלונית Rufus","rufus_panel_open":"פתח את חלונית Rufus"}}}')},1045:function(g){g.exports=
JSON.parse('{"es":{"strings":{"default_error_message":"Algo salió mal. Inténtalo de nuevo más tarde.","general_error_message":"Lo siento, pero algo salió mal."}},"es-ES":{"strings":{"completed_generating_a_response":"Rufus ha terminado de generar una respuesta","currently_generating_a_response":"Rufus está generando una respuesta","offline_error_message":"Oh, no, hemos perdido la conexión.\\nComprueba tu conexión a Internet y, a continuación, volvamos a intentarlo.","rufus_panel_close":"Cerrar el panel Rufus","rufus_panel_open":"Abrir el panel Rufus"}},"es-US":{"strings":{"completed_generating_a_response":"Rufus terminó de generar una respuesta","currently_generating_a_response":"Rufus está generando una respuesta actualmente","offline_error_message":"Oh, no. Se perdió la conexión.\\nVuelve a verificar tu internet e intenta de nuevo.","rufus_panel_close":"Cerrar panel Rufus","rufus_panel_open":"Abrir panel Rufus"}}}')},
1458:function(g){g.exports.contains=function(g,a){return g.some(function(g){if(a.equals&&a.equals(e)||g===a)return!0})};g.exports.containsKey=function(g,a){if("string"==typeof a){var c=a.toLowerCase();return g.some(function(a,b){if(c===b||"string"==typeof b&&c===b.toLowerCase())return!0})}return!1};g.exports.middleware=function(g,a,c){switch(g.url){case "/esapi/esapi.js":a.sendfile("//public/esapi.js");break;case "/esapi/esapi-compressed.js":a.sendfile("//public/esapi-compressed.js");break;case "/esapi/resources/Base.esapi.properties.js":a.sendfile("//public/resources/Base.esapi.properties.js");
break;case "/esapi/resources/i18n/ESAPI_Standard_en_US.properties.js":a.sendfile("//public/resources/i18n/ESAPI_Standard_en_US.properties.js");break;default:c()}}},2032:function(g,c,a){var J=a(4134),A=a(4326);g.exports=function(a,g,c,C,v){return new A(J().w(a,g,c,C),v||Promise)};g.exports.__esModule=!0;g.exports.default=g.exports},2061:function(g){g.exports=JSON.parse('{"pt":{"strings":{"rufus_panel_open":"Abrir painel Rufus"}},"pt-BR":{"strings":{"completed_generating_a_response":"Rufus concluiu a geração de uma resposta","currently_generating_a_response":"Rufus está gerando uma resposta no momento","default_error_message":"Algo deu errado. Tente novamente mais tarde.","general_error_message":"Desculpe, ocorreu um erro.","offline_error_message":"Ah, não, perdemos a conexão.\\nVerifique sua Internet e, em seguida, vamos tentar novamente.","rufus_panel_close":"Fechar painel Rufus"}},"pt-PT":{"strings":{"completed_generating_a_response":"O Rufus acabou de gerar uma resposta","currently_generating_a_response":"O Rufus está atualmente a gerar uma resposta","default_error_message":"Ocorreu um erro. Tente novamente mais tarde.","general_error_message":"Lamentamos, mas ocorreu um erro.","offline_error_message":"Perdemos a ligação.\\nVerifique novamente a ligação à Internet e, em seguida, vamos tentar novamente.","rufus_panel_close":"Fechar painel do Rufus"}}}')},
2300:function(g){g.exports=JSON.parse('{"ja":{"strings":{"completed_generating_a_response":"ルーファスは応答の生成を完了しました","currently_generating_a_response":"Rufusは現在応答を生成しています","default_error_message":"問題が発生しました。 しばらくしてから、もう一度お試しください。","general_error_message":"申し訳ありませんが、問題が発生しました。","offline_error_message":"申し訳ありませんが、接続が切断されました。\\nインターネットを再確認してから、もう一度試してみましょう。","rufus_panel_close":"ルーファスパネルを閉じる","rufus_panel_open":"ルーファスパネルを開く"}}}')},2960:function(g,c,a){var J=a(3303).default;g.exports=function(a){if(null!=
a){var b=a["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],g=0;if(b)return b.call(a);if("function"==typeof a.next)return a;if(!isNaN(a.length))return{next:function(){return a&&g>=a.length&&(a=void 0),{value:a&&a[g++],done:!a}}}}throw new TypeError(J(a)+" is not iterable");};g.exports.__esModule=!0;g.exports.default=g.exports},3007:function(g,c,a){function J(a){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==
typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},J(a)}c=a(7520)();g.exports=c;try{regeneratorRuntime=c}catch(A){"object"===("undefined"==typeof globalThis?"undefined":J(globalThis))?globalThis.regeneratorRuntime=c:Function("r","regeneratorRuntime \x3d r")(c)}},3132:function(g,c,a){var J=a(2032);g.exports=function(a,b,g,c,C){var v=J(a,b,g,c,C);return v.next().then(function(a){return a.done?a.value:v.next()})};g.exports.__esModule=!0;g.exports.default=g.exports},3278:function(g){g.exports=
JSON.parse('{"ar":{"strings":{"completed_generating_a_response":"أكمل Rufus توليد الاستجابة","currently_generating_a_response":"يقوم Rufus حاليًا بتوليد استجابة","default_error_message":"حدث خطأ ما. يرجى المحاولة مرة أخرى لاحقًا.","general_error_message":"عذرًا، لقد حدث خطأ ما.","offline_error_message":"عذرًا، فقدنا الاتصال.\\nتحقّق مرة أخرى من الإنترنت الخاص بك، ثم دعنا نجرّب ذلك مرة أخرى.","rufus_panel_close":"أغلق لوحة Rufus","rufus_panel_open":"افتح لوحة Rufus"}}}')},3303:function(g){function c(a){return g.exports=
c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},g.exports.__esModule=!0,g.exports.default=g.exports,c(a)}g.exports=c;g.exports.__esModule=!0;g.exports.default=g.exports},3743:function(g){g.exports=JSON.parse('{"ko":{"strings":{"completed_generating_a_response":"Rufus가 응답 생성을 완료했습니다.","currently_generating_a_response":"Rufus가 현재 응답을 생성 중입니다.","default_error_message":"문제가 발생했습니다. 나중에 다시 시도하세요.","general_error_message":"죄송하지만 문제가 발생했습니다.","offline_error_message":"이런, 연결이 끊겼네요.\\n인터넷을 다시 한 번 확인한 다음 다시 시도해 보죠.","rufus_panel_close":"Rufus 패널 닫기","rufus_panel_open":"Rufus 패널 열기"}}}')},
3798:function(g){g.exports=function(g){var a=Object(g),c=[],A;for(A in a)c.unshift(A);return function x(){for(;c.length;)if((A=c.pop())in a)return x.value=A,x.done=!1,x;return x.done=!0,x}};g.exports.__esModule=!0;g.exports.default=g.exports},3847:function(g){g.exports=JSON.parse('{"zh-CN":{"strings":{"completed_generating_a_response":"Rufus 已完成生成回复","currently_generating_a_response":"Rufus 目前正在生成回复","default_error_message":"出错了。 请稍后再试。","general_error_message":"抱歉，出错了。","offline_error_message":"抱歉，我们的连接中断了。\\n仔细检查您的互联网连接，然后再试一次。","rufus_panel_close":"关闭 Rufus 面板","rufus_panel_open":"打开 Rufus 面板"}},"zh-TW":{"strings":{"completed_generating_a_response":"Rufus 已完成產生回應","currently_generating_a_response":"Rufus 目前正在產生回應","default_error_message":"發生錯誤。 請稍後再試一次。","general_error_message":"很抱歉，發生錯誤。","offline_error_message":"哦不，我們的連線中斷了。\\n再次檢查您的網際網路，然後再試一次。","rufus_panel_close":"關閉 Rufus 面板","rufus_panel_open":"打開 Rufus 面板"}}}')},
3907:function(g){g.exports=function(g,a){this.v=g;this.k=a};g.exports.__esModule=!0;g.exports.default=g.exports},4134:function(g,c,a){function J(){function a(a,b,v,g){b=Object.create((b&&b.prototype instanceof c?b:c).prototype);return A(b,"_invoke",function(a,b,v){function g(a,b){C=a;N=b;for(qa=0;!z&&S&&!v&&qa<A.length;qa++){var v,c=A[qa],g=fa.p,x=c[2];3<a?(v=x===b)&&(N=c[(C=c[4])?5:(C=3,3)],c[4]=c[5]=va):c[0]<=g&&((v=2>a&&g<c[1])?(C=0,fa.v=b,fa.n=c[1]):g<x&&(v=3>a||c[0]>b||b>x)&&(c[4]=a,c[5]=b,fa.n=
x,C=0))}if(v||1<a)return Ra;throw z=!0,b;}var c,C,N,S=0,A=v||[],z=!1,fa={p:0,n:0,v:va,a:g,f:g.bind(va,4),d:function(a,b){return c=a,C=0,N=va,fa.n=b,Ra}};return function(v,A,x){if(1<S)throw TypeError("Generator is already running");z&&1===A&&g(A,x);C=A;for(N=x;(qa=2>C?va:N)||!z;){c||(C?3>C?(1<C&&(fa.n=-1),g(C,N)):fa.n=N:fa.v=N);try{if(S=2,c){if(C||(v="next"),qa=c[v]){if(!(qa=qa.call(c,N)))throw TypeError("iterator result is not an object");if(!qa.done)return qa;N=qa.value;2>C&&(C=0)}else 1===C&&(qa=
c.return)&&qa.call(c),2>C&&(N=TypeError("The iterator does not provide a '"+v+"' method"),C=1);c=va}else if((qa=(z=0>fa.n)?N:a.call(b,fa))!==Ra)break}catch(Fb){c=va,C=1,N=Fb}finally{S=1}}return{value:qa,done:z}}}(a,v,g),!0),b}function c(){}function z(){}function C(){}function v(a){return Object.setPrototypeOf?Object.setPrototypeOf(a,C):(a.__proto__=C,A(a,S,"GeneratorFunction")),a.prototype=Object.create(Ca),a}var va,N="function"==typeof Symbol?Symbol:{},fa=N.iterator||"@@iterator",S=N.toStringTag||
"@@toStringTag",Ra={};var qa=Object.getPrototypeOf;N=[][fa]?qa(qa([][fa]())):(A(qa={},fa,function(){return this}),qa);var Ca=C.prototype=c.prototype=Object.create(N);return z.prototype=C,A(Ca,"constructor",C),A(C,"constructor",z),z.displayName="GeneratorFunction",A(C,S,"GeneratorFunction"),A(Ca),A(Ca,S,"Generator"),A(Ca,fa,function(){return this}),A(Ca,"toString",function(){return"[object Generator]"}),(g.exports=J=function(){return{w:a,m:v}},g.exports.__esModule=!0,g.exports.default=g.exports)()}
var A=a(7021);g.exports=J;g.exports.__esModule=!0;g.exports.default=g.exports},4326:function(c,J,a){var g=a(3907),A=a(7021);c.exports=function C(a,c){function v(C,va,S,A){try{var N=a[C](va),fa=N.value;return fa instanceof g?c.resolve(fa.v).then(function(a){v("next",a,S,A)},function(a){v("throw",a,S,A)}):c.resolve(fa).then(function(a){N.value=a;S(N)},function(a){return v("throw",a,S,A)})}catch(Db){A(Db)}}var va;this.next||(A(C.prototype),A(C.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||
"@asyncIterator",function(){return this}));A(this,"_invoke",function(a,g,C){function N(){return new c(function(c,g){v(a,C,c,g)})}return va=va?va.then(N,N):N()},!0)};c.exports.__esModule=!0;c.exports.default=c.exports},7021:function(c){function g(a,J,A,b){var x=Object.defineProperty;try{x({},"",{})}catch(z){x=0}c.exports=g=function(a,b,v,c){b?x?x(a,b,{value:v,enumerable:!c,configurable:!c,writable:!c}):a[b]=v:(b=function(b,v){g(a,b,function(a){return this._invoke(b,v,a)})},b("next",0),b("throw",1),
b("return",2))};c.exports.__esModule=!0;c.exports.default=c.exports;g(a,J,A,b)}c.exports=g;c.exports.__esModule=!0;c.exports.default=c.exports},7520:function(c,J,a){function g(){function a(a){a="function"==typeof a&&a.constructor;return!!a&&(a===qa||"GeneratorFunction"===(a.displayName||a.name))}function fa(a){var b,c;return function(v){b||(b={stop:function(){return c(v.a,2)},catch:function(){return v.v},abrupt:function(a,b){return c(v.a,R[a],b)},delegateYield:function(a,g,C){return b.resultName=
g,c(v.d,va(a),C)},finish:function(a){return c(v.f,a)}},c=function(a,c,g){v.p=b.prev;v.n=b.next;try{return a(c,g)}finally{b.next=v.n}});b.resultName&&(b[b.resultName]=v.v,b.resultName=void 0);b.sent=v.v;b.next=v.n;try{return a.call(this,b)}finally{v.p=b.prev,v.n=b.next}}}var S=b(),J=S.m(g),qa=(Object.getPrototypeOf?Object.getPrototypeOf(J):J.__proto__).constructor,R={throw:1,return:2,break:3,continue:3};return(c.exports=g=function(){return{wrap:function(a,b,v,c){return S.w(fa(a),b,v,c&&c.reverse())},
isGeneratorFunction:a,mark:S.m,awrap:function(a,b){return new A(a,b)},AsyncIterator:C,async:function(b,v,c,g,C){return(a(v)?z:x)(fa(b),v,c,g,C)},keys:v,values:va}},c.exports.__esModule=!0,c.exports.default=c.exports)()}var A=a(3907),b=a(4134),x=a(3132),z=a(2032),C=a(4326),v=a(3798),va=a(2960);c.exports=g;c.exports.__esModule=!0;c.exports.default=c.exports},7992:function(c){c.exports=JSON.parse('{"it":{"strings":{"completed_generating_a_response":"Rufus ha completato la generazione di una risposta","currently_generating_a_response":"Rufus sta attualmente generando una risposta","default_error_message":"Si è verificato un errore. Riprova più tardi.","general_error_message":"Siamo spiacenti, ma si è verificato un problema.","offline_error_message":"Oh no, abbiamo perso la connessione.\\nRicontrolla la connessione internet, poi riproviamo.","rufus_panel_close":"Chiudi il pannello Rufus","rufus_panel_open":"Apri il pannello Rufus"}}}')},
8295:function(c,J,a){var g=a(1458),A={codecs:{}};A.codecs.Codec=function(){return{encode:function(a,b){for(var c="",v=0;v<b.length;v++){var g=b.charAt(v);c+=this.encodeCharacter(a,g)}return c},encodeCharacter:function(a,b){return b},decode:function(a){var b="";for(a=new A.codecs.PushbackString(a);a.hasNext();){var c=this.decodeCharacter(a);b+=null!=c?c:a.next()}return b},decodeCharacter:function(a){return a.next()}}};A.codecs.Codec.getHexForNonAlphanumeric=function(a){return 256>a.charCodeAt(0)?A.codecs.Codec.hex[a.charCodeAt(0)]:
a.charCodeAt(0).toString(16)};A.codecs.Codec.hex=[];for(J=0;255>J;J++)A.codecs.Codec.hex[J]=48<=J&&57>=J||65<=J&&90>=J||97<=J&&122>=J?null:J.toString(16);A.codecs.Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d",encode:function(a){if(!a)return null;for(var b,c,g,C,S,x="",z=0,J=A.codecs.UTF8.encode(a);z<J.length;)a=(b=J.charCodeAt(z++))>>2,g=(3&b)<<4|(b=J.charCodeAt(z++))>>4,C=(15&b)<<2|(c=J.charCodeAt(z++))>>6,S=63&c,isNaN(b)?C=S=64:isNaN(c)&&(S=64),x+=this._keyStr.charAt(a)+
this._keyStr.charAt(g)+this._keyStr.charAt(C)+this._keyStr.charAt(S);return x},decode:function(a){if(!a)return null;for(var b,c,g,C,S="",x=0,z=a.replace(/[^A-Za-z0-9\+\/=]/g,"");x<z.length;)a=this._keyStr.indexOf(z.charAt(x++))<<2|(b=this._keyStr.indexOf(z.charAt(x++)))>>4,b=(15&b)<<4|(g=this._keyStr.indexOf(z.charAt(x++)))>>2,c=(3&g)<<6|(C=this._keyStr.indexOf(z.charAt(x++))),S+=String.fromCharCode(a),64!=g&&(S+=String.fromCharCode(b)),64!=C&&(S+=String.fromCharCode(c));return A.codecs.UTF8.decode(S)}};
A.codecs.CSSCodec=function(){var a=new A.codecs.Codec;return{encode:a.encode,decode:a.decode,encodeCharacter:function(a,b){if(g.contains(a,b))return b;a=A.codecs.Codec.getHexForNonAlphanumeric(b);return null==a?b:"\\"+a+" "},decodeCharacter:function(a){a.mark();var b=a.next();if(null==b||"\\"!=b)return a.reset(),null;b=a.next();if(null==b)return a.reset(),null;if(a.isHexDigit(b)){for(var c=0;6>c;c++){var v=a.next();if(null==v||32==v.charCodeAt(0))break;if(!a.isHexDigit(v)){input.pushback(v);break}b+=
v}try{var g=parseInt(b,16);return String.fromCharCode(g)}catch(Ra){return a.reset(),null}}return b}}};var b=[];b["\x26quot"]="34";b["\x26amp"]="38";b["\x26lt"]="60";b["\x26gt"]="62";b["\x26nbsp"]="160";b["\x26iexcl"]="161";b["\x26cent"]="162";b["\x26pound"]="163";b["\x26curren"]="164";b["\x26yen"]="165";b["\x26brvbar"]="166";b["\x26sect"]="167";b["\x26uml"]="168";b["\x26copy"]="169";b["\x26ordf"]="170";b["\x26laquo"]="171";b["\x26not"]="172";b["\x26shy"]="173";b["\x26reg"]="174";b["\x26macr"]="175";
b["\x26deg"]="176";b["\x26plusmn"]="177";b["\x26sup2"]="178";b["\x26sup3"]="179";b["\x26acute"]="180";b["\x26micro"]="181";b["\x26para"]="182";b["\x26middot"]="183";b["\x26cedil"]="184";b["\x26sup1"]="185";b["\x26ordm"]="186";b["\x26raquo"]="187";b["\x26frac14"]="188";b["\x26frac12"]="189";b["\x26frac34"]="190";b["\x26iquest"]="191";b["\x26Agrave"]="192";b["\x26Aacute"]="193";b["\x26Acirc"]="194";b["\x26Atilde"]="195";b["\x26Auml"]="196";b["\x26Aring"]="197";b["\x26AElig"]="198";b["\x26Ccedil"]="199";
b["\x26Egrave"]="200";b["\x26Eacute"]="201";b["\x26Ecirc"]="202";b["\x26Euml"]="203";b["\x26Igrave"]="204";b["\x26Iacute"]="205";b["\x26Icirc"]="206";b["\x26Iuml"]="207";b["\x26ETH"]="208";b["\x26Ntilde"]="209";b["\x26Ograve"]="210";b["\x26Oacute"]="211";b["\x26Ocirc"]="212";b["\x26Otilde"]="213";b["\x26Ouml"]="214";b["\x26times"]="215";b["\x26Oslash"]="216";b["\x26Ugrave"]="217";b["\x26Uacute"]="218";b["\x26Ucirc"]="219";b["\x26Uuml"]="220";b["\x26Yacute"]="221";b["\x26THORN"]="222";b["\x26szlig"]=
"223";b["\x26agrave"]="224";b["\x26aacute"]="225";b["\x26acirc"]="226";b["\x26atilde"]="227";b["\x26auml"]="228";b["\x26aring"]="229";b["\x26aelig"]="230";b["\x26ccedil"]="231";b["\x26egrave"]="232";b["\x26eacute"]="233";b["\x26ecirc"]="234";b["\x26euml"]="235";b["\x26igrave"]="236";b["\x26iacute"]="237";b["\x26icirc"]="238";b["\x26iuml"]="239";b["\x26eth"]="240";b["\x26ntilde"]="241";b["\x26ograve"]="242";b["\x26oacute"]="243";b["\x26ocirc"]="244";b["\x26otilde"]="245";b["\x26ouml"]="246";b["\x26divide"]=
"247";b["\x26oslash"]="248";b["\x26ugrave"]="249";b["\x26uacute"]="250";b["\x26ucirc"]="251";b["\x26uuml"]="252";b["\x26yacute"]="253";b["\x26thorn"]="254";b["\x26yuml"]="255";b["\x26OElig"]="338";b["\x26oelig"]="339";b["\x26Scaron"]="352";b["\x26scaron"]="353";b["\x26Yuml"]="376";b["\x26fnof"]="402";b["\x26circ"]="710";b["\x26tilde"]="732";b["\x26Alpha"]="913";b["\x26Beta"]="914";b["\x26Gamma"]="915";b["\x26Delta"]="916";b["\x26Epsilon"]="917";b["\x26Zeta"]="918";b["\x26Eta"]="919";b["\x26Theta"]=
"920";b["\x26Iota"]="921";b["\x26Kappa"]="922";b["\x26Lambda"]="923";b["\x26Mu"]="924";b["\x26Nu"]="925";b["\x26Xi"]="926";b["\x26Omicron"]="927";b["\x26Pi"]="928";b["\x26Rho"]="929";b["\x26Sigma"]="931";b["\x26Tau"]="932";b["\x26Upsilon"]="933";b["\x26Phi"]="934";b["\x26Chi"]="935";b["\x26Psi"]="936";b["\x26Omega"]="937";b["\x26alpha"]="945";b["\x26beta"]="946";b["\x26gamma"]="947";b["\x26delta"]="948";b["\x26epsilon"]="949";b["\x26zeta"]="950";b["\x26eta"]="951";b["\x26theta"]="952";b["\x26iota"]=
"953";b["\x26kappa"]="954";b["\x26lambda"]="955";b["\x26mu"]="956";b["\x26nu"]="957";b["\x26xi"]="958";b["\x26omicron"]="959";b["\x26pi"]="960";b["\x26rho"]="961";b["\x26sigmaf"]="962";b["\x26sigma"]="963";b["\x26tau"]="964";b["\x26upsilon"]="965";b["\x26phi"]="966";b["\x26chi"]="967";b["\x26psi"]="968";b["\x26omega"]="969";b["\x26thetasym"]="977";b["\x26upsih"]="978";b["\x26piv"]="982";b["\x26ensp"]="8194";b["\x26emsp"]="8195";b["\x26thinsp"]="8201";b["\x26zwnj"]="8204";b["\x26zwj"]="8205";b["\x26lrm"]=
"8206";b["\x26rlm"]="8207";b["\x26ndash"]="8211";b["\x26mdash"]="8212";b["\x26lsquo"]="8216";b["\x26rsquo"]="8217";b["\x26sbquo"]="8218";b["\x26ldquo"]="8220";b["\x26rdquo"]="8221";b["\x26bdquo"]="8222";b["\x26dagger"]="8224";b["\x26Dagger"]="8225";b["\x26bull"]="8226";b["\x26hellip"]="8230";b["\x26permil"]="8240";b["\x26prime"]="8242";b["\x26Prime"]="8243";b["\x26lsaquo"]="8249";b["\x26rsaquo"]="8250";b["\x26oline"]="8254";b["\x26frasl"]="8260";b["\x26euro"]="8364";b["\x26image"]="8365";b["\x26weierp"]=
"8472";b["\x26real"]="8476";b["\x26trade"]="8482";b["\x26alefsym"]="8501";b["\x26larr"]="8592";b["\x26uarr"]="8593";b["\x26rarr"]="8594";b["\x26darr"]="8595";b["\x26harr"]="8596";b["\x26crarr"]="8629";b["\x26lArr"]="8656";b["\x26uArr"]="8657";b["\x26rArr"]="8658";b["\x26dArr"]="8659";b["\x26hArr"]="8660";b["\x26forall"]="8704";b["\x26part"]="8706";b["\x26exist"]="8707";b["\x26empty"]="8709";b["\x26nabla"]="8711";b["\x26isin"]="8712";b["\x26notin"]="8713";b["\x26ni"]="8715";b["\x26prod"]="8719";b["\x26sum"]=
"8721";b["\x26minus"]="8722";b["\x26lowast"]="8727";b["\x26radic"]="8730";b["\x26prop"]="8733";b["\x26infin"]="8734";b["\x26ang"]="8736";b["\x26and"]="8743";b["\x26or"]="8744";b["\x26cap"]="8745";b["\x26cup"]="8746";b["\x26int"]="8747";b["\x26there4"]="8756";b["\x26sim"]="8764";b["\x26cong"]="8773";b["\x26asymp"]="8776";b["\x26ne"]="8800";b["\x26equiv"]="8801";b["\x26le"]="8804";b["\x26ge"]="8805";b["\x26sub"]="8834";b["\x26sup"]="8835";b["\x26nsub"]="8836";b["\x26sube"]="8838";b["\x26supe"]="8839";
b["\x26oplus"]="8853";b["\x26otimes"]="8855";b["\x26perp"]="8869";b["\x26sdot"]="8901";b["\x26lceil"]="8968";b["\x26rceil"]="8969";b["\x26lfloor"]="8970";b["\x26rfloor"]="8971";b["\x26lang"]="9001";b["\x26rang"]="9002";b["\x26loz"]="9674";b["\x26spades"]="9824";b["\x26clubs"]="9827";b["\x26hearts"]="9829";b["\x26diams"]="9830";var x=[],z;for(z in b)x[b[z]]=z;A.codecs.HTMLEntityCodec=function(){var a=new A.codecs.Codec;return{encode:a.encode,decode:a.decode,encodeCharacter:function(a,b){if(g.contains(a,
b))return b;a=A.codecs.Codec.getHexForNonAlphanumeric(b);if(null==a)return b;var c=b.charCodeAt(0);if(31>=c&&"\t"!=b&&"\n"!=b&&"\r"!=b||127<=c&&159>=c||" "==b)return" ";b=x[c];return null!=b?b+";":"\x26#x"+a+";"},decodeCharacter:function(a){a.mark();var c=a.next();if(null==c||"\x26"!=c)return a.reset(),null;c=a.next();if(null==c)return a.reset(),null;if("#"==c){var v=function(a){var b=a.peek();return null==b?null:"x"==b||"X"==b?(a.next(),function(a){for(var b="";a.hasNext();){var c=a.peek();if(!c.match(/[0-9A-Fa-f]/)){if(";"==
c){a.next();break}break}b+=c;a.next()}try{return parseInt(b,16)}catch(Db){return null}}(a)):function(a){for(var b="";a.hasNext();){var c=a.peek();if(!c.match(/[0-9]/)){if(";"==c){a.next();break}break}b+=c;a.next()}try{return parseInt(b)}catch(Db){return null}}(a)}(a);if(null!=v)return v}else if(c.match(/[A-Za-z]/)&&(a.pushback(c),v=function(a){for(var c="";a.hasNext();){var v=a.peek();if(v.match(/[A-Za-z]/)){if(c+=v,a.next(),g.containsKey(b,"\x26"+c)){a.peek(";")&&a.next();break}}else{if(";"!=v)break;
a.next()}}return String.fromCharCode(b.getCaseInsensitive("\x26"+c))}(a),null!=v))return v;return a.reset(),null}}};A.codecs.JavascriptCodec=function(){return{encode:function(a,b){for(var c="",v=0;v<b.length;v++){var C=b.charAt(v);if(g.contains(a,C))c+=C;else if(null==A.codecs.Codec.getHexForNonAlphanumeric(C))c+=C;else{var x=C.charCodeAt(0).toString(16);256>C.charCodeAt(0)?(C="00".substr(x.length),c+="\\x"+C+x.toUpperCase()):c+="\\u"+"0000".substr(x.length)+x.toUpperCase()}}return c},decode:(new A.codecs.Codec).decode,
decodeCharacter:function(a){a.mark();var b=a.next();if(null==b||"\\"!=b)return a.reset(),null;b=a.next();if(null==b)return a.reset(),null;if("b"==b)return 8;if("t"==b)return 9;if("n"==b)return 10;if("v"==b)return 11;if("f"==b)return 12;if("r"==b)return 13;if('"'==b)return 34;if("'"==b)return 39;if("\\"==b)return 92;if("x"==b.toLowerCase()){b="";for(var c=0;2>c;c++){var g=a.nextHex();if(null==g)return input.reset(),null;b+=g}try{return C=parseInt(b,16),String.fromCharCode(C)}catch(S){return a.reset(),
null}}else if("u"==b.toLowerCase()){b="";for(c=0;4>c;c++){if(null==(g=a.nextHex()))return input.reset(),null;b+=g}try{var C=parseInt(b,16);return String.fromCharCode(C)}catch(S){return a.reset(),null}}else if(a.isOctalDigit(b)){c=a.next();a.isOctalDigit(c)?(b+=c,c=a.next(),a.isOctalDigit(c)?b+=c:a.pushback(c)):a.pushback(c);try{return C=parseInt(b,8),String.fromCharCode(C)}catch(S){return a.reset(),null}}return b}}};A.codecs.PercentCodec=function(){var a=new A.codecs.Codec;return{encode:a.encode,
decode:a.decode,encodeCharacter:function(a,b){if(-1<"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".indexOf(b))return b;a=A.codecs.UTF8.encode(b);var c="";for(b=0;b<a.length;b++){var g=a.charCodeAt(b),v="";if(-128>g||127<g)throw new IllegalArgumentException("b is not a byte (was "+g+")");var C=(16>(g&=255)&&(v+="0"),v+g.toString(16).toUpperCase());c+="%"+C}return c},decodeCharacter:function(a){a.mark();var b=a.next();if(null==b||"%"!=b)return a.reset(),null;b="";for(var c=0;2>c;c++){var g=
a.nextHex();null!=g&&(b+=g)}if(2==b.length)try{var v=parseInt(b,16);return String.fromCharCode(v)}catch(Ra){}return a.reset(),null}}};A.codecs.PushbackString=function(a){var b="",c="",g=0,x=0;return{pushback:function(a){b=a},index:function(){return g},hasNext:function(){return null!=b||!(null==a||0==a.length||g>=a.length)},next:function(){if(null!=b){var c=b;return b=null,c}return null==a||0==a.length||g>=a.length?null:a.charAt(g++)},nextHex:function(){var a=this.next();return this.isHexDigit(a)?
a:null},nextOctal:function(){var a=this.next();return this.isOctalDigit(a)?a:null},isHexDigit:function(a){return null!=a&&("0"<=a&&"9">=a||"a"<=a&&"f">=a||"A"<=a&&"F">=a)},isOctalDigit:function(a){return null!=a&&"0"<=a&&"7">=a},peek:function(c){return c?null!=b&&b==c||!(null==a||0==a.length||g>=a.length)&&a.charAt(g)==c:null!=b?b:null==a||0==a.length||g>=a.length?null:a.charAt(g)},mark:function(){c=b;x=g},reset:function(){b=c;g=x},remainder:function(){var c=a.substr(g);return null!=b&&(c=b+c),c}}};
A.codecs.UTF8={encode:function(a){a=a.replace(/\r\n/g,"\n");for(var b="",c=0;c<a.length;c++){var g=a.charCodeAt(c);128>g?b+=String.fromCharCode(g):127<g&&2048>g?(b+=String.fromCharCode(g>>6|192),b+=String.fromCharCode(63&g|128)):(b+=String.fromCharCode(g>>12|224),b+=String.fromCharCode(g>>6&63|128),b+=String.fromCharCode(63&g|128))}return b},decode:function(a){var b,c,g,x,A="";for(b=c=g=0;b<a.length;)128>(c=a.charCodeAt(b))?(A+=String.fromCharCode(c),b++):191<c&&224>c?(g=a.charCodeAt(b+1),A+=String.fromCharCode((31&
c)<<6|63&g),b+=2):(g=utftext.charCodeAt(b+1),x=utftext.charCodeAt(b+2),String.fromCharCode((15&c)<<12|(63&g)<<6|63&x),b+=3);return A}};A.DefaultEncoder=function(a){var b=[],c=new A.codecs.HTMLEntityCodec,g=new A.codecs.JavascriptCodec,x=new A.codecs.CSSCodec,z=new A.codecs.PercentCodec;a?b=a:(b.push(c),b.push(g),b.push(x),b.push(z));var C=[",",".","-","_"," "],J=[",",".","-","_"],R=[],ka=[",",".","_"];return{cananicalize:function(a,c){if(!a)return null;for(var g=a,v=null,x=1,z=0,C=!1;!C;)C=!0,b.each(function(a){g!=
(g=a.decode(g))&&(null!=v&&v!=a&&x++,v=a,C&&z++,C=!1)});if(2<=z&&1<x){if(c)throw new A.IntrusionException("Input validation failure","Multiple ("+z+"x) and mixed encoding ("+x+"x) detected in "+a);}else if(2<=z){if(c)throw new A.IntrusionException("Input validation failure","Multiple ("+z+"x) encoding detected in "+a);}else if(1<x&&c)throw new A.IntrusionException("Input validation failure","Mixed ("+x+"x) encoding detected in "+a);return g},normalize:function(a){return a.replace(/[^\x00-\x7F]/g,
"")},encodeForHTML:function(a){return a?c.encode(C,a):null},decodeForHTML:function(a){return a?c.decode(a):null},encodeForHTMLAttribute:function(a){return a?c.encode(J,a):null},encodeForCSS:function(a){return a?x.encode(R,a):null},encodeForJavaScript:function(a){return a?g.encode(ka,a):null},encodeForJavascript:this.encodeForJavaScript,encodeForJS:this.encodeForJavascript,encodeForURL:function(a){return a?escape(a):null},decodeFromURL:function(a){return a?unescape(a):null},encodeForBase64:function(a){return a?
A.codecs.Base64.encode(a):null},decodeFromBase64:function(a){return a?A.codecs.Base64.decode(a):null}}};c.exports={encoder:function(){return A.DefaultEncoder()},middleware:function(){return g.middleware}}},8494:function(c){c.exports=JSON.parse('{"en":{"strings":{"completed_generating_a_response":"Rufus has completed generating a response","currently_generating_a_response":"Rufus is currently generating a response","default_error_message":"Something went wrong. Please try again later.","general_error_message":"Sorry, but something went wrong.","offline_error_message":"Oh no, we lost connection.\\nDouble check your internet, then let\'s try this again.","rufus_panel_close":"Close Rufus panel","rufus_panel_open":"Open Rufus panel"}},"en-CA":{"strings":{}},"en-GB":{"strings":{}},"en-IN":{"strings":{}},"en-US":{"strings":{}}}')},
8925:function(c){c.exports=JSON.parse('{"fr":{"strings":{"general_error_message":"Nous sommes désolés, une erreur s’est produite.","rufus_panel_close":"Fermer le panneau Rufus","rufus_panel_open":"Ouvrir le panneau Rufus"}},"fr-CA":{"strings":{"completed_generating_a_response":"Rufus a terminé de générer une réponse","currently_generating_a_response":"Rufus génère actuellement une réponse","default_error_message":"Une erreur s’est produite. Veuillez réessayer plus tard.","offline_error_message":"Oh non, nous avons perdu la connexion.\\nVérifiez votre connexion Internet, puis essayons à nouveau."}},"fr-FR":{"strings":{"completed_generating_a_response":"Rufus a fini de générer une réponse","currently_generating_a_response":"Rufus est en train de générer une réponse","default_error_message":"Une erreur s\'est produite. Réessayez ultérieurement.","offline_error_message":"Oh non, nous avons perdu la connexion.\\nVérifiez à nouveau votre connexion Internet, puis réessayez."}}}')}},
Cb={};R.n=function(c){var g=c&&c.__esModule?function(){return c.default}:function(){return c};return R.d(g,{a:g}),g};R.d=function(c,J){for(var a in J)R.o(J,a)&&!R.o(c,a)&&Object.defineProperty(c,a,{enumerable:!0,get:J[a]})};R.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||(new Function("return this"))()}catch(g){if("object"==typeof c)return c}}();R.o=function(c,J){return Object.prototype.hasOwnProperty.call(c,J)};(function(){function g(a){return g="function"==typeof Symbol&&
"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},g(a)}function J(a){a:if("object"==g(a)&&a){var u=a[Symbol.toPrimitive];if(void 0!==u){a=u.call(a,"string");if("object"!=g(a))break a;throw new TypeError("@@toPrimitive must return a primitive value.");}a=String(a)}return"symbol"==g(a)?a:a+""}function a(a,n,b){return(n=J(n))in a?Object.defineProperty(a,n,{value:b,enumerable:!0,
configurable:!0,writable:!0}):a[n]=b,a}function $a(a,n,b,c,g,Sa,m){try{var u=a[Sa](m),la=u.value}catch(I){return void b(I)}u.done?n(la):Promise.resolve(la).then(c,g)}function A(a){return function(){var u=this,b=arguments;return new Promise(function(n,la){function c(a){$a(g,n,la,c,aa,"next",a)}function aa(a){$a(g,n,la,c,aa,"throw",a)}var g=a.apply(u,b);c(void 0)})}}function b(a,n){for(var u=0;u<n.length;u++){var b=n[u];b.enumerable=b.enumerable||!1;b.configurable=!0;"value"in b&&(b.writable=!0);Object.defineProperty(a,
J(b.key),b)}}function x(a,n,la){return n&&b(a.prototype,n),la&&b(a,la),Object.defineProperty(a,"prototype",{writable:!1}),a}function z(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function");}function C(a,n){if(n&&("object"==g(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function v(a){return v=
Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},v(a)}function va(a,n){return va=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,u){return a.__proto__=u,a},va(a,n)}function N(a,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(n&&n.prototype,{constructor:{value:a,writable:!0,configurable:!0}});Object.defineProperty(a,"prototype",{writable:!1});
n&&va(a,n)}function fa(a){var u=document.getElementById("nav-flyout-rufus");if(u)return u=u.getElementsByTagName("input"),(u=Array.from(u).find(function(u){return u.name===a}))&&u.value?u.value:""}function S(){return crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var u=16*Math.random()|0;return("x"==a?u:3&u|8).toString(16)})}function Ra(a,n){(null==n||n>a.length)&&(n=a.length);for(var u=0,b=Array(n);u<n;u++)b[u]=a[u];return b}function qa(a,
n){if(a){if("string"==typeof a)return Ra(a,n);var u={}.toString.call(a).slice(8,-1);return"Object"===u&&a.constructor&&(u=a.constructor.name),"Map"===u||"Set"===u?Array.from(a):"Arguments"===u||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(u)?Ra(a,n):void 0}}function Ca(a,n){if(!(a=function(a){if(Array.isArray(a))return a}(a)||function(a,u){var n=null==a?null:"undefined"!=typeof Symbol&&a[Symbol.iterator]||a["@@iterator"];if(null!=n){var b,c,la,aa=[],I=!0,k=!1;try{if(c=(n=n.call(a)).next,0===u){if(Object(n)!==
n)return;I=!1}else for(;!(I=(b=c.call(n)).done)&&(aa.push(b.value),aa.length!==u);I=!0);}catch(d){k=!0;var w=d}finally{try{if(!I&&null!=n.return&&(la=n.return(),Object(la)!==la))return}finally{if(k)throw w;}}return aa}}(a,n)||qa(a,n)))throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");return a}function Db(){var a=navigator.userAgent;for(var n="",b="",c=0,g=Object.entries({Chrome:/Chrome\/(\d+\.\d+\.\d+\.\d+)/i,
Firefox:/Firefox\/(\d+\.\d+)/i,Safari:/Version\/(\d+(\.\d+)+)\s+Safari\/(\d+(\.\d+)+)/i,Edge:/Edge\/(\d+\.\d+\.\d+)/i,IE:/(MSIE |Trident\/\d+\.\d+;.*rv:(\d+\.\d+))/i});c<g.length;c++){var m=Ca(g[c],2),p=m[0];if((m=a.match(m[1]))&&2<=m.length){n=p;b=m[1];break}}a=a.match(/Win(?:dows)?\s?(\d+\.\d+)?/)?"Windows":a.match(/Mac(?:intosh| OS X)?\s?(\d+_\d+(_\d+)?)?/)?"MacOS":a.match(/Linux/)?"Linux":"Other";Kg.getInstance().browserVersion="".concat(b);ye.getInstance().browserName="".concat(n);Lg.getInstance().osType=
"".concat(a);ze.getInstance().deviceVersion="".concat(a,"_").concat(n,"_").concat(b)}function Cb(a,n){var u=Object.keys(a);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(a);n&&(b=b.filter(function(u){return Object.getOwnPropertyDescriptor(a,u).enumerable}));u.push.apply(u,b)}return u}function gd(u){for(var n=1;n<arguments.length;n++){var b=null!=arguments[n]?arguments[n]:{};n%2?Cb(Object(b),!0).forEach(function(n){a(u,n,b[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(u,
Object.getOwnPropertyDescriptors(b)):Cb(Object(b)).forEach(function(a){Object.defineProperty(u,a,Object.getOwnPropertyDescriptor(b,a))})}return u}function qe(a){var u=(new Date).toISOString(),b=S(),c=pb.getInstance().nileRequestId,g=pb.getInstance().nileRequestId;a=Hg(a);var m=ze.getInstance().deviceVersion,p=fa("locale"),wa=fa("marketplaceId"),ja=Ae.getInstance().tabId,I="";try{var k=document.cookie.match(/(?:^|;)\s*session-id\s*=\s*([^\s;]+)/);k&&(I=k[1])}catch(w){I=""}return{timestamp:u,messageId:b,
nileRequestId:c,clickstreamRequestId:g,metadata:a,isBeta:!1,deviceTypeId:"",directedCustomerId:"",appVersion:m,locale:p,marketplaceId:wa,uxSessionId:ja,sessionId:I,obfuscatedCustomerId:fa("customerId")}}function Hg(){var a=gd({program:"nile-classic-desktop"},0<arguments.length&&void 0!==arguments[0]?arguments[0]:{});return JSON.stringify(a)}function O(a,n,b){a=gd(gd({},qe(b)),{},{eventName:a,eventDetail:n,eventTimeUTC:(new Date).toISOString()});m.logEvent(function(a){for(var n=Object.keys(a),b=0;b<
n.length;b++){var u=n[b],c=a[u];null==c?c="":"number"==typeof c&&(c=c.toString());a[u]=c}return a}(a),"desktop-nile",Mg.EVENT_SCHEMA)}function re(a,b){(null==b||b>a.length)&&(b=a.length);for(var u=0,n=Array(b);u<b;u++)n[u]=a[u];return n}function se(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(n){}return(se=function(){return!!a})()}function xe(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(n){}return(xe=
function(){return!!a})()}function te(a,b){var n=Object.keys(a);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(a);b&&(u=u.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable}));n.push.apply(n,u)}return n}function Ig(b){for(var n=1;n<arguments.length;n++){var u=null!=arguments[n]?arguments[n]:{};n%2?te(Object(u),!0).forEach(function(n){a(b,n,u[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(u)):te(Object(u)).forEach(function(a){Object.defineProperty(b,
a,Object.getOwnPropertyDescriptor(u,a))})}return b}function ve(a,b){var n=Object.keys(a);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(a);b&&(u=u.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable}));n.push.apply(n,u)}return n}function hd(b){for(var n=1;n<arguments.length;n++){var u=null!=arguments[n]?arguments[n]:{};n%2?ve(Object(u),!0).forEach(function(n){a(b,n,u[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(u)):
ve(Object(u)).forEach(function(a){Object.defineProperty(b,a,Object.getOwnPropertyDescriptor(u,a))})}return b}function ue(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(n){}return(ue=function(){return!!a})()}function we(a,b,c,aa,g,m,p){try{var n=a[m](p),u=n.value}catch(I){return void c(I)}n.done?b(u):Promise.resolve(u).then(aa,g)}function ib(a){return function(){var b=this,u=arguments;return new Promise(function(n,c){function la(a){we(g,n,c,la,aa,"next",
a)}function aa(a){we(g,n,c,la,aa,"throw",a)}var g=a.apply(b,u);la(void 0)})}}function Wb(a){var b="function"==typeof Map?new Map:void 0;return Wb=function(a){function n(){return Eb(a,arguments,jb(this).constructor)}if(null===a||!function(a){try{return-1!==Function.toString.call(a).indexOf("[native code]")}catch(Sa){return"function"==typeof a}}(a))return a;if("function"!=typeof a)throw new TypeError("Super expression must either be null or a function");if(void 0!==b){if(b.has(a))return b.get(a);b.set(a,
n)}return n.prototype=Object.create(a.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Gb(n,a)},Wb(a)}function Eb(a,b,c){if(jd())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,b);n=new (a.bind.apply(a,n));return c&&Gb(n,c.prototype),n}function Fb(a,b,c){return(b=Be(b))in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function na(){function a(a,w,n,u){w=Object.create((w&&w.prototype instanceof b?w:b).prototype);
return Ga(w,"_invoke",function(a,h,d){function l(a,h){w=a;b=h;for(k=0;!B&&n&&!f&&k<u.length;k++){var f,d=u[k],l=y.p,r=d[2];3<a?(f=r===h)&&(b=d[(w=d[4])?5:(w=3,3)],d[4]=d[5]=m):d[0]<=l&&((f=2>a&&l<d[1])?(w=0,y.v=h,y.n=d[1]):l<r&&(f=3>a||d[0]>h||h>r)&&(d[4]=a,d[5]=h,y.n=r,w=0))}if(f||1<a)return I;throw B=!0,h;}var f,w,b,n=0,u=d||[],B=!1,y={p:0,n:0,v:m,a:l,f:l.bind(m,4),d:function(k,a){return f=k,w=0,b=m,y.n=a,I}};return function(d,r,u){if(1<n)throw TypeError("Generator is already running");B&&1===r&&
l(r,u);w=r;for(b=u;(k=2>w?m:b)||!B;){f||(w?3>w?(1<w&&(y.n=-1),l(w,b)):y.n=b:y.v=b);try{if(n=2,f){if(w||(d="next"),k=f[d]){if(!(k=k.call(f,b)))throw TypeError("iterator result is not an object");if(!k.done)return k;b=k.value;2>w&&(w=0)}else 1===w&&(k=f.return)&&k.call(f),2>w&&(b=TypeError("The iterator does not provide a '"+d+"' method"),w=1);f=m}else if((k=(B=0>y.n)?b:a.call(h,y))!==I)break}catch(md){f=m,w=1,b=md}finally{n=1}}return{value:k,done:B}}}(a,n,u),!0),w}function b(){}function c(){}function aa(){}
function g(k){return Object.setPrototypeOf?Object.setPrototypeOf(k,aa):(k.__proto__=aa,Ga(k,ja,"GeneratorFunction")),k.prototype=Object.create(w),k}var m,p="function"==typeof Symbol?Symbol:{},wa=p.iterator||"@@iterator",ja=p.toStringTag||"@@toStringTag",I={};var k=Object.getPrototypeOf;p=[][wa]?k(k([][wa]())):(Ga(k={},wa,function(){return this}),k);var w=aa.prototype=b.prototype=Object.create(p);return c.prototype=aa,Ga(w,"constructor",aa),Ga(aa,"constructor",c),c.displayName="GeneratorFunction",
Ga(aa,ja,"GeneratorFunction"),Ga(w),Ga(w,ja,"Generator"),Ga(w,wa,function(){return this}),Ga(w,"toString",function(){return"[object Generator]"}),(na=function(){return{w:a,m:g}})()}function Ga(a,b,c,aa){var n=Object.defineProperty;try{n({},"",{})}catch(Sa){n=0}Ga=function(a,b,u,c){b?n?n(a,b,{value:u,enumerable:!c,configurable:!c,writable:!c}):a[b]=u:(b=function(b,k){Ga(a,b,function(a){return this._invoke(b,k,a)})},b("next",0),b("throw",1),b("return",2))};Ga(a,b,c,aa)}function Ta(a,b){if(!(a=function(a){if(Array.isArray(a))return a}(a)||
function(a,b){var n=null==a?null:"undefined"!=typeof Symbol&&a[Symbol.iterator]||a["@@iterator"];if(null!=n){var u,c,la,aa=[],I=!0,k=!1;try{if(c=(n=n.call(a)).next,0===b){if(Object(n)!==n)return;I=!1}else for(;!(I=(u=c.call(n)).done)&&(aa.push(u.value),aa.length!==b);I=!0);}catch(d){k=!0;var w=d}finally{try{if(!I&&null!=n.return&&(la=n.return(),Object(la)!==la))return}finally{if(k)throw w;}}return aa}}(a,b)||od(a,b)))throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
return a}function ba(a,b){var n="undefined"!=typeof Symbol&&a[Symbol.iterator]||a["@@iterator"];if(!n){if(Array.isArray(a)||(n=od(a))||b&&a&&"number"==typeof a.length){n&&(a=n);var u=0;b=function(){};return{s:b,n:function(){return u>=a.length?{done:!0}:{done:!1,value:a[u++]}},e:function(a){throw a;},f:b}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var c,g=!0,m=!1;return{s:function(){n=
n.call(a)},n:function(){var a=n.next();return g=a.done,a},e:function(a){m=!0;c=a},f:function(){try{g||null==n.return||n.return()}finally{if(m)throw c;}}}}function ab(a){var b=Array.isArray(a)?pd(a):void 0;b||(b="undefined"!=typeof Symbol&&null!=a[Symbol.iterator]||null!=a["@@iterator"]?Array.from(a):void 0);if(!(a=b||od(a)))throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");return a}function od(a,
b){if(a){if("string"==typeof a)return pd(a,b);var n={}.toString.call(a).slice(8,-1);return"Object"===n&&a.constructor&&(n=a.constructor.name),"Map"===n||"Set"===n?Array.from(a):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pd(a,b):void 0}}function pd(a,b){(null==b||b>a.length)&&(b=a.length);for(var n=0,u=Array(b);n<b;n++)u[n]=a[n];return u}function da(a,b,c){b=jb(b);b=jd()?Reflect.construct(b,c||[],jb(a).constructor):b.apply(a,c);if(!b||"object"!=ra(b)&&"function"!=typeof b){if(void 0!==
b)throw new TypeError("Derived constructors may only return object or undefined");if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}else a=b;return a}function jd(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(n){}return(jd=function(){return!!a})()}function qd(){return qd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(a,b,c){var n;for(n=a;!{}.hasOwnProperty.call(n,b)&&null!==(n=jb(n)););
if(n)return n=Object.getOwnPropertyDescriptor(n,b),n.get?n.get.call(3>arguments.length?a:c):n.value},qd.apply(null,arguments)}function jb(a){return jb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},jb(a)}function ea(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}});Object.defineProperty(a,
"prototype",{writable:!1});b&&Gb(a,b)}function Gb(a,b){return Gb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,b){return a.__proto__=b,a},Gb(a,b)}function ra(a){return ra="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},ra(a)}function E(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function Ce(a,
b){for(var n=0;n<b.length;n++){var u=b[n];u.enumerable=u.enumerable||!1;u.configurable=!0;"value"in u&&(u.writable=!0);Object.defineProperty(a,Be(u.key),u)}}function D(a,b,c){return b&&Ce(a.prototype,b),c&&Ce(a,c),Object.defineProperty(a,"prototype",{writable:!1}),a}function Be(a){a:if("object"==ra(a)&&a){var b=a[Symbol.toPrimitive];if(void 0!==b){a=b.call(a,"string");if("object"!=ra(a))break a;throw new TypeError("@@toPrimitive must return a primitive value.");}a=String(a)}return"symbol"==ra(a)?
a:a+""}function De(a){return!(!a||"object"!==ra(a)||a.type!==qb.number)}function rd(a){return!(!a||"object"!==ra(a)||a.type!==qb.dateTime)}function Pg(a){var b={};return a.replace(Qg,function(a){var n=a.length;switch(a[0]){case "G":b.era=4===n?"long":5===n?"narrow":"short";break;case "y":b.year=2===n?"2-digit":"numeric";break;case "Y":case "u":case "U":case "r":throw new RangeError("`Y/u/U/r` (year) patterns are not supported, use `y` instead");case "q":case "Q":throw new RangeError("`q/Q` (quarter) patterns are not supported");
case "M":case "L":b.month=["numeric","2-digit","short","long","narrow"][n-1];break;case "w":case "W":throw new RangeError("`w/W` (week) patterns are not supported");case "d":b.day=["numeric","2-digit"][n-1];break;case "D":case "F":case "g":throw new RangeError("`D/F/g` (day) patterns are not supported, use `d` instead");case "E":b.weekday=4===n?"short":5===n?"narrow":"short";break;case "e":if(4>n)throw new RangeError("`e..eee` (weekday) patterns are not supported");b.weekday=["short","long","narrow",
"short"][n-4];break;case "c":if(4>n)throw new RangeError("`c..ccc` (weekday) patterns are not supported");b.weekday=["short","long","narrow","short"][n-4];break;case "a":b.hour12=!0;break;case "b":case "B":throw new RangeError("`b/B` (period) patterns are not supported, use `a` instead");case "h":b.hourCycle="h12";b.hour=["numeric","2-digit"][n-1];break;case "H":b.hourCycle="h23";b.hour=["numeric","2-digit"][n-1];break;case "K":b.hourCycle="h11";b.hour=["numeric","2-digit"][n-1];break;case "k":b.hourCycle=
"h24";b.hour=["numeric","2-digit"][n-1];break;case "j":case "J":case "C":throw new RangeError("`j/J/C` (hour) patterns are not supported, use `h/H/K/k` instead");case "m":b.minute=["numeric","2-digit"][n-1];break;case "s":b.second=["numeric","2-digit"][n-1];break;case "S":case "A":throw new RangeError("`S/A` (second) patterns are not supported, use `s` instead");case "z":b.timeZoneName=4>n?"short":"long";break;case "Z":case "O":case "v":case "V":case "X":case "x":throw new RangeError("`Z/O/v/V/X/x` (timeZone) patterns are not supported, use `z` instead");
}return""}),b}function Ee(a){var b={};return"r"===a[a.length-1]?b.roundingPriority="morePrecision":"s"===a[a.length-1]&&(b.roundingPriority="lessPrecision"),a.replace(Fe,function(a,n,u){return"string"!=typeof u?(b.minimumSignificantDigits=n.length,b.maximumSignificantDigits=n.length):"+"===u?b.minimumSignificantDigits=n.length:"#"===n[0]?b.maximumSignificantDigits=n.length:(b.minimumSignificantDigits=n.length,b.maximumSignificantDigits=n.length+("string"==typeof u?u.length:0)),""}),b}function sd(a){switch(a){case "sign-auto":return{signDisplay:"auto"};
case "sign-accounting":case "()":return{currencySign:"accounting"};case "sign-always":case "+!":return{signDisplay:"always"};case "sign-accounting-always":case "()!":return{signDisplay:"always",currencySign:"accounting"};case "sign-except-zero":case "+?":return{signDisplay:"exceptZero"};case "sign-accounting-except-zero":case "()?":return{signDisplay:"exceptZero",currencySign:"accounting"};case "sign-never":case "+_":return{signDisplay:"never"}}}function Rg(a){var b;if("E"===a[0]&&"E"===a[1]?(b={notation:"engineering"},
a=a.slice(2)):"E"===a[0]&&(b={notation:"scientific"},a=a.slice(1)),b){var u=a.slice(0,2);if("+!"===u?(b.signDisplay="always",a=a.slice(2)):"+?"===u&&(b.signDisplay="exceptZero",a=a.slice(2)),!Ge.test(a))throw Error("Malformed concise eng/scientific notation");b.minimumIntegerDigits=a.length}return b}function Sg(a){for(var b={},u=0;u<a.length;u++){var c=a[u];switch(c.stem){case "percent":case "%":b.style="percent";continue;case "%x100":b.style="percent";b.scale=100;continue;case "currency":b.style=
"currency";b.currency=c.options[0];continue;case "group-off":case ",_":b.useGrouping=!1;continue;case "precision-integer":case ".":b.maximumFractionDigits=0;continue;case "measure-unit":case "unit":b.style="unit";b.unit=c.options[0].replace(/^(.*?)-/,"");continue;case "compact-short":case "K":b.notation="compact";b.compactDisplay="short";continue;case "compact-long":case "KK":b.notation="compact";b.compactDisplay="long";continue;case "scientific":b=sa(sa(sa({},b),{notation:"scientific"}),c.options.reduce(function(a,
b){return sa(sa({},a),sd(b)||{})},{}));continue;case "engineering":b=sa(sa(sa({},b),{notation:"engineering"}),c.options.reduce(function(a,b){return sa(sa({},a),sd(b)||{})},{}));continue;case "notation-simple":b.notation="standard";continue;case "unit-width-narrow":b.currencyDisplay="narrowSymbol";b.unitDisplay="narrow";continue;case "unit-width-short":b.currencyDisplay="code";b.unitDisplay="short";continue;case "unit-width-full-name":b.currencyDisplay="name";b.unitDisplay="long";continue;case "unit-width-iso-code":b.currencyDisplay=
"symbol";continue;case "scale":b.scale=parseFloat(c.options[0]);continue;case "integer-width":if(1<c.options.length)throw new RangeError("integer-width stems only accept a single optional option");c.options[0].replace(Tg,function(a,n,u,c,I,k){if(n)b.minimumIntegerDigits=u.length;else{if(c&&I)throw Error("We currently do not support maximum integer digits");if(k)throw Error("We currently do not support exact integer digits");}return""});continue}if(Ge.test(c.stem))b.minimumIntegerDigits=c.stem.length;
else if(He.test(c.stem)){if(1<c.options.length)throw new RangeError("Fraction-precision stems only accept a single optional option");c.stem.replace(He,function(a,n,u,c,I,k){return"*"===u?b.minimumFractionDigits=n.length:c&&"#"===c[0]?b.maximumFractionDigits=c.length:I&&k?(b.minimumFractionDigits=I.length,b.maximumFractionDigits=I.length+k.length):(b.minimumFractionDigits=n.length,b.maximumFractionDigits=n.length),""});c=c.options[0];"w"===c?b=sa(sa({},b),{trailingZeroDisplay:"stripIfInteger"}):c&&
(b=sa(sa({},b),Ee(c)))}else if(Fe.test(c.stem))b=sa(sa({},b),Ee(c.stem));else{var g=sd(c.stem);g&&(b=sa(sa({},b),g));(c=Rg(c.stem))&&(b=sa(sa({},b),c))}}return b}function Ug(a){var b=a.hourCycle;if(void 0===b&&a.hourCycles&&a.hourCycles.length&&(b=a.hourCycles[0]),b)switch(b){case "h24":return"k";case "h23":return"H";case "h12":return"h";case "h11":return"K";default:throw Error("Invalid hourCycle");}var c;b=a.language;return"root"!==b&&(c=a.maximize().region),(Xb[c||""]||Xb[b||""]||Xb["".concat(b,
"-001")]||Xb["001"])[0]}function T(a,b){return{start:a,end:b}}function td(a){return 97<=a&&122>=a||65<=a&&90>=a}function Vg(a){return 45===a||46===a||48<=a&&57>=a||95===a||97<=a&&122>=a||65<=a&&90>=a||183==a||192<=a&&214>=a||216<=a&&246>=a||248<=a&&893>=a||895<=a&&8191>=a||8204<=a&&8205>=a||8255<=a&&8256>=a||8304<=a&&8591>=a||11264<=a&&12271>=a||12289<=a&&55295>=a||63744<=a&&64975>=a||65008<=a&&65533>=a||65536<=a&&983039>=a}function Ie(a){return 9<=a&&13>=a||32===a||133===a||8206<=a&&8207>=a||8232===
a||8233===a}function ud(a){a.forEach(function(a){if(delete a.location,a.type===Y.select||a.type===Y.plural)for(var b in a.options)delete a.options[b].location,ud(a.options[b].value);else a.type===Y.number&&De(a.style)||(a.type===Y.date||a.type===Y.time)&&rd(a.style)?delete a.style.location:a.type===Y.tag&&ud(a.children)})}function Yb(a,b){return(b&&b.strategy?b.strategy:Wg)(a,{cache:b&&b.cache?b.cache:Xg,serializer:b&&b.serializer?b.serializer:Yg})}function Zg(a,b,c,g){c=null==g||"number"==typeof g||
"boolean"==typeof g?g:c(g);var n=b.get(c);return void 0===n&&(n=a.call(this,g),b.set(c,n)),n}function Je(a,b,c){var n=Array.prototype.slice.call(arguments,3),u=c(n),g=b.get(u);return void 0===g&&(g=a.apply(this,n),b.set(u,g)),g}function Wg(a,b){var c=b.cache.create();return(1===a.length?Zg:Je).bind(this,a,c,b.serializer)}function vd(){this.cache=Object.create(null)}function Hb(a,b,c,g,m,p,t,wa,ja){if(1===a.length&&a[0].type===Y.literal)return[{type:Aa.literal,value:a[0].value}];var I,k,w;void 0!==
b.getLocale?(I=b,k=b.getLocale(),w=b.getTimeZone()):k=b;k=ja||Zb.getCanonicalLocaleString(k);var d;ja=[];a=ba(a);try{for(a.s();!(d=a.n()).done;){var y=d.value;if(y.type===Y.literal)ja.push({type:Aa.literal,value:y.value});else if(y.type===Y.pound)"number"==typeof p&&ja.push({type:Aa.literal,value:c.getNumberFormat(k).format(p)});else{var n=y.value;if(!m)throw new Ke(n,t);if(y.type===Y.tag){var L=y.children,B=y.value,h=m[B];if(wa&&(h=function(a){return a}),"function"!=typeof h)throw new $g(B,"function",
t);var l=h(Hb(L,b,c,g,m,p,t,wa,k).map(function(a){return a.value}));Array.isArray(l)||(l=[l]);wa?ja.push({type:Aa.object,value:wa.createElement.apply(wa,[B,{}].concat(ab(l)))}):ja.push.apply(ja,ab(l.map(function(a){return{type:"string"==typeof a?Aa.literal:Aa.object,value:a}})))}else{if(!(m&&n in m))throw new Ke(n,t);var r=m[n];if(y.type===Y.argument)r&&"string"!=typeof r&&"number"!=typeof r?"function"==typeof r&&(r=r(wa,{},[])):r="string"==typeof r||"number"==typeof r?String(r):"",ja.push({type:"string"==
typeof r?Aa.literal:Aa.object,value:r});else if(y.type===Y.date){var f="string"==typeof y.style?g.date[y.style]:rd(y.style)?y.style.parsedOptions:{};void 0!==w&&(f.timeZone=w);ja.push({type:Aa.literal,value:c.getDateTimeFormat(k,f).format(r)})}else if(y.type===Y.time){var F="string"==typeof y.style?g.time[y.style]:rd(y.style)?y.style.parsedOptions:g.time.medium;void 0!==w&&(F.timeZone=w);ja.push({type:Aa.literal,value:c.getDateTimeFormat(k,F).format(r)})}else if(y.type===Y.number){var Z="string"==
typeof y.style?g.number[y.style]:De(y.style)?y.style.parsedOptions:void 0;Z&&Z.scale&&(r*=Z.scale||1);ja.push({type:Aa.literal,value:c.getNumberFormat(k,Z).format(r)})}else if(y.type===Y.price){var u="string"==typeof y.style?g.price[y.style]:void 0,Ha=c.getPriceFormat(I||k,u).format(r,u);ja.push({type:"string"==typeof Ha?Aa.literal:Aa.object,value:Ha})}else if(y.type===Y.select){var Da=y.options[r]||y.options.other;if(!Da)throw new Le(y.value,r,Object.keys(y.options),t);ja.push.apply(ja,ab(Hb(Da.value,
b,c,g,m,p,t,wa,k)))}else if(y.type===Y.plural){var la=y.options["\x3d".concat(r)];if(!la){if(!Intl.PluralRules)throw new $b('Intl.PluralRules is not available in this environment.\nTry polyfilling it using "@formatjs/intl-pluralrules"\n',rb.MISSING_INTL_API,t);var aa=c.getPluralRules(k,{type:y.pluralType}).select(r-(y.offset||0));la=y.options[aa]||y.options.other}if(!la)throw new Le(y.value,r,Object.keys(y.options),t);ja.push.apply(ja,ab(Hb(la.value,b,c,g,m,r-(y.offset||0),t,wa,k)))}}}}}catch(kd){a.e(kd)}finally{a.f()}return wa?
ja:2>ja.length?ja:ja.reduce(function(a,k){var h=a[a.length-1];return h&&h.type===Aa.literal&&k.type===Aa.literal?h.value+=k.value:a.push(k),a},[])}function ac(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];if(!b||0===b.length)throw Error("The key field(s) must not be null or empty");return b.join("_")}function Ib(a,b){if(null==a)return null;if(b.has(a))return b.get(a);throw Error("Failed to convert to config enum with ".concat(a));}function Me(a,b){if(null==a)return null;var c;
b=ba(b.entries());try{for(b.s();!(c=b.n()).done;){var n=Ta(c.value,2),u=n[0];if(n[1]==a)return u}}catch(Sa){b.e(Sa)}finally{b.f()}throw Error("Failed to convert from config enum with ".concat(a));}function bc(a,b){a.includes(b)&&a.splice(a.indexOf(b),1)}function Ne(a){return a.map(function(a){return a.value}).reduce(function(a,b){return a+b})}function cc(a,b){var c,n="";a=ba(a);try{for(a.s();!(c=a.n()).done;){var u=c.value;if("integer"!==b||"integer"!==u.type&&"group"!==u.type){if(u.type===b)return u.value}else n+=
u.value}}catch(Sa){a.e(Sa)}finally{a.f()}return n||void 0}function Oe(a,b,c,g,m){wd(b)&&(m=kb(b,"literal",m),"end"===c&&(b[m].value=b[m].value.replace(ah,"")),b=xd(b,m,g),"compact"===a&&b.splice(g,1));return b}function bh(a){switch(a){case "iso":return"code";case "plural":return"name";default:return"symbol"}}function wd(a){var b=1;return lb(a)?("literal"===a[(b=a.length)-1].type&&b--,b-=2):("literal"===a[b-1].type&&b++,"minusSign"===a[b-1].type&&b++),"literal"===a[b].type}function lb(a){var b=a.length-
1;return"literal"===a[b].type&&b--,"currency"===a[b].type}function yd(a,b){if(!a)throw Error("Format Parts must not be emtpy");var c;a=ba(a);try{for(a.s();!(c=a.n()).done;)if(c.value.type===b)return!0}catch(aa){a.e(aa)}finally{a.f()}return!1}function xd(a,b,c){if(c===b)return a;for(var n=a[b],u=c<b?-1:1;b!==c;b+=u)a[b]=a[b+u];return a[c]=n,a}function kb(a,b,c){var n,u,g;for(c?(n=a.length-1,u=0,g=-1):(n=0,u=a.length-1,g=1);n!==u;){if(a[n].type===b&&("literal"!==b||0!==n&&n!==a.length-1))return n;n+=
g}return a[n].type===b?n:-1}function Pe(a){switch(a){case "compact":return"compact";case "in_sentence":return"inSentence";case "iso":return"iso";case "plural":return"plural";default:return"amazonSymbol"}}function dc(a){return{create:function(){return{has:function(b){return b in a},get:function(b){return a[b]},set:function(b,c){a[b]=c}}}}}function ch(a,b){return Qe.apply(this,arguments)}function Qe(){return(Qe=ib(na().m(function aa(a,b){var c,n;return na().w(function(g){for(;;)switch(g.n){case 0:if("undefined"==
typeof performance){g.n=2;break}return c=performance.now(),g.n=1,b();case 1:n=performance.now();Ma.info("".concat(a,": ").concat(n-c," ms"));g.n=4;break;case 2:return console.time(a),g.n=3,b();case 3:console.timeEnd(a);case 4:return g.a(2)}},aa)}))).apply(this,arguments)}function Re(a,b){return(a=a&&a.endpointMap&&a.endpointMap[b.locale])&&a[b.bundle]}function zd(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"strings";return function(a){var b={};a.resolveBundleUrl?b.resolveBundleUrl=
function(b,c){return a.resolveBundleUrl(Re(a.arbManifest,c),c.locale,c.bundle)}:b.resolveBundleUrl=function(b,c){var n;b=null!==(n=a.urlPrefix)&&void 0!==n?n:"";return"/"!==b[0]&&(b="/"+b),b&&"/"!==b[b.length-1]&&(b+="/"),b+Re(a.arbManifest,c)};a.resolveResourcePack&&(b.resolveResourcePack=a.resolveResourcePack);b=function(a){return new dh(Object.assign({resolveResourcePack:function(a){return ib(na().m(function wa(){var b,I,k,w,d;return na().w(function(y){for(;;)switch(y.n){case 0:return y.n=1,fetch(a);
case 1:if(b=y.v,I=b.ok,k=b.status,w=b.statusText,I){y.n=2;break}throw d=500<=k&&600>k,Ma.error("Failed to fetch ".concat(a,": %O"),{status:k,statusText:w}),new eh("Failed to fetch ".concat(a),d);case 2:return y.a(2,b.json())}},wa)}))()}},a))}(b);return new Se(new fh(a.localizationContextProvider),b)}({arbManifest:gh,localizationContextProvider:function(){return(new mb).withLocale(a).withDefaultLocale("en-US").build()},resolveBundleUrl:function(a){return a?"translations/".concat(a):void 0},resolveResourcePack:function(a){return a?
Promise.resolve(hh.get(a)):Promise.reject(Error("Asset could not be retrieved"))}}).getBundle(b)}function Te(a,b){var c="undefined"!=typeof Symbol&&a[Symbol.iterator]||a["@@iterator"];if(!c){if(Array.isArray(a)||(c=Ue(a))||b&&a&&"number"==typeof a.length){c&&(a=c);var n=0;b=function(){};return{s:b,n:function(){return n>=a.length?{done:!0}:{done:!1,value:a[n++]}},e:function(a){throw a;},f:b}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
}var u,g=!0,m=!1;return{s:function(){c=c.call(a)},n:function(){var a=c.next();return g=a.done,a},e:function(a){m=!0;u=a},f:function(){try{g||null==c.return||c.return()}finally{if(m)throw u;}}}}function Ue(a,b){if(a){if("string"==typeof a)return Ve(a,b);var c={}.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?Ve(a,b):void 0}}function Ve(a,b){(null==b||b>a.length)&&
(b=a.length);for(var c=0,n=Array(b);c<b;c++)n[c]=a[c];return n}function We(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);b&&(n=n.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable}));c.push.apply(c,n)}return c}function ih(b){for(var c=1;c<arguments.length;c++){var g=null!=arguments[c]?arguments[c]:{};c%2?We(Object(g),!0).forEach(function(c){a(b,c,g[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(g)):
We(Object(g)).forEach(function(a){Object.defineProperty(b,a,Object.getOwnPropertyDescriptor(g,a))})}return b}function Pa(a){return a in Xe?"ATVDetail"===a&&K.extractGtiFromUrl(K.getCurrentPageUrl())?xa.UNKNOWN:Xe[a]:xa.UNKNOWN}function Ye(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);b&&(n=n.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable}));c.push.apply(c,n)}return c}function bb(b){for(var c=1;c<arguments.length;c++){var g=
null!=arguments[c]?arguments[c]:{};c%2?Ye(Object(g),!0).forEach(function(c){a(b,c,g[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(g)):Ye(Object(g)).forEach(function(a){Object.defineProperty(b,a,Object.getOwnPropertyDescriptor(g,a))})}return b}function Ze(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(n){}return(Ze=function(){return!!a})()}function $e(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,
[],function(){}))}catch(n){}return($e=function(){return!!a})()}function Ad(a){var b=Array.isArray(a)?Ra(a):void 0;b||(b="undefined"!=typeof Symbol&&null!=a[Symbol.iterator]||null!=a["@@iterator"]?Array.from(a):void 0);if(!(a=b||qa(a)))throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");return a}function Bd(a,b){var c=a.querySelectorAll("img"),n=0,g=function(){n===c.length&&(b(),c.forEach(function(a){a.removeEventListener("load",
m);a.removeEventListener("error",m)}))},m=function(){n++;g()};c.forEach(function(a){a.complete?n++:(a.addEventListener("load",m),a.addEventListener("error",m))});g()}function af(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,n=Array(b);c<b;c++)n[c]=a[c];return n}function bf(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(n){}return(bf=function(){return!!a})()}function cf(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,n=Array(b);c<b;c++)n[c]=
a[c];return n}function df(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(n){}return(df=function(){return!!a})()}function ef(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(n){}return(ef=function(){return!!a})()}function ff(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(n){}return(ff=function(){return!!a})()}function gf(){var a=document.getElementById("nav-flyout-rufus"),
b=document.querySelector(".rufus-pill"),g=document.getElementById("rufus-conversation-container"),m=ta.getInstance().getWeblabTreatment("RUFUS_DESKTOP_VISUAL_BRANDING_UPDATE_1201601");if(a&&b&&g){var p=0;if("T1"!==m&&"T2"!==m){p=document.querySelector(".rufus-avatar-padding");if(!p)return;p=parseFloat(c.getComputedStyle(p).paddingLeft)}a=parseFloat(c.getComputedStyle(a).getPropertyValue("--expanded-container-width"));b=c.getComputedStyle(b);b=parseFloat(b.paddingLeft)+parseFloat(b.paddingRight);g=
c.getComputedStyle(g);return a-p-b-(parseFloat(g.paddingLeft)+parseFloat(g.paddingRight))}}function hf(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(n){}return(hf=function(){return!!a})()}function jf(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(n){}return(jf=function(){return!!a})()}function kf(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);b&&(n=n.filter(function(b){return Object.getOwnPropertyDescriptor(a,
b).enumerable}));c.push.apply(c,n)}return c}function cb(b){for(var c=1;c<arguments.length;c++){var g=null!=arguments[c]?arguments[c]:{};c%2?kf(Object(g),!0).forEach(function(c){a(b,c,g[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(g)):kf(Object(g)).forEach(function(a){Object.defineProperty(b,a,Object.getOwnPropertyDescriptor(g,a))})}return b}function lf(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(n){}return(lf=
function(){return!!a})()}function mf(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);b&&(n=n.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable}));c.push.apply(c,n)}return c}function ec(b){for(var c=1;c<arguments.length;c++){var g=null!=arguments[c]?arguments[c]:{};c%2?mf(Object(g),!0).forEach(function(c){a(b,c,g[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(g)):mf(Object(g)).forEach(function(a){Object.defineProperty(b,
a,Object.getOwnPropertyDescriptor(g,a))})}return b}function nf(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(n){}return(nf=function(){return!!a})()}function of(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(n){}return(of=function(){return!!a})()}function pf(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,n=Array(b);c<b;c++)n[c]=a[c];return n}function qf(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var n=
Object.getOwnPropertySymbols(a);b&&(n=n.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable}));c.push.apply(c,n)}return c}function rf(b){for(var c=1;c<arguments.length;c++){var g=null!=arguments[c]?arguments[c]:{};c%2?qf(Object(g),!0).forEach(function(c){a(b,c,g[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(g)):qf(Object(g)).forEach(function(a){Object.defineProperty(b,a,Object.getOwnPropertyDescriptor(g,a))})}return b}function sf(a,
b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);b&&(n=n.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable}));c.push.apply(c,n)}return c}function Cd(b){for(var c=1;c<arguments.length;c++){var g=null!=arguments[c]?arguments[c]:{};c%2?sf(Object(g),!0).forEach(function(c){a(b,c,g[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(g)):sf(Object(g)).forEach(function(a){Object.defineProperty(b,
a,Object.getOwnPropertyDescriptor(g,a))})}return b}var jh=R(3007),P=R.n(jh),p=x(function n(){z(this,n)});a(p,"RUFUS_PANEL_STATE_PREFIX","RUFUS_PANEL_");a(p,"RUFUS_PANEL_INFOCUS","RUFUS_PANEL_INFOCUS");a(p,"RUFUS_PANEL_OUTFOCUS","RUFUS_PANEL_OUTFOCUS");a(p,"RUFUS_THUMBSUP_CLICKED","RUFUS_THUMBSUP_CLICKED");a(p,"RUFUS_PANEL_EXPANDED_BY_CX_ZEN","RUFUS_PANEL_EXPANDED_BY_CX_ZEN");a(p,"RUFUS_THUMBSDOWN_CLICKED","RUFUS_THUMBSDOWN_CLICKED");a(p,"RUFUS_CLOSE_CLICK_FROM_EXPANDED","RUFUS_CLOSE_CLICK_FROM_EXPANDED");
a(p,"RUFUS_CLOSE_CLICK_FROM_MINIMIZED","RUFUS_CLOSE_CLICK_FROM_MINIMIZED");a(p,"RUFUS_ENTER_PRESSED_ON_INPUT_TEXT","RUFUS_ENTER_PRESSED_ON_INPUT_TEXT");a(p,"RUFUS_SUBMIT_ON_INPUT_TEXT","RUFUS_SUBMIT_ON_INPUT_TEXT");a(p,"RUFUS_PANEL_CONTAINER_INSTANTIATED","RUFUS_PANEL_CONTAINER_INSTANTIATED");a(p,"RUFUS_FEEDBACK_OPTION_SUBMITTED","RUFUS_FEEDBACK_OPTION_SUBMITTED");a(p,"RUFUS_FEEDBACK_TEXT_SUBMITTED","RUFUS_FEEDBACK_TEXT_SUBMITTED");a(p,"RUFUS_SCROLL_DOWN_CLICKED","RUFUS_SCROLL_DOWN_CLICKED");a(p,
"RUFUS_TAB_ID_GENERATED","RUFUS_TAB_ID_GENERATED");a(p,"RUFUS_STREAM_INTERRUPT","RUFUS_STREAM_INTERRUPT");a(p,"RUFUS_RQ_CLICK","RUFUS_RQ_CLICK");a(p,"RUFUS_OPEN_URL_CLICK_PREFIX","RUFUS_OPEN_URL_CLICK_");a(p,"RUFUS_HYPERLINK_CLICK_PREFIX","RUFUS_HYPERLINK_CLICK_");a(p,"RUFUS_PANEL_CACHE_INVALID","RUFUS_PANEL_CACHE_INVALID");a(p,"RUFUS_PANEL_CACHE_VALID","RUFUS_PANEL_CACHE_VALID");a(p,"RUFUS_BEGINNING_HISTORY_SHOWN","RUFUS_BEGINNING_HISTORY_SHOWN");a(p,"RUFUS_HISTORY_BUTTON_SHOWN","RUFUS_HISTORY_BUTTON_SHOWN");
a(p,"RUFUS_SCROLL_TO_TOP","RUFUS_SCROLL_TO_TOP");a(p,"FETCH_HISTORY","FETCH_HISTORY");a(p,"FETCH_HISTORY_INTERRUPTION_RECOVERY","RUFUS_FETCH_HISTORY_INTERRUPTION_RECOVERY");a(p,"FIRST_TIME_FETCH_HISTORY","FIRST_TIME_FETCH_HISTORY");a(p,"LOAD_HISTORY_BUTTON_CLICK","LOAD_HISTORY_BUTTON_CLICK");a(p,"RUFUS_SIGN_OUT","RUFUS_SIGN_OUT");a(p,"RUFUS_ACTIVE_CONVERSATION_CONTAINER_IN_HISTORY_NULL","RUFUS_ACTIVE_CONVERSATION_CONTAINER_IN_HISTORY_NULL");a(p,"RUFUS_HISTORY_CONTAINER_IN_HISTORY_NULL","RUFUS_HISTORY_CONTAINER_IN_HISTORY_NULL");
a(p,"RUFUS_PANEL_OVERFLOW_MENU_AUTO_MINIMIZE","RUFUS_PANEL_OVERFLOW_MENU_AUTO_MINIMIZE");a(p,"RUFUS_PANEL_OVERFLOW_MENU_GET_STARTED","RUFUS_PANEL_OVERFLOW_MENU_GET_STARTED");a(p,"RUFUS_DEALS_PILL_PRESENTED","RUFUS_DEALS_PILL_PRESENTED");a(p,"RUFUS_DEALS_RQ_CLICK","RUFUS_DEALS_RQ_CLICK");a(p,"RUFUS_WDCS_RQ_CLICK","RUFUS_WDCS_RQ_CLICK");a(p,"RUFUS_RECOVERY_TEASER_CX_CLICK","RUFUS_RECOVERY_TEASER_CX_CLICK");a(p,"RUFUS_RECOVERY_TEASER_CX_OPEN_PANEL","RUFUS_RECOVERY_TEASER_CX_OPEN_PANEL");a(p,"INPUT_QUERY_MAX_LIMIT_REACHED",
"INPUT_QUERY_MAX_LIMIT_REACHED");a(p,"RENDERED_ERROR_CODE_PREFIX","RENDERED_ERROR_CODE_");a(p,"RUFUS_SECTION_WITHOUT_GROUP_SECTION_ID","RUFUS_SECTION_WITHOUT_GROUP_SECTION_ID");a(p,"RUFUS_MULTIMODAL_IMAGE_SHOWN","RUFUS_MULTIMODAL_IMAGE_SHOWN");a(p,"RUFUS_MULTIMODAL_IMAGE_CLICKED","RUFUS_MULTIMODAL_IMAGE_CLICKED");a(p,"INTERRUPTION_RECOVERY_BUTTON_CLICK","INTERRUPTION_RECOVERY_BUTTON_CLICK");a(p,"INTERRUPTION_RECOVERY_BUTTON_SHOWN","RUFUS_INTERRUPTION_RECOVERY_BUTTON_SHOWN");a(p,"INTERRUPTION_RECOVERY_FAILED",
"RUFUS_INTERRUPTION_RECOVERY_FAILED");a(p,"RUFUS_CLIENT_WEBLAB_TREATMENTS_PARSED","RUFUS_CLIENT_WEBLAB_TREATMENTS_PARSED");a(p,"RUFUS_CSAI_OPENED","RUFUS_CSAI_OPENED");a(p,"RUFUS_MULTIMODAL_DISMISS_BUTTON_CLICKED","RUFUS_MULTIMODAL_DISMISS_BUTTON_CLICKED");a(p,"RUFUS_MULTIMODAL_POPOVER_SHOWN","RUFUS_MULTIMODAL_POPOVER_SHOWN");a(p,"ERROR_ON_LOADING_HIGH_RES_IMAGE","ERROR_ON_LOADING_HIGH_RES_IMAGE");a(p,"ERROR_ON_LOADING_LOW_RES_IMAGE","ERROR_ON_LOADING_LOW_RES_IMAGE");a(p,"RUFUS_INSUFFICIENT_BROWSER_CAPABILITIES",
"RUFUS_INSUFFICIENT_BROWSER_CAPABILITIES");a(p,"RUFUS_UNDEFINED_EVENT_SOURCE","RUFUS_UNDEFINED_EVENT_SOURCE");a(p,"RUFUS_SSE_HANDLER_ERROR","RUFUS_SSE_HANDLER_ERROR");a(p,"RUFUS_TIMEOUT","RUFUS_TIMEOUT");a(p,"RUFUS_OFFLINE","RUFUS_OFFLINE");a(p,"RUFUS_HANDLE_CONTEXT_CHUNK_ERROR","RUFUS_HANDLE_CONTEXT_CHUNK_ERROR");a(p,"ERROR_ON_RENDERING_HIGH_RES_IMAGE","ERROR_ON_RENDERING_HIGH_RES_IMAGE");a(p,"ERROR_ON_RENDERING_LOW_RES_IMAGE","ERROR_ON_RENDERING_LOW_RES_IMAGE");a(p,"RUFUS_TEASER_AUTO_EXPANDS_CL",
"RUFUS_TEASER_AUTO_EXPANDS_CL");a(p,"RUFUS_TEASER_WIDGET_BSR_SENT_TO_SEARCH","RUFUS_TEASER_WIDGET_BSR_SENT_TO_SEARCH");a(p,"RUFUS_TEASER_RECOVERY_WIDGET_SENT_TO_SEARCH","RUFUS_TEASER_RECOVERY_WIDGET_SENT_TO_SEARCH");a(p,"SECTION_REMOVED","SECTION_REMOVED");a(p,"RUFUS_TWISTER_STREAMING_REQUEST","RUFUS_TWISTER_STREAMING_REQUEST");a(p,"UNKNOWN_PATCH_ID_IN_BACKFILL_DATA","UNKNOWN_PATCH_ID_IN_BACKFILL_DATA");a(p,"RUFUS_PRICING_INVALID_DATA","RUFUS_PRICING_INVALID_DATA");a(p,"RUFUS_PRICING_RENDERING_ERROR",
"RUFUS_PRICING_RENDERING_ERROR");a(p,"RUFUS_PRICING_CLIENT_NOT_LOADED","RUFUS_PRICING_CLIENT_NOT_LOADED");a(p,"RASIN_INITIALIZE_SUCCESS","RASIN_INITIALIZE_SUCCESS");a(p,"RASIN_INITIALIZATION_ERROR","RASIN_INITIALIZATION_ERROR");a(p,"RASIN_CONVERSATION_REFINEMENT_SET","RASIN_CONVERSATION_REFINEMENT_SET");a(p,"RASIN_CONVERSATION_REFINEMENT_CLEARED","RASIN_CONVERSATION_REFINEMENT_CLEARED");a(p,"RASIN_CONVERSATION_REFINEMENT_SWAPPED","RASIN_CONVERSATION_REFINEMENT_SWAPPED");a(p,"RASIN_FILTER_PILL_CLICK",
"RASIN_FILTER_PILL_CLICK");a(p,"RASIN_FILTER_PILL_DISMISS_CLICK","RASIN_FILTER_PILL_DISMISS_CLICK");a(p,"RASIN_RQ_PILL_CLICK","RASIN_RQ_PILL_CLICK");a(p,"RASIN_CL_INPUT_QUERY","RASIN_CL_INPUT_QUERY");a(p,"RUFUS_CART_COUNT_UPDATED","RUFUS_CART_COUNT_UPDATED");a(p,"RUFUS_CART_PAGE_REFRESHED","RUFUS_CART_PAGE_REFRESHED");var ha=x(function la(){z(this,la)});a(ha,"STREAM_ERROR","STREAM_ERROR");a(ha,"STREAM_WITHOUT_ACTION","STREAM_WITHOUT_ACTION");a(ha,"STREAM_INTERRUPTION","STREAM_INTERRUPTION");a(ha,
"STREAM_START","STREAM_START");a(ha,"SSE_STREAM_OPEN","SSE_STREAM_OPEN");a(ha,"SSE_STREAM_CLOSE","SSE_STREAM_CLOSE");a(ha,"STREAM_LAST_RENDERED_CHUNK","STREAM_LAST_RENDERED_CHUNK");a(ha,"RENDER_SUFFIX","-render");a(ha,"RECEIVE_SUFFIX","-receive");a(ha,"CHUNK_FIRST_SECTION_RENDER_SUFFIX","-chunk-first-section-render");a(ha,"CHUNK_LAST_SECTION_RENDER_SUFFIX","-chunk-last-section-render");a(ha,"FIRST_INFERENCE_CHUNK_RENDER_SUFFIX","first-inference-chunk-render");var oa=x(function aa(){z(this,aa)});a(oa,
"RUFUS_FEEDBACK_LATENCY","RUFUS_FEEDBACK");a(oa,"RUFUS_HISTORY_LATENCY","RUFUS_HISTORY");a(oa,"RUFUS_INTERRUPTION_RECOVERY_LATENCY","RUFUS_HISTORY_INTERRUPTION_RECOVERY");a(oa,"RUFUS_LOW_RESOLUTION_IMAGE_LOADED_LATENCY","RUFUS_LOW_RESOLUTION_IMAGE_LOADED_LATENCY");a(oa,"RUFUS_HIGH_RESOLUTION_IMAGE_LOADED_LATENCY","RUFUS_HIGH_RESOLUTION_IMAGE_LOADED_LATENCY");a(oa,"RUFUS_LOW_RESOLUTION_IMAGE_RENDERED_LATENCY","RUFUS_LOW_RESOLUTION_IMAGE_RENDERED_LATENCY");a(oa,"RUFUS_HIGH_RESOLUTION_IMAGE_RENDERED_LATENCY",
"RUFUS_HIGH_RESOLUTION_IMAGE_RENDERED_LATENCY");a(oa,"UPDATE_CL_IMAGE_URL_TO_LOW_RES","UPDATE_CL_IMAGE_URL_TO_LOW_RES");a(oa,"RUFUS_PAPYRUS_DEPENDENCY_LOAD_LATENCY","RUFUS_PAPYRUS_DEPENDENCY_LOAD");var G=x(function Jg(){z(this,Jg)});a(G,"PANEL_RESIZE","PANEL_RESIZE");a(G,"PANEL_RESIZE_RUFUS","PANEL_RESIZE_RUFUS");a(G,"PANEL_CLOSE_CLICK","PANEL_CLOSE_CLICK");a(G,"PANEL_MINIMIZE_CLICK","PANEL_MINIMIZE_CLICK");a(G,"PANEL_EXPAND_CLICK","PANEL_EXPAND_CLICK");a(G,"SCROLL_VIEW","SCROLL_VIEW");a(G,"SCROLL_VIEW_END",
"SCROLL_VIEW_END");a(G,"MAIN_FEEDBACK_REQUEST","MAIN_FEEDBACK_REQUEST");a(G,"DETAIL_FEEDBACK_REQUEST","DETAIL_FEEDBACK_REQUEST");a(G,"RUFUS_PANEL_OVERFLOW_MENU","RUFUS_PANEL_OVERFLOW_MENU");a(G,"INPUT_TEXT_FOCUS","INPUT_TEXT_FOCUS");a(G,"INPUT_TEXT_TRIGGER","INPUT_TEXT_TRIGGER");a(G,"INPUT_TEXT_ERASE","INPUT_TEXT_ERASE");a(G,"LOAD_HISTORY","LOAD_HISTORY");a(G,"INVOKE_NILE","INVOKE_NILE");a(G,"RUFUS_OPEN","RUFUS_OPEN");a(G,"RUFUS_CLOSE","RUFUS_CLOSE");a(G,"CONVERSATION_ABANDONMENT","CONVERSATION_ABANDONMENT");
a(G,"BACK_NAVIGATION","BACK_NAVIGATION");a(G,"INTERRUPTION_RECOVERY_BUTTON_CLICK","INTERRUPTION_RECOVERY_BUTTON_CLICK");a(G,"INTERRUPTION_RECOVERY_BUTTON_SHOWN","INTERRUPTION_RECOVERY_BUTTON_SHOWN");a(G,"OPEN_MEDIA","OPEN_MEDIA");a(G,"CLOSE_MEDIA","CLOSE_MEDIA");a(G,"TEASER_AUTO_EXPANDS_CL","TEASER_AUTO_EXPANDS_CL");a(G,"TEASER_WIDGET_BSR_SENT_TO_SEARCH","TEASER_WIDGET_BSR_SENT_TO_SEARCH");a(G,"TEASER_RECOVERY_WIDGET_SENT_TO_SEARCH","TEASER_RECOVERY_WIDGET_SENT_TO_SEARCH");a(G,"REMOVE_SECTION","REMOVE_SECTION");
a(G,"RUFUS_TWISTER_STREAMING_REQUEST_SENT","RUFUS_TWISTER_STREAMING_REQUEST_SENT");a(G,"CONVERSATION_REFINEMENT_SET","CONVERSATION_REFINEMENT_SET");a(G,"CONVERSATION_REFINEMENT_CLEARED","CONVERSATION_REFINEMENT_CLEARED");a(G,"FILTER_PILL_CLICK","FILTER_PILL_CLICK");a(G,"FILTER_PILL_DISMISS_CLICK","FILTER_PILL_DISMISS");var ia=x(function Sa(){z(this,Sa)});a(ia,"THUMBS_UP","THUMBS_UP");a(ia,"THUMBS_DOWN","THUMBS_DOWN");a(ia,"AUTO_MINIMIZE_ENABLE","AUTO_MINIMIZE_ENABLE");a(ia,"AUTO_MINIMIZE_DISABLE",
"AUTO_MINIMIZE_DISABLE");a(ia,"GET_STARTED","GET_STARTED");a(ia,"OVERFLOW_MENU_CLOSE","CLOSE");a(ia,"OVERFLOW_MENU_OPEN","OPEN");a(ia,"RUFUS_ICON_TAP","RUFUS_ICON_TAP");a(ia,"EXPANDED_TO_MINIMIZED","expanded_to_minimized");a(ia,"ASIN_REFINEMENT","asin_refinement");a(ia,"FILTER_PILL_INGRESS_PREFIX","filter_pill_ingress_");var U=function(a){return a.SWIPE_UP="SWIPE_UP",a.ASIN_CLICK="ASIN_CLICK",a.SEARCH="SEARCH",a.CLOSE="CLOSE",a.UNKNOWN="UNKNOWN",a}({}),tf=function(a){return a.FIRST_TIME_USER_MESSAGE_SEEN_STATUS=
"FIRST_TIME_USER_MESSAGE_SEEN_STATUS",a}({}),uf=function(a){return a.SEEN="SEEN",a}({}),ua=function(a){return a.NILE_CL_TEXT_INPUT="NileCLTextInput",a.NILE_RELATED_QUESTION="NileRelatedQuestion",a.NILE_DEALS_RELATED_QUESTION="NileDealsRelatedQuestion",a.NILE_NDSWDCS_RELATED_QUESTION="NileNDSWDCSRelatedQuestion",a.NILE_ASIN_INGRESS="NileAsinIngress",a}({}),La=function(a){return a.NILE_OPTION_IN_AUTOCOMPLETE="NileOptionInAutocomplete",a.NILE_TEASER_CX_RECOVERY="NileTeaserRecovery",a.NILE_INGRESS_LINK=
"NileIngressLink",a}({}),H=function(a){return a.FATAL="FATAL",a.ERROR="ERROR",a.WARN="WARN",a.DEBUG="DEBUG",a}({}),db=function(a){return a.ClickToATF="af",a.ClickToCF="cf",a.ClickToPageLoaded="ld",a.ClickToBodyBegin="bb",a.ClickToBodyEnd="be",a}({}),m=function(){function a(){z(this,a)}return x(a,null,[{key:"logErrorWithLevelWithException",value:function(a,b,g){g=g?"".concat(g," ").concat(b.message):"".concat(b.message);c.ueLogError&&a!=H.DEBUG?(a={logLevel:a,attribution:"rufus_panel",message:"error occurred with following message ".concat(g)},
c.ueLogError(b,a)):console.error(b.message)}},{key:"logErrorWithLevel",value:function(a,b,g){c.ueLogError&&a!=H.DEBUG?(a={logLevel:a,attribution:"rufus_panel",message:"error occurred with following message: ".concat(b)},c.ueLogError(Error(b),a)):console.error(b);g&&this.addCount(g,1)}},{key:"recordTrigger",value:function(a,b,g){c.ue&&(g?c.ue.trigger(a,b,g):c.ue.trigger(a,b))}},{key:"setCount",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;c.ue&&c.ue.count(a,b)}},
{key:"getCount",value:function(a){return c.ue&&c.ue.count&&null!=c.ue.count(a)?c.ue.count(a):0}},{key:"addCount",value:function(a,b){this.setCount(a,this.getCount(a)+b)}},{key:"logEvent",value:function(a,b,g){var I;null===(I=c.ue)||void 0===I||I.event(a,b,g)}},{key:"sendCsmFeatureLatency",value:function(a,b){c.uex&&(b?c.uex(db.ClickToPageLoaded,a,{wb:1},b):c.uex(db.ClickToPageLoaded,a,{wb:1}))}},{key:"logCsmFeatureLatency",value:function(a,b,g){c.uet&&(g?c.uet(a,b,{wb:1},g):c.uet(a,b,{wb:1}))}},{key:"fetchRequestIdFromCSMData",
value:function(){return c.ue&&c.ue.id?c.ue.id:""}},{key:"widgetBodyBegin",value:function(b,c){a.logCsmFeatureLatency(db.ClickToBodyBegin,b,c)}},{key:"widgetBodyEnd",value:function(b,c,g){c||a.logCsmFeatureLatency(db.ClickToBodyEnd,b,g);a.sendCsmFeatureLatency(b,g)}}])}(),kh=new Map([["expanded_minimized","rufus-panel-expanded-to-minimized"],["expanded_closed","rufus-panel-expanded-to-closed"],["minimized_expanded","rufus-panel-minimized-to-expanded"],["minimized_closed","rufus-panel-expanded-to-closed"],
["closed_expanded","rufus-panel-closed-to-expanded"]]),lh=new Map([["¬¨‚àû","\x26deg;"],["¬¨‚àü","\x26trade;"],["¬¨‚àö","\x26reg;"],["¬¨‚àö©","\x26copy;"],["¬¨‚àû‚àö√≤","\x26hellip;"],["¬¨‚àû‚àö√ñ","\x26mdash;"],["¬¨‚àû‚àö√í","\x26ndash;"],["¬¨‚àö√∫","\x26lsquo;"],["¬¨‚àö√≠","\x26rsquo;"],["¬¨‚àö√¢","\x26ldquo;"],["¬¨‚àö√£","\x26rdquo;"]]),sb=function(a){return a.HIDDEN="hidden",a.COLLAPSED="collapsed",a.EXPANDED="expanded",a}({}),tb=function(a){return a.FEEDBACK="nl_cl_dsk_fb",a.HISTORY="nl_cl_dsk_hist",
a.CUSTOMER_SUBMITTED_QUERY="nl_cl_dsk_csq",a.RASIN_INGRESS_BUTTON_CLICK="nl_bp_ra_cl_ing",a.DP_FROM_FILTER_PILL="nl_cl_ra_fp",a}({}),mh="https://".concat("development.amazon.com","/"),nh="https://".concat("pre-prod.amazon.com","/"),oh="https://".concat("www.amazon.com","/"),ph=["Up","Down","ArrowUp","ArrowDown"],Kg=function(){function b(){z(this,b);a(this,"_browserVersion","")}return x(b,[{key:"browserVersion",get:function(){return this._browserVersion},set:function(a){this._browserVersion=a}}],[{key:"getInstance",
value:function(){return b.instance||(b.instance=new b),b.instance}}])}(),ye=function(){function b(){z(this,b);a(this,"_browserName","")}return x(b,[{key:"browserName",get:function(){return this._browserName},set:function(a){this._browserName=a}}],[{key:"getInstance",value:function(){return b.instance||(b.instance=new b),b.instance}}])}(),Lg=function(){function b(){z(this,b);a(this,"_osType","")}return x(b,[{key:"osType",get:function(){return this._osType},set:function(a){this._osType=a}}],[{key:"getInstance",
value:function(){return b.instance||(b.instance=new b),b.instance}}])}(),ze=function(){function b(){z(this,b);a(this,"_deviceVersion","")}return x(b,[{key:"deviceVersion",get:function(){return this._deviceVersion},set:function(a){this._deviceVersion=a}}],[{key:"getInstance",value:function(){return b.instance||(b.instance=new b),b.instance}}])}(),Ae=function(){function b(){z(this,b);a(this,"_tabId","")}return x(b,[{key:"tabId",get:function(){return this._tabId},set:function(a){this._tabId=a}}],[{key:"getInstance",
value:function(){return b.instance||(b.instance=new b),b.instance}}])}(),pb=function(){function b(){z(this,b);a(this,"_nileRequestId","")}return x(b,[{key:"nileRequestId",get:function(){return this._nileRequestId},set:function(a){this._nileRequestId=a}}],[{key:"getInstance",value:function(){return b.instance||(b.instance=new b),b.instance}}])}(),Mg=function(a){return a.EVENT_SCHEMA="mshop.nile.events.5",a.LATENCY_SCHEMA_V2="mshop.nile.latency.6",a.IMPRESSION_SCHEMA="mshop.nile.impressions.1",a}({}),
Ia=function(){return x(function id(){z(this,id);a(this,"listeners",new Map)},[{key:"on",value:function(a,b){this.listeners.has(a)||this.listeners.set(a,[]);this.listeners.get(a).push(b)}},{key:"off",value:function(a,b){var c=this.listeners.get(a);c&&this.listeners.set(a,c.filter(function(a){return a!==b}))}},{key:"dispatch",value:function(a,b){(a=this.listeners.get(a))&&a.forEach(function(a){a(b)})}}])}(),vf=x(function id(){z(this,id)});a(vf,"TEASER_CX_CUSTOMER_QUERY","tcxcq");var K=function(){return x(function wa(){z(this,
wa)},null,[{key:"extractQueryFromUrl",value:function(a){return(a=this.capture(a,/[?&]k=([^&/]*)/i))?decodeURIComponent(a.replace(/\+/g," ")):void 0}},{key:"extractAsinFromUrl",value:function(a){return this.capture(a,/(?:\/gp\/aw\/d\/|\/gp\/product\/|\/dp\/product\/|\/exec\/obidos\/ASIN\/|\/gp\/video\/detail\/|\/o\/asin\/|\/exec\/obidos\/tg\/detail\/-\/|.*?\/dp\/|.*?\/d\/|.*?%2Fdp%2F|[?&]asin=|.*?\/vindp\/)(?:[^/?]*?\/)*(\w{10}\b)/i)}},{key:"extractGtiFromUrl",value:function(a){return this.capture(a,
/\/gp\/video\/detail\/(\w{26}|[\w.]+gti.[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12})\b/i)}},{key:"extractNileReftagFromUrl",value:function(a){var b,c=/^(ref|ref_)(.*)$/;a=function(a,b){var k="undefined"!=typeof Symbol&&a[Symbol.iterator]||a["@@iterator"];if(!k){if(Array.isArray(a)||(k=function(a,b){if(a){if("string"==typeof a)return re(a,b);var k={}.toString.call(a).slice(8,-1);return"Object"===k&&a.constructor&&(k=a.constructor.name),"Map"===k||"Set"===k?Array.from(a):"Arguments"===k||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(k)?
re(a,b):void 0}}(a))||b&&a&&"number"==typeof a.length){k&&(a=k);var d=0;b=function(){};return{s:b,n:function(){return d>=a.length?{done:!0}:{done:!1,value:a[d++]}},e:function(a){throw a;},f:b}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var w,h=!0,l=!1;return{s:function(){k=k.call(a)},n:function(){var a=k.next();return h=a.done,a},e:function(a){l=!0;w=a},f:function(){try{h||null==k.return||
k.return()}finally{if(l)throw w;}}}}((new URL(a)).searchParams.entries());try{for(a.s();!(b=a.n()).done;){var k=Ca(b.value,2),w=k[1];if(c.exec(k[0])&&w.startsWith("nl_cl_"))return w}}catch(d){a.e(d)}finally{a.f()}}},{key:"getOriginUrl",value:function(){return document.referrer}},{key:"getCurrentPageUrl",value:function(){return c.location.href}},{key:"extractQis",value:function(a){return this.capture(a,/[?&]qis=([^&]*)/)}},{key:"setReftagAndQisInTargetUrl",value:function(a,b){if(!b)return a;try{var c=
new URL(a),k=new URL(b),w=k.searchParams.get("ref"),d=k.searchParams.get("qis");return w&&c.searchParams.set("ref",w),d&&c.searchParams.set("qis",d),c.toString()}catch(y){m.logErrorWithLevelWithException(H.ERROR,y,"Error updating targetUrl with metadata qis and ref: ".concat(y instanceof Error?"(".concat(y.message,")"):""))}return a}},{key:"capture",value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;return(a.match(b)||[])[c]}},{key:"extractBaseUrl",value:function(a){if(a){var b=
a.match(/^(https?:\/\/[^/]+)/);return b?b[1]:a}}}])}();var Jb=K;a(K,"metadataParsers",{DETAIL_PAGE:function(a){var b=Jb.extractAsinFromUrl(a);return b?[{type:"ASIN",value:b}]:(a=Jb.extractGtiFromUrl(a))?[{type:"GTI",value:a}]:void 0},SEARCH_RESULTS:function(a){a=Jb.extractQueryFromUrl(a);if(void 0!==a)return[{type:"KEYWORDS",value:a}]}});a(K,"HOST_NAME_DOMAIN_MAPPING",a(a(a({},"development.amazon.com",mh),"pre-prod.amazon.com",nh),"www.amazon.com",oh));a(K,"getUrlByDomain",function(a,b){return Jb.HOST_NAME_DOMAIN_MAPPING[a]?
"".concat(Jb.HOST_NAME_DOMAIN_MAPPING[a]).concat(b):void 0});a(K,"isDevoDomain",function(){return"development.amazon.com"===c.location.hostname});a(K,"getTeaserCXCustomerQueryFromURLQueryParam",function(a){var b;a=new URL(a);return decodeURIComponent(null!==(b=a.searchParams.get(vf.TEASER_CX_CUSTOMER_QUERY))&&void 0!==b?b:"")});var wf=x(function w(a,b,c,k){z(this,w);this.action=a;this.query=b;this.sectionId=c;this.clickEventName=k}),xf=function(a){return a.POPUP="POPUP",a.SELF="SELF",a}({}),Kb=function(a){return a.OPEN_URL=
"OPEN_URL",a.DISMISS="DISMISS",a.OPEN_MEDIA="OPEN_MEDIA",a.BOTTOM_SHEET_NAVIGATE="BOTTOM_SHEET_NAVIGATE",a.INVOKE_NILE_BACKEND_API="INVOKE_NILE_BACKEND_API",a.NEW_SEARCH_REQUEST="NEW_SEARCH_REQUEST",a.MAIN_FEEDBACK_REQUEST="MAIN_FEEDBACK_REQUEST",a.DETAILED_FEEDBACK_REQUEST="DETAILED_FEEDBACK_REQUEST",a.AD_FEEDBACK_REQUEST="AD_FEEDBACK_REQUEST",a.EXPAND_TO_CONTENT="EXPAND_TO_CONTENT",a.UPDATE_CART_COUNT="UPDATE_CART_COUNT",a}({}),qh=function(b){function g(b){var k;return z(this,g),a(k=function(a,
b,k){return b=v(b),C(a,se()?Reflect.construct(b,[],v(a).constructor):b.apply(a,k))}(this,g),"handleAction",function(a){var b=a.action.actionType;switch(b){case Kb.INVOKE_NILE_BACKEND_API.toString():k.handleInvokeNileBackendApi(a);break;case Kb.OPEN_URL.toString():O(a.action.actionType,a.action.actionId);m.addCount(p.RUFUS_OPEN_URL_CLICK_PREFIX+a.clickEventName,1);k.handleOpenUrlAction(a.action);k.containsCSAIParam(a.action.actionAdditionalProps)&&(k.dispatch("applyAnimationAndStateUpdateWithDefault",
"minimized"),m.addCount(p.RUFUS_CSAI_OPENED,1));break;case Kb.DISMISS.toString():break;default:m.logErrorWithLevel(H.ERROR,"New ActionType: ".concat(b))}}),a(k,"getOpenUrlTarget",function(a){var b,k={targetType:xf.SELF};return null!==(b=null==a?void 0:a.openURLTarget)&&void 0!==b?b:k}),a(k,"isValidPopupTarget",function(a){return 0<a.newWindowHeightPixels&&0<a.newWindowWidthPixels&&-1<a.newWindowScreenPosition}),a(k,"handleOpenUrlAction",function(a){var b=k.getOpenUrlTarget(a.payload);switch(b.targetType){case xf.POPUP:var w=
"width\x3d".concat(b.newWindowWidthPixels,", height\x3d").concat(b.newWindowHeightPixels,", left\x3d").concat(b.newWindowScreenPosition);if(!k.isValidPopupTarget(b)){m.logErrorWithLevel(H.ERROR,"Invalid Popup Target ".concat(w));c.open(a.url,"_self");break}c.open(a.url,b.targetType.toString(),w);break;default:c.open(a.url,"_self")}}),a(k,"handleInvokeNileBackendApi",function(a){var b,w=null!==(b=a.query)&&void 0!==b?b:a.action.payload.query;null!=w&&(k.streamingClient.startStream({actionType:U.SEARCH,
inputQuery:w,qis:a.action.payload.qis,reftag:K.extractNileReftagFromUrl(a.action.url)}),O(a.action.actionType,a.action.actionId),m.addCount(p.RUFUS_RQ_CLICK,1),a.action.payload.qis===ua.NILE_DEALS_RELATED_QUESTION&&m.addCount(p.RUFUS_DEALS_RQ_CLICK,1),a.action.payload.qis===ua.NILE_NDSWDCS_RELATED_QUESTION&&m.addCount(p.RUFUS_WDCS_RQ_CLICK,1))}),a(k,"containsCSAIParam",function(a){return"true"==(null==a?void 0:a.isCSAI)||"true"==(null==a?void 0:a.get("isCSAI"))}),k.streamingClient=b,k}return N(g,
b),x(g)}(Ia),ub=function(a){return a.AUTHENTICATED="authenticated",a.UNAUTHENTICATED="unauthenticated",a.UNKNOWN="unknown",a}({}),rh=function(b){function g(){var b;return z(this,g),a(b=function(a,b,d){return b=v(b),C(a,xe()?Reflect.construct(b,[],v(a).constructor):b.apply(a,d))}(this,g),"lastAuthStatus",ub.UNKNOWN),a(b,"handleStorageEvent",function(a){"csa-tabbed-browsing"==a.key&&b.checkAuthStatus()}),a(b,"handleVisibilityChange",function(){b.checkAuthStatus()}),b.attachEventListeners(),b}return N(g,
b),x(g,[{key:"checkAuthStatus",value:function(){var a=this.isValidAuthSession()?ub.AUTHENTICATED:ub.UNAUTHENTICATED;if(a!==this.lastAuthStatus){if(this.dispatch("authStatusChanged",a),a!==ub.AUTHENTICATED)return m.addCount(p.RUFUS_SIGN_OUT,1),ub.UNAUTHENTICATED;this.lastAuthStatus=a}return a}},{key:"isValidAuthSession",value:function(){var a,b,w,d=fa("authCookieName");return!(""===(a=null!=d&&d.trim()?d:"x-main",b=a.replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1"),w=document.cookie.match("(^|;)\\s*"+b+
"\\s*\x3d\\s*([^;]+)"),w?w.pop():"")&&!K.isDevoDomain())}},{key:"attachEventListeners",value:function(){c.addEventListener("storage",this.handleStorageEvent);document.addEventListener("visibilitychange",this.handleVisibilityChange)}}],[{key:"getInstance",value:function(){return g.instance||(g.instance=new g),g.instance}}])}(Ia),fc={tabId:{key:"".concat("rufus",":tabId")},panel:{key:"".concat("rufus",":panel"),json:!0},impressionsContextMap:{key:"".concat("rufus",":impression-context-map"),json:!0},
previousPageUrl:{key:"".concat("rufus",":previous-page-url")}},yf=function(a,b){b=a.children.length-b;for(var c=0;c<b&&a.firstChild;c++)a.removeChild(a.firstChild)},zf=function(a){Array.from(a.children).forEach(function(b){0===b.children.length&&a.removeChild(b)})},Dd=function(){var a=document.querySelector("#nav-flyout-rufus meta[name\x3d'anti-csrftoken-a2z']");return a&&a.getAttribute("content")||""},Ed=function(){var a=document.querySelector('meta[name\x3d"flow-closure-id"]');if(a instanceof HTMLMetaElement&&
a.content)return a.content},Af=function(a,b){var c=a.firstElementChild;c&&(a.style.width=b?"".concat(b,"px"):"100%",b=c.getBoundingClientRect(),0<b.width&&(a.style.width="".concat(b.width,"px")))},sh=function(){return x(function ca(b,k){var d=this;z(this,ca);a(this,"markCustomerSeenFTUX",function(){d.impressionsContextMap[d.uniqueId]||(d.impressionsContextMap[d.uniqueId]=!0,d.write("impressionsContextMap",d.impressionsContextMap,localStorage))});a(this,"toggleAutoMinimize",function(a){d.panel&&(d.panel.state.autoMinimize=
a,d.setPanel(d.panel))});a(this,"setPreviousPageUrl",function(){d.previousPageUrl=K.getCurrentPageUrl();d.write("previousPageUrl",d.previousPageUrl)});a(this,"isStreamingRequestInProgress",function(){var a;return!1===(null===(a=d.getPanelState())||void 0===a||null===(a=a.requestContext)||void 0===a?void 0:a.requestCompleted)});a(this,"updateLastCacheInvalidatedTimestamp",function(){d.panel&&(d.panel.metadata.lastCacheInvalidatedTimestamp=Date.now(),d.setPanel(d.panel))});a(this,"setRequestMetadata",
function(a){d.panel&&(d.panel.state.requestMetadata=a,d.setPanel(d.panel))});a(this,"getRequestMetadata",function(){var a;return null===(a=d.panel)||void 0===a?void 0:a.state.requestMetadata});this.uniqueId=b;this.isCacheEnabled=k;this.tabId=this.readTabId();this.defaultPanel=this.buildDefaultPanel();this.impressionsContextMap=this.readImpressionsContextMap();this.previousPageUrl=this.readPreviousPageUrl()},[{key:"initialize",value:function(){this.panel=this.readPanel();this.setPreviousPageUrl()}},
{key:"getTabId",value:function(){return this.tabId||m.logErrorWithLevel(H.ERROR,"".concat("RufusCacheManager"," - Error retrieving tabId")),this.tabId}},{key:"getPanel",value:function(){return this.panel||m.logErrorWithLevel(H.ERROR,"".concat("RufusCacheManager"," - Error retrieving panel")),this.panel}},{key:"setPanel",value:function(a){return this.panel=a,this.panel.metadata.creationTimestamp=Date.now(),this.write("panel",this.panel),this.panel}},{key:"setPanelContent",value:(k=A(P().mark(function ca(a){return P().wrap(function(b){for(;;)switch(b.prev=
b.next){case 0:if(this.panel&&this.isCacheEnabled){b.next=1;break}return b.abrupt("return");case 1:this.panel.content=a.innerHTML,this.setPanel(this.panel);case 2:case "end":return b.stop()}},ca,this)})),function(a){return k.apply(this,arguments)})},{key:"setPanelState",value:(I=A(P().mark(function L(a){return P().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(this.panel){b.next=1;break}return b.abrupt("return");case 1:this.panel.state=Ig({},a),this.setPanel(this.panel);case 2:case "end":return b.stop()}},
L,this)})),function(a){return I.apply(this,arguments)})},{key:"getPanelState",value:function(){var a;return null===(a=this.panel)||void 0===a?void 0:a.state}},{key:"setPanelRequestCompleted",value:(c=A(P().mark(function B(a){var b;return P().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(this.panel){k.next=1;break}return k.abrupt("return");case 1:!this.panel.state||!this.panel.state.requestContext||null!==(b=this.panel.state.requestContext)&&void 0!==b&&b.requestCompleted||(this.panel.state.requestContext.requestCompleted=
a),this.setPanel(this.panel);case 2:case "end":return k.stop()}},B,this)})),function(a){return c.apply(this,arguments)})},{key:"setPanelRequestContext",value:(b=A(P().mark(function h(a){return P().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(this.panel){b.next=1;break}return b.abrupt("return");case 1:this.panel.state.requestContext=a,this.setPanel(this.panel);case 2:case "end":return b.stop()}},h,this)})),function(a){return b.apply(this,arguments)})},{key:"hasCustomerSeenFTUX",value:function(){var a;
return null!==(a=this.impressionsContextMap[this.uniqueId])&&void 0!==a&&a}},{key:"shouldInvalidatePanelCache",value:function(){return!this.isPanelCacheLastInvalidatedTimestampWithinTTL(this.getPanel())&&!this.isStreamingRequestInProgress()}},{key:"getPreviousPageUrl",value:function(){return this.previousPageUrl}},{key:"read",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:sessionStorage,k=null,r=fc[a],f=r.key;r=r.json;try{var c=b.getItem(f);c&&(k=r?JSON.parse(c):c)}catch(Z){m.logErrorWithLevelWithException(H.ERROR,
Z,"".concat("RufusCacheManager"," - Error reading from ").concat(f," ").concat(Z instanceof Error?"(".concat(Z.message,")"):"")),k=null}return k}},{key:"write",value:function(a,b){var k=2<arguments.length&&void 0!==arguments[2]?arguments[2]:sessionStorage,h=fc[a],f=h.key;h=h.json;if("object"===g(b)&&!h)return m.logErrorWithLevel(H.ERROR,"".concat("RufusCacheManager"," - Trying to serialize a non-json object ").concat(f)),!1;try{return k.setItem(f,"object"===g(b)?JSON.stringify(b):b),!0}catch(F){return m.logErrorWithLevelWithException(H.ERROR,
F,"".concat("RufusCacheManager"," - Error writing from ").concat(f," ").concat(F instanceof Error?"(".concat(F.message,")"):"")),!1}}},{key:"readTabId",value:function(){var a=this.read("tabId");return a||(a=S(),this.write("tabId",a),m.addCount(p.RUFUS_TAB_ID_GENERATED,1)),a}},{key:"readPanel",value:function(){var a=this.read("panel");return this.validatePanel(a)||(a=this.clonePanel(this.defaultPanel),this.write("panel",a)),this.isCacheEnabled||(a.content=""),this.validatePanelContent(a)||(a.content=
"",a.metadata.creationTimestamp=Date.now()),a}},{key:"readImpressionsContextMap",value:function(){var b=this.read("impressionsContextMap",localStorage);return null!=b?b:a({},this.uniqueId,!1)}},{key:"readPreviousPageUrl",value:function(){var a=this.read("previousPageUrl");return a||(a=K.getCurrentPageUrl(),this.write("previousPageUrl",a)),a}},{key:"buildDefaultPanel",value:function(){return{content:"",metadata:{creationTimestamp:Date.now(),uniqueId:this.uniqueId,lastCacheInvalidatedTimestamp:Date.now(),
flowClosureId:Ed()},state:{height:300,width:320,viewState:"closed"}}}},{key:"validatePanel",value:function(a){var b;if((null==a||null===(b=a.metadata)||void 0===b?void 0:b.uniqueId)!==this.uniqueId)return!1;b=Ed();return void 0===b||b===a.metadata.flowClosureId}},{key:"validatePanelContent",value:function(a){return 2E6>a.content.length}},{key:"clonePanel",value:function(a){return JSON.parse(JSON.stringify(a))}},{key:"isPanelCacheLastInvalidatedTimestampWithinTTL",value:function(a){return void 0===
a||864E5>Math.abs(a.metadata.lastCacheInvalidatedTimestamp-Date.now())}}]);var b,c,I,k}(),eb=x(function ja(){z(this,ja)});a(eb,"CONTENT_TYPE","Content-Type");a(eb,"ANTI_CSRF_TOKEN","anti-csrftoken-a2z");a(eb,"FLOW_CLOSURE_ID","x-amzn-flow-closure-id");var Bf=function(a){function b(a,k){z(this,b);var d=b;a=[a,k];return d=v(d),C(this,ue()?Reflect.construct(d,a||[],v(this).constructor):d.apply(this,a))}return N(b,a),x(b,[{key:"fetchHistory",value:(k=A(P().mark(function y(a){var k,d,c=this,h=arguments;
return P().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return d=(k=1<h.length&&void 0!==h[1]?h[1]:"")?oa.RUFUS_INTERRUPTION_RECOVERY_LATENCY:oa.RUFUS_HISTORY_LATENCY,m.widgetBodyBegin(d),l.abrupt("return",new Promise(function(h,f){c.abortCurrentRequest();c.currentRequest=c.post(b.HISTORY_ENDPOINT,{method:"POST",params:k?c.buildInterruptionRecoveryRequest(k):c.buildRequest(a),paramsFormat:"json",contentType:"application/json",success:function(a){return c.onFetchHistorySuccess(a,h,d,k)},error:function(a,
b){return c.onFetchHistoryError(a,b,f,d)}})}));case 1:case "end":return l.stop()}},y)})),function(a){return k.apply(this,arguments)})},{key:"hasMoreHistory",value:function(){var a,b;return null===(a=null===(b=this.lastResponseMetadata)||void 0===b?void 0:b.hasAdditionalHistory)||void 0===a||a}},{key:"isFirstTimeLoadHistory",value:function(){var a;return!(null!==(a=this.lastResponseMetadata)&&void 0!==a&&a.lastFetchedTurnId)}},{key:"buildRequest",value:function(a){var b,k;a={tabId:this.tabId,maxTurns:a+
5,historyOrder:"ASC",historySource:"CONVERSATION_LAYER"};return null!==(b=this.lastResponseMetadata)&&void 0!==b&&b.lastFetchedTurnId&&(a.lastFetchedTurnId=null===(k=this.lastResponseMetadata)||void 0===k?void 0:k.lastFetchedTurnId),a}},{key:"buildInterruptionRecoveryRequest",value:function(a){return{tabId:this.tabId,maxTurns:2,historyOrder:"ASC",historySource:"CONVERSATION_LAYER",interruptedConversationRecoveryContext:{interruptedConversationRequestId:a,isInterruptedConversationRecoveryRequest:!0}}}},
{key:"retrieveRecoveredInterruptedConversation",value:function(a,b){var k,d=null===(k=this.lastResponseMetadata)||void 0===k?void 0:k.conversationHistoryRequestIds;return d&&(b=d.lastIndexOf(b),-1!==b&&(a=(new DOMParser).parseFromString(a,"text/html"),a=Array.from(a.getElementsByClassName("conversation-turn-container")),a=b<a.length&&0<=b?a[b].outerHTML:null))?a:""}},{key:"onFetchHistorySuccess",value:function(a,b,k,c){this.lastResponseMetadata=a.metadata;this.currentRequest=void 0;a=function(a){var b=
(new DOMParser).parseFromString(a,"text/html"),k=document.createDocumentFragment();a=Array.from(b.getElementsByClassName("rufus-customer-text"));var d=b.getElementById("rufus-welcome-message-box-container");if(d&&d.parentElement){var f=b.createElement("div");f.className="conversation-turn-container";f.appendChild(d.parentElement.cloneNode(!0));k.appendChild(f)}a.forEach(function(a){var h=b.createElement("div");h.className="conversation-turn-container";(a=a.parentElement)&&h.appendChild(a.cloneNode(!0));
for(a=a?a.nextElementSibling:null;a&&!a.querySelector(".rufus-customer-text");)h.appendChild(a.cloneNode(!0)),a=a.nextElementSibling;k.appendChild(h)});a=b.createElement("div");return a.appendChild(k),a.innerHTML}(a.renderedHistoryContent);b(c?this.retrieveRecoveredInterruptedConversation(a,c):a);m.widgetBodyEnd(k,!1)}},{key:"onFetchHistoryError",value:function(a,b,k,c){this.currentRequest=void 0;k(b);m.logErrorWithLevel(H.ERROR,"Error fetching history. Status Code: ".concat(a.status,", Status text: ").concat(b));
m.widgetBodyEnd(c,!0)}}]);var k}(function(){return x(function w(a,b){z(this,w);this.A=a;this.tabId=b},[{key:"post",value:function(a,b){return this.A.post(a,hd(hd({},b),{},{headers:this.buildPostHeaders()}))}},{key:"get",value:function(a,b){return this.A.get(a,hd({},b))}},{key:"abortCurrentRequest",value:function(){this.currentRequest&&(this.currentRequest.abort(),this.currentRequest=void 0)}},{key:"isLoading",value:function(){return!!this.currentRequest}},{key:"buildPostHeaders",value:function(){return a({},
eb.ANTI_CSRF_TOKEN,Dd())}}])}());a(Bf,"HISTORY_ENDPOINT","/rufus/cl/"+"history?ref\x3d".concat(tb.HISTORY));var nb=function(a){return a[a.INSUFFICIENT_BROWSER_CAPABILITIES=10]="INSUFFICIENT_BROWSER_CAPABILITIES",a[a.UNDEFINED_EVENT_SOURCE=20]="UNDEFINED_EVENT_SOURCE",a[a.SSE_HANDLER_ERROR=30]="SSE_HANDLER_ERROR",a[a.TIMEOUT=40]="TIMEOUT",a[a.OFFLINE=50]="OFFLINE",a[a.HANDLE_CONTEXT_CHUNK_ERROR=60]="HANDLE_CONTEXT_CHUNK_ERROR",a}({}),fb=function(){function a(b){E(this,a);this._key=b}return D(a,[{key:"asString",
value:function(){return this._key}}],[{key:"of",value:function(b){if(this.KEY_REGISTRY.has(b))throw Error("Key with name ".concat(b," already exist. AttributeKeys ").concat(JSON.stringify(this.KEY_REGISTRY)," must only be created once."));return this.KEY_REGISTRY.add(b),new a(b)}}])}();fb.KEY_REGISTRY=new Set;var pa=D(function I(){E(this,I)});pa.LOCALE_KEY=fb.of("locale");pa.DEFAULT_LOCALE_KEY=fb.of("defaultLocale");pa.TIME_ZONE_KEY=fb.of("timeZone");pa.I18N_DOMAIN_KEY=fb.of("i18nDomain");pa.CX_TUPLE_KEY=
fb.of("cxTuple");pa.CURRENCY_KEY=fb.of("currency");pa.DEFAULT_CURRENCY_KEY=fb.of("defaultCurrency");var th=function(){return D(function w(a){E(this,w);this._locale=a.locale;this._defaultLocale=a.defaultLocale;this._timeZone=a.timeZone;this._i18nDomain=a.i18nDomain},[{key:"getTimeZone",value:function(){return this._timeZone}},{key:"getLocale",value:function(){return this._locale}},{key:"getDefaultLocale",value:function(){return this._defaultLocale}},{key:"getI18nDomain",value:function(){return this._i18nDomain}},
{key:"asAttributesMap",value:function(){return new Map([["locale",this._locale],["defaultLocale",this._defaultLocale],["timeZone",this._timeZone],["i18nDomain",this._i18nDomain]])}},{key:"toString",value:function(){var a="LocalizationContext[";return a+="".concat("locale","\x3d").concat(this.getLocale(),","),a+="".concat("timeZone","\x3d").concat(this.getTimeZone(),","),a+"".concat("defaultLocale","\x3d").concat(this.getDefaultLocale(),",")+"".concat("i18nDomain","\x3d").concat(this.getI18nDomain(),
"]")}},{key:"getAttribute",value:function(a){switch(a){case pa.LOCALE_KEY:return this.getLocale();case pa.DEFAULT_LOCALE_KEY:return this.getDefaultLocale();case pa.TIME_ZONE_KEY:case pa.I18N_DOMAIN_KEY:return this.getTimeZone()}}}])}(),mb=function(){function a(){E(this,a);this._locale=a.DEFAULT_LOCALE;this._defaultLocale=void 0;this._timeZone=a.DEFAULT_TIME_ZONE;this._i18nDomain=""}return D(a,[{key:"locale",get:function(){return this._locale}},{key:"defaultLocale",get:function(){return this._defaultLocale}},
{key:"timeZone",get:function(){return this._timeZone}},{key:"i18nDomain",get:function(){return this._i18nDomain}},{key:"withLocale",value:function(b){try{this._locale=Intl.getCanonicalLocales(b)[0]}catch(w){console.error("Provided Locale is invalid: locale\x3d".concat(b,". Using default runtime locale: ").concat(a.DEFAULT_LOCALE))}return this}},{key:"withDefaultLocale",value:function(a){try{this._defaultLocale=Intl.getCanonicalLocales(a)[0]}catch(w){console.error("Provided DefaultLocale is invalid: defaultLocale:".concat(a,
"."))}return this}},{key:"withI18nDomain",value:function(a){return this._i18nDomain=a,this}},{key:"withTimeZone",value:function(b){try{this._timeZone=(new Intl.DateTimeFormat(void 0,{timeZone:b})).resolvedOptions().timeZone}catch(w){console.error("Provided TimeZone is invalid: timeZone\x3d".concat(b,". Using default TimeZone: ").concat(a.DEFAULT_TIME_ZONE))}return this}},{key:"build",value:function(){return new th(this)}}])}();mb.DATE_TIME_OPTIONS=(new Intl.DateTimeFormat).resolvedOptions();mb.DEFAULT_LOCALE=
mb.DATE_TIME_OPTIONS.locale;mb.DEFAULT_TIME_ZONE=mb.DATE_TIME_OPTIONS.timeZone;var fh=function(){return D(function w(a){E(this,w);this.provideContext=a},[{key:"getLocalizationContext",value:function(){return this.provideContext()}}])}(),uh=function(a){function b(){return E(this,b),da(this,b,arguments)}return ea(b,a),D(b)}(function(){return D(function k(){E(this,k)},[{key:"getObfuscatedMarketplaceId",value:function(){}},{key:"getDefaultLocale",value:function(){return Intl.DateTimeFormat().resolvedOptions().locale}},
{key:"getDefaultCurrency",value:function(){}}])}()),Cf=function(){function a(){E(this,a)}return D(a,[{key:"getMarketplace",value:function(){return a.emptyMarketplace}}])}();Cf.emptyMarketplace=new uh;(function(){function a(){E(this,a)}return D(a,null,[{key:"setProvider",value:function(b){a.marketplaceProvider=b}},{key:"provider",value:function(){return a.marketplaceProvider||(a.marketplaceProvider=new Cf),a.marketplaceProvider}}])})().marketplaceProvider=void 0;var Fd,ob=function(){function a(b){E(this,
a);this._programs=ab(b);this._programs.sort()}return D(a,[{key:"has",value:function(a){return this._programs.includes(a)}},{key:"isEmpty",value:function(){return 0==this._programs.length}},{key:"toString",value:function(){var b=this._programs.join(a.DELIMITER);return a.OPENING_CHAR+b+a.CLOSING_CHAR}},{key:"equals",value:function(a){return!!a&&this.toString()===a.toString()}}],[{key:"of",value:function(b){return new a(b)}},{key:"fromString",value:function(b){if(!b.startsWith(a.OPENING_CHAR)||!b.endsWith(a.CLOSING_CHAR))throw Error("Invalid fully qualified CXProgram: ".concat(b,
". Valid example: [exports]."));var k=b.substring(1,b.length-1).trim();if(0==k.length)return a.EMPTY;var d;b=[];k=ba(k.split(a.DELIMITER));try{for(k.s();!(d=k.n()).done;){var c=d.value,I=c.trim().toLowerCase();if(!Object.values(Fd).includes(I))throw Error("Unrecognized program ".concat(c));b.push(I)}}catch(L){k.e(L)}finally{k.f()}return new a(b)}}])}();ob.EMPTY=ob.of([]);ob.DELIMITER=",";ob.OPENING_CHAR="[";ob.CLOSING_CHAR="]";(function(a){a.EXPORTS="exports";a.B2B="b2b"})(Fd||(Fd={}));var vb=function(){function a(b,
w){var k=2<arguments.length&&void 0!==arguments[2]?arguments[2]:ob.EMPTY;E(this,a);this._cxFamily=a.validateString("cxFamily",b);this._cxId=a.validateString("cxId",w);this._cxProgram=k}return D(a,[{key:"cxFamily",get:function(){return this._cxFamily}},{key:"cxId",get:function(){return this._cxId}},{key:"cxProgram",get:function(){return this._cxProgram}},{key:"toString",value:function(){return this._cxProgram.isEmpty()?this._cxFamily+"/"+this._cxId:this._cxFamily+"/"+this._cxId+"/"+this._cxProgram.toString()}},
{key:"equals",value:function(a){return this._cxFamily===a._cxFamily&&this._cxId==this._cxId&&this._cxProgram===a._cxProgram}}],[{key:"of",value:function(b,w,d){return new a(b,w,d)}},{key:"fromString",value:function(b){var k=b.split("/");if(2!=k.length&&3!=k.length)throw Error("Invalid fully qualified CXTuple: ".concat(b));b=k[0];var d=k[1];return 3==k.length?new a(b,d,ob.fromString(k[2])):new a(b,d)}},{key:"validateString",value:function(a,b){if(!b)throw Error("".concat(a," must not be empty"));for(var k=
0;k<b.length;k++){var c=b.charAt(k);if(!("."===c||"-"===c||"A"<=c&&"Z">=c||"a"<=c&&"z">=c||"0"<=c&&"9">=c))throw Error("Invalid character ".concat(c," in ").concat(a,": ").concat(b));}return b}}])}();vb.UNKNOWN=new vb("unknown","unknown");var vh=function(){return D(function w(a){E(this,w);this._attributes=a},[{key:"getAttribute",value:function(a){return this._attributes.get(a)}},{key:"asAttributesMap",value:function(){var a,b=new Map,d=ba(this._attributes.keys());try{for(d.s();!(a=d.n()).done;){var c=
a.value;b.set(c.asString(),this._attributes.get(c))}}catch(ca){d.e(ca)}finally{d.f()}return b}},{key:"getDefaultLocale",value:function(){return this.getAttribute(pa.DEFAULT_LOCALE_KEY)}},{key:"getI18nDomain",value:function(){return this.getAttribute(pa.I18N_DOMAIN_KEY)}},{key:"getLocale",value:function(){return this.getAttribute(pa.LOCALE_KEY)}},{key:"getTimeZone",value:function(){return this.getAttribute(pa.TIME_ZONE_KEY)}}])}(),Gd=function(){return D(function d(a,b){E(this,d);this.attributeKey=
a;this.value=b},[{key:"getAttribute",value:function(a){return this.value}},{key:"getProvidedAttributes",value:function(){var a=new Set;return a.add(this.attributeKey),a}}])}(),wb=function(){return D(function k(){E(this,k);for(var a=new Map,b=arguments.length,c=Array(b),g=0;g<b;g++)c[g]=arguments[g];for(b=0;b<c.length;b++){var L;g=c[b];var B=ba(g.getProvidedAttributes());try{for(B.s();!(L=B.n()).done;){var h=L.value;if(a.has(h))throw Error("Attribute ".concat(h.asString()," is already provided by ").concat(a.get(h),
"."));a.set(h,g)}}catch(l){B.e(l)}finally{B.f()}}a.has(pa.LOCALE_KEY)||a.set(pa.LOCALE_KEY,k.JVM_LOCALE_PROVIDER);a.has(pa.TIME_ZONE_KEY)||a.set(pa.TIME_ZONE_KEY,k.JVM_TIME_ZONE_PROVIDER);a.has(pa.I18N_DOMAIN_KEY)||a.set(pa.I18N_DOMAIN_KEY,k.DEFAULT_I18N_DOMAIN_PROVIDER);this._attributeProviders=a},[{key:"getLocalizationContext",value:function(){var a,b=new Map,d=ba(this._attributeProviders);try{for(d.s();!(a=d.n()).done;){var c=Ta(a.value,2),g=c[0];b.set(g,c[1].getAttribute(g))}}catch(L){d.e(L)}finally{d.f()}return new vh(b)}}])}();
wb.DATE_TIME_OPTIONS=(new Intl.DateTimeFormat).resolvedOptions();wb.JVM_LOCALE_PROVIDER=new Gd(pa.LOCALE_KEY,wb.DATE_TIME_OPTIONS.locale);wb.JVM_TIME_ZONE_PROVIDER=new Gd(pa.TIME_ZONE_KEY,wb.DATE_TIME_OPTIONS.timeZone);wb.DEFAULT_I18N_DOMAIN_PROVIDER=new Gd(pa.TIME_ZONE_KEY,"");var Ba="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof c?c:void 0!==R.g?R.g:"undefined"!=typeof self?self:{},Df=function(){return D(function k(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};
if(E(this,k),!(a.maxSize&&0<a.maxSize))throw new TypeError("`maxSize` must be a number greater than 0");this.maxSize=a.maxSize;this.onEviction=a.onEviction;this.cache=new Map;this.oldCache=new Map;this._size=0},[{key:"_set",value:function(a,b){if(this.cache.set(a,b),this._size++,this._size>=this.maxSize){if(this._size=0,"function"==typeof this.onEviction){var k;a=ba(this.oldCache.entries());try{for(a.s();!(k=a.n()).done;){var c=Ta(k.value,2);this.onEviction(c[0],c[1])}}catch(ca){a.e(ca)}finally{a.f()}}this.oldCache=
this.cache;this.cache=new Map}}},{key:"get",value:function(a){if(this.cache.has(a))return this.cache.get(a);if(this.oldCache.has(a)){var b=this.oldCache.get(a);return this.oldCache.delete(a),this._set(a,b),b}}},{key:"set",value:function(a,b){return this.cache.has(a)?this.cache.set(a,b):this._set(a,b),this}},{key:"has",value:function(a){return this.cache.has(a)||this.oldCache.has(a)}},{key:"peek",value:function(a){return this.cache.has(a)?this.cache.get(a):this.oldCache.has(a)?this.oldCache.get(a):
void 0}},{key:"delete",value:function(a){var b=this.cache.delete(a);return b&&this._size--,this.oldCache.delete(a)||b}},{key:"clear",value:function(){this.cache.clear();this.oldCache.clear();this._size=0}},{key:"keys",value:na().m(function w(){var a,b,c,L,B;return na().w(function(h){for(;;)switch(h.p=h.n){case 0:a=ba(this),h.p=1,a.s();case 2:if((b=a.n()).done){h.n=4;break}return c=Ta(b.value,1),L=c[0],h.n=3,L;case 3:h.n=2;break;case 4:h.n=6;break;case 5:h.p=5,B=h.v,a.e(B);case 6:return h.p=6,a.f(),
h.f(6);case 7:return h.a(2)}},w,this,[[1,5,6,7]])})},{key:"values",value:na().m(function d(){var a,b,c,B,h;return na().w(function(l){for(;;)switch(l.p=l.n){case 0:a=ba(this),l.p=1,a.s();case 2:if((b=a.n()).done){l.n=4;break}return c=Ta(b.value,2),B=c[1],l.n=3,B;case 3:l.n=2;break;case 4:l.n=6;break;case 5:l.p=5,h=l.v,a.e(h);case 6:return l.p=6,a.f(),l.f(6);case 7:return l.a(2)}},d,this,[[1,5,6,7]])})},{key:Symbol.iterator,value:na().m(function y(){var a,b,c,h,l,r,f,F,g,X;return na().w(function(y){for(;;)switch(y.p=
y.n){case 0:a=ba(this.cache),y.p=1,a.s();case 2:if((b=a.n()).done){y.n=4;break}return c=b.value,y.n=3,c;case 3:y.n=2;break;case 4:y.n=6;break;case 5:y.p=5,g=y.v,a.e(g);case 6:return y.p=6,a.f(),y.f(6);case 7:h=ba(this.oldCache),y.p=8,h.s();case 9:if((l=h.n()).done){y.n=11;break}if(r=l.value,f=Ta(r,1),F=f[0],this.cache.has(F)){y.n=10;break}return y.n=10,r;case 10:y.n=9;break;case 11:y.n=13;break;case 12:y.p=12,X=y.v,h.e(X);case 13:return y.p=13,h.f(),y.f(13);case 14:return y.a(2)}},y,this,[[8,12,13,
14],[1,5,6,7]])})},{key:"size",get:function(){var a,b=0,c=ba(this.oldCache.keys());try{for(c.s();!(a=c.n()).done;)this.cache.has(a.value)||b++}catch(B){c.e(B)}finally{c.f()}return Math.min(this._size+b,this.maxSize)}}])}(),wh=function(a){return String(a)},Ef=function(){return D(function d(a,b){E(this,d);this.loader=a;this.storage=new Df(b);this.serializeKeyFn=void 0!==b.keyFn?b.keyFn:wh},[{key:"get",value:function(a){var b=this.serializeKeyFn(a),k=this.storage.get(b);if(k)return k;a=this.loader(a);
return void 0!==a?(this.storage.set(b,a),a):void 0}},{key:"size",value:function(){return this.storage.size}},{key:"has",value:function(a){return this.storage.has(this.serializeKeyFn(a))}}])}(),Hd=function(){function a(b,c){E(this,a);this._bundle=b;this._context=c}return D(a,[{key:"bundle",get:function(){return this._bundle}},{key:"context",get:function(){return this._context}}],[{key:"generateCacheKey",value:function(b){var k,d=b.bundle;b=b.context.asAttributesMap();var c=ba(a.LOCALIZATION_CONTEXT_ATTRIBUTES_FOR_CACHE_KEY);
try{for(c.s();!(k=c.n()).done;){var I=k.value,L=b.get(I);L&&(d+="#".concat(I,"#").concat(L))}}catch(B){c.e(B)}finally{c.f()}return d}}])}();Hd.LOCALIZATION_CONTEXT_ATTRIBUTES_FOR_CACHE_KEY=["locale","defaultLocale","i18nDomain"];var Q,Y,qb,Id=function(){return D(function y(a,b,d){E(this,y);this._bundle=a;this._variants=d;this._locale=b},[{key:"bundle",get:function(){return this._bundle}},{key:"variants",get:function(){return this._variants}},{key:"locale",get:function(){return this._locale}}],[{key:"cacheKey",
value:function(a){var b=a.bundle;return a.variants&&a.variants.forEach(function(a,k){b+="#var-".concat(k,"#").concat(a)}),b+="#".concat(a.locale)}}])}(),Ff=function(){function a(){E(this,a)}return D(a,[{key:"getFallbackChains",value:function(a,b,d){var k=this.createLocaleFallbackChain(d.getLocale(),d.getDefaultLocale()),c=this.getVariantFallbackChain(b,d);return Fb({},Symbol.iterator,na().m(function B(){var b,l,d,f,w,I,y,g,ca,m,p,t,v,x,A,z;return na().w(function(h){for(;;)switch(h.p=h.n){case 0:b=
ba(c),h.p=1,b.s();case 2:if((l=b.n()).done){h.n=16;break}d=l.value;f=ba(d);h.p=3;f.s();case 4:if((w=f.n()).done){h.n=12;break}I=w.value;y=ba(k);h.p=5;y.s();case 6:if((g=y.n()).done){h.n=8;break}return ca=g.value,h.n=7,new Id(a,ca,I);case 7:h.n=6;break;case 8:h.n=10;break;case 9:h.p=9,v=h.v,y.e(v);case 10:return h.p=10,y.f(),h.f(10);case 11:h.n=4;break;case 12:h.n=14;break;case 13:h.p=13,x=h.v,f.e(x);case 14:return h.p=14,f.f(),h.f(14);case 15:h.n=2;break;case 16:h.n=18;break;case 17:h.p=17,A=h.v,
b.e(A);case 18:return h.p=18,b.f(),h.f(18);case 19:m=ba(k),h.p=20,m.s();case 21:if((p=m.n()).done){h.n=23;break}return t=p.value,h.n=22,new Id(a,t,void 0);case 22:h.n=21;break;case 23:h.n=25;break;case 24:h.p=24,z=h.v,m.e(z);case 25:return h.p=25,m.f(),h.f(25);case 26:return h.a(2)}},B,null,[[20,24,25,26],[5,9,10,11],[3,13,14,15],[1,17,18,19]])}))}},{key:"getVariantFallbackChain",value:function(a,b){var k=b.asAttributesMap();return Fb({},Symbol.iterator,na().m(function ca(){var b,d,h,l,r,f,c,w,I;
return na().w(function(F){for(;;)switch(F.n){case 0:b=0;case 1:if(!(b<a.length)){F.n=9;break}d=[];b<a.length-1&&(d=a[b+1]);h=a[b];l=!0;r=[];f=new Map;c=0;case 2:if(!(c<h.length)){F.n=7;break}if(k){F.n=3;break}return F.a(3,6);case 3:if(w=h[c],I=k.get(w)){F.n=4;break}return F.a(3,6);case 4:if(f.set(w,I),!(l&&c<d.length&&d[c]===h[c])){F.n=5;break}return F.a(3,6);case 5:l=!1,r.push(new Map(f));case 6:c++;F.n=2;break;case 7:return F.n=8,r.reverse();case 8:b++;F.n=1;break;case 9:return F.a(2)}},ca)}))}},
{key:"createLocaleFallbackChain",value:function(a,b){a=Intl.getCanonicalLocales(a)[0];b=void 0!==b?Intl.getCanonicalLocales(b)[0]:b;a=this.getFallbackChain(a);b&&!a.includes(b)&&(b=this.getFallbackChain(b),a.push.apply(a,ab(b)));return a.push("und"),a}},{key:"getFallbackChain",value:function(b){var k=[];b=(new Intl.Locale(b)).baseName;if("und"!==b){k.push(b);for(var d=b.lastIndexOf(a.LOCALE_TAG_SEPARATOR);0<d;)b=b.substr(0,d),k.push(b),d=b.lastIndexOf(a.LOCALE_TAG_SEPARATOR)}return k}}])}();Ff.LOCALE_TAG_SEPARATOR=
"-";(function(a){a[a.EXPECT_ARGUMENT_CLOSING_BRACE=1]="EXPECT_ARGUMENT_CLOSING_BRACE";a[a.EMPTY_ARGUMENT=2]="EMPTY_ARGUMENT";a[a.MALFORMED_ARGUMENT=3]="MALFORMED_ARGUMENT";a[a.EXPECT_ARGUMENT_TYPE=4]="EXPECT_ARGUMENT_TYPE";a[a.INVALID_ARGUMENT_TYPE=5]="INVALID_ARGUMENT_TYPE";a[a.EXPECT_ARGUMENT_STYLE=6]="EXPECT_ARGUMENT_STYLE";a[a.INVALID_NUMBER_SKELETON=7]="INVALID_NUMBER_SKELETON";a[a.INVALID_DATE_TIME_SKELETON=8]="INVALID_DATE_TIME_SKELETON";a[a.EXPECT_NUMBER_SKELETON=9]="EXPECT_NUMBER_SKELETON";
a[a.EXPECT_DATE_TIME_SKELETON=10]="EXPECT_DATE_TIME_SKELETON";a[a.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE=11]="UNCLOSED_QUOTE_IN_ARGUMENT_STYLE";a[a.EXPECT_SELECT_ARGUMENT_OPTIONS=12]="EXPECT_SELECT_ARGUMENT_OPTIONS";a[a.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE=13]="EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE";a[a.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE=14]="INVALID_PLURAL_ARGUMENT_OFFSET_VALUE";a[a.EXPECT_SELECT_ARGUMENT_SELECTOR=15]="EXPECT_SELECT_ARGUMENT_SELECTOR";a[a.EXPECT_PLURAL_ARGUMENT_SELECTOR=16]="EXPECT_PLURAL_ARGUMENT_SELECTOR";
a[a.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT=17]="EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT";a[a.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT=18]="EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT";a[a.INVALID_PLURAL_ARGUMENT_SELECTOR=19]="INVALID_PLURAL_ARGUMENT_SELECTOR";a[a.DUPLICATE_PLURAL_ARGUMENT_SELECTOR=20]="DUPLICATE_PLURAL_ARGUMENT_SELECTOR";a[a.DUPLICATE_SELECT_ARGUMENT_SELECTOR=21]="DUPLICATE_SELECT_ARGUMENT_SELECTOR";a[a.MISSING_OTHER_CLAUSE=22]="MISSING_OTHER_CLAUSE";a[a.INVALID_TAG=23]="INVALID_TAG";
a[a.INVALID_TAG_NAME=25]="INVALID_TAG_NAME";a[a.UNMATCHED_CLOSING_TAG=26]="UNMATCHED_CLOSING_TAG";a[a.UNCLOSED_TAG=27]="UNCLOSED_TAG"})(Q||(Q={}));(function(a){a[a.literal=0]="literal";a[a.argument=1]="argument";a[a.number=2]="number";a[a.date=3]="date";a[a.time=4]="time";a[a.select=5]="select";a[a.plural=6]="plural";a[a.pound=7]="pound";a[a.tag=8]="tag";a[a.price=9]="price"})(Y||(Y={}));(function(a){a[a.number=0]="number";a[a.dateTime=1]="dateTime"})(qb||(qb={}));var Gf=/[ \xA0\u1680\u2000-\u200A\u202F\u205F\u3000]/,
Qg=/(?:[Eec]{1,6}|G{1,5}|[Qq]{1,5}|(?:[yYur]+|U{1,5})|[ML]{1,5}|d{1,2}|D{1,3}|F{1}|[abB]{1,5}|[hkHK]{1,2}|w{1,2}|W{1}|m{1,2}|s{1,2}|[zZOvVxX]{1,4})(?=([^']*'[^']*')*[^']*$)/g,sa=function(){return sa=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var y in b=arguments[c])Object.prototype.hasOwnProperty.call(b,y)&&(a[y]=b[y]);return a},sa.apply(this,arguments)},yh=/[\t-\r \x85\u200E\u200F\u2028\u2029]/i,He=/^\.(?:(0+)(\*)?|(#+)|(0+)(#+))$/g,Fe=/^(@+)?(\+|#+)?[rs]?$/g,Tg=/(\*)(0+)|(#+)(0+)|(0+)/g,
Ge=/^(0+)$/,Xb={AX:["H"],BQ:["H"],CP:["H"],CZ:["H"],DK:["H"],FI:["H"],ID:["H"],IS:["H"],ML:["H"],NE:["H"],RU:["H"],SE:["H"],SJ:["H"],SK:["H"],AS:["h","H"],BT:["h","H"],DJ:["h","H"],ER:["h","H"],GH:["h","H"],IN:["h","H"],LS:["h","H"],PG:["h","H"],PW:["h","H"],SO:["h","H"],TO:["h","H"],VU:["h","H"],WS:["h","H"],"001":["H","h"],AL:["h","H","hB"],TD:["h","H","hB"],"ca-ES":["H","h","hB"],CF:["H","h","hB"],CM:["H","h","hB"],"fr-CA":["H","h","hB"],"gl-ES":["H","h","hB"],"it-CH":["H","h","hB"],"it-IT":["H",
"h","hB"],LU:["H","h","hB"],NP:["H","h","hB"],PF:["H","h","hB"],SC:["H","h","hB"],SM:["H","h","hB"],SN:["H","h","hB"],TF:["H","h","hB"],VA:["H","h","hB"],CY:["h","H","hb","hB"],GR:["h","H","hb","hB"],CO:["h","H","hB","hb"],DO:["h","H","hB","hb"],KP:["h","H","hB","hb"],KR:["h","H","hB","hb"],NA:["h","H","hB","hb"],PA:["h","H","hB","hb"],PR:["h","H","hB","hb"],VE:["h","H","hB","hb"],AC:["H","h","hb","hB"],AI:["H","h","hb","hB"],BW:["H","h","hb","hB"],BZ:["H","h","hb","hB"],CC:["H","h","hb","hB"],CK:["H",
"h","hb","hB"],CX:["H","h","hb","hB"],DG:["H","h","hb","hB"],FK:["H","h","hb","hB"],GB:["H","h","hb","hB"],GG:["H","h","hb","hB"],GI:["H","h","hb","hB"],IE:["H","h","hb","hB"],IM:["H","h","hb","hB"],IO:["H","h","hb","hB"],JE:["H","h","hb","hB"],LT:["H","h","hb","hB"],MK:["H","h","hb","hB"],MN:["H","h","hb","hB"],MS:["H","h","hb","hB"],NF:["H","h","hb","hB"],NG:["H","h","hb","hB"],NR:["H","h","hb","hB"],NU:["H","h","hb","hB"],PN:["H","h","hb","hB"],SH:["H","h","hb","hB"],SX:["H","h","hb","hB"],TA:["H",
"h","hb","hB"],ZA:["H","h","hb","hB"],"af-ZA":["H","h","hB","hb"],AR:["H","h","hB","hb"],CL:["H","h","hB","hb"],CR:["H","h","hB","hb"],CU:["H","h","hB","hb"],EA:["H","h","hB","hb"],"es-BO":["H","h","hB","hb"],"es-BR":["H","h","hB","hb"],"es-EC":["H","h","hB","hb"],"es-ES":["H","h","hB","hb"],"es-GQ":["H","h","hB","hb"],"es-PE":["H","h","hB","hb"],GT:["H","h","hB","hb"],HN:["H","h","hB","hb"],IC:["H","h","hB","hb"],KG:["H","h","hB","hb"],KM:["H","h","hB","hb"],LK:["H","h","hB","hb"],MA:["H","h","hB",
"hb"],MX:["H","h","hB","hb"],NI:["H","h","hB","hb"],PY:["H","h","hB","hb"],SV:["H","h","hB","hb"],UY:["H","h","hB","hb"],JP:["H","h","K"],AD:["H","hB"],AM:["H","hB"],AO:["H","hB"],AT:["H","hB"],AW:["H","hB"],BE:["H","hB"],BF:["H","hB"],BJ:["H","hB"],BL:["H","hB"],BR:["H","hB"],CG:["H","hB"],CI:["H","hB"],CV:["H","hB"],DE:["H","hB"],EE:["H","hB"],FR:["H","hB"],GA:["H","hB"],GF:["H","hB"],GN:["H","hB"],GP:["H","hB"],GW:["H","hB"],HR:["H","hB"],IL:["H","hB"],IT:["H","hB"],KZ:["H","hB"],MC:["H","hB"],
MD:["H","hB"],MF:["H","hB"],MQ:["H","hB"],MZ:["H","hB"],NC:["H","hB"],NL:["H","hB"],PM:["H","hB"],PT:["H","hB"],RE:["H","hB"],RO:["H","hB"],SI:["H","hB"],SR:["H","hB"],ST:["H","hB"],TG:["H","hB"],TR:["H","hB"],WF:["H","hB"],YT:["H","hB"],BD:["h","hB","H"],PK:["h","hB","H"],AZ:["H","hB","h"],BA:["H","hB","h"],BG:["H","hB","h"],CH:["H","hB","h"],GE:["H","hB","h"],LI:["H","hB","h"],ME:["H","hB","h"],RS:["H","hB","h"],UA:["H","hB","h"],UZ:["H","hB","h"],XK:["H","hB","h"],AG:["h","hb","H","hB"],AU:["h",
"hb","H","hB"],BB:["h","hb","H","hB"],BM:["h","hb","H","hB"],BS:["h","hb","H","hB"],CA:["h","hb","H","hB"],DM:["h","hb","H","hB"],"en-001":["h","hb","H","hB"],FJ:["h","hb","H","hB"],FM:["h","hb","H","hB"],GD:["h","hb","H","hB"],GM:["h","hb","H","hB"],GU:["h","hb","H","hB"],GY:["h","hb","H","hB"],JM:["h","hb","H","hB"],KI:["h","hb","H","hB"],KN:["h","hb","H","hB"],KY:["h","hb","H","hB"],LC:["h","hb","H","hB"],LR:["h","hb","H","hB"],MH:["h","hb","H","hB"],MP:["h","hb","H","hB"],MW:["h","hb","H","hB"],
NZ:["h","hb","H","hB"],SB:["h","hb","H","hB"],SG:["h","hb","H","hB"],SL:["h","hb","H","hB"],SS:["h","hb","H","hB"],SZ:["h","hb","H","hB"],TC:["h","hb","H","hB"],TT:["h","hb","H","hB"],UM:["h","hb","H","hB"],US:["h","hb","H","hB"],VC:["h","hb","H","hB"],VG:["h","hb","H","hB"],VI:["h","hb","H","hB"],ZM:["h","hb","H","hB"],BO:["H","hB","h","hb"],EC:["H","hB","h","hb"],ES:["H","hB","h","hb"],GQ:["H","hB","h","hb"],PE:["H","hB","h","hb"],AE:["h","hB","hb","H"],"ar-001":["h","hB","hb","H"],BH:["h","hB",
"hb","H"],DZ:["h","hB","hb","H"],EG:["h","hB","hb","H"],EH:["h","hB","hb","H"],HK:["h","hB","hb","H"],IQ:["h","hB","hb","H"],JO:["h","hB","hb","H"],KW:["h","hB","hb","H"],LB:["h","hB","hb","H"],LY:["h","hB","hb","H"],MO:["h","hB","hb","H"],MR:["h","hB","hb","H"],OM:["h","hB","hb","H"],PH:["h","hB","hb","H"],PS:["h","hB","hb","H"],QA:["h","hB","hb","H"],SA:["h","hB","hb","H"],SD:["h","hB","hb","H"],SY:["h","hB","hb","H"],TN:["h","hB","hb","H"],YE:["h","hB","hb","H"],AF:["H","hb","hB","h"],LA:["H",
"hb","hB","h"],CN:["H","hB","hb","h"],LV:["H","hB","hb","h"],TL:["H","hB","hb","h"],"zu-ZA":["H","hB","hb","h"],CD:["hB","H"],IR:["hB","H"],"hi-IN":["hB","h","H"],"kn-IN":["hB","h","H"],"ml-IN":["hB","h","H"],"te-IN":["hB","h","H"],KH:["hB","h","H","hb"],"ta-IN":["hB","h","hb","H"],BN:["hb","hB","h","H"],MY:["hb","hB","h","H"],ET:["hB","hb","h","H"],"gu-IN":["hB","hb","h","H"],"mr-IN":["hB","hb","h","H"],"pa-IN":["hB","hb","h","H"],TW:["hB","hb","h","H"],KE:["hB","hb","H","h"],MM:["hB","hb","H","h"],
TZ:["hB","hb","H","h"],UG:["hB","hb","H","h"]},zh=new RegExp("^".concat(Gf.source,"*")),Ah=new RegExp("".concat(Gf.source,"*$")),Bh=!!String.prototype.startsWith,Ch=!!String.fromCodePoint,Dh=!!Object.fromEntries,Eh=!!String.prototype.codePointAt,Fh=!!String.prototype.trimStart,Gh=!!String.prototype.trimEnd,Hh=Number.isSafeInteger?Number.isSafeInteger:function(a){return"number"==typeof a&&isFinite(a)&&Math.floor(a)===a&&9007199254740991>=Math.abs(a)},Jd=!0;try{var Hf=RegExp("([^\\p{White_Space}\\p{Pattern_Syntax}]*)",
"yu").exec("a");Jd="a"===(Hf&&Hf[0])}catch(I){Jd=!1}var If=Bh?function(a,b,c){return a.startsWith(b,c)}:function(a,b,c){return a.slice(c,c+b.length)===b},Kd=Ch?String.fromCodePoint:function(){for(var a,b="",c=arguments.length,d=0;c>d;){var y;if(1114111<(a=0>(y=d++)||arguments.length<=y?void 0:arguments[y]))throw RangeError(a+" is not a valid code point");b+=65536>a?String.fromCharCode(a):String.fromCharCode(55296+((a-=65536)>>10),a%1024+56320)}return b},Jf=Dh?Object.fromEntries:function(a){var b,
c={};a=ba(a);try{for(a.s();!(b=a.n()).done;){var d=Ta(b.value,2);c[d[0]]=d[1]}}catch(y){a.e(y)}finally{a.f()}return c},Kf=Eh?function(a,b){return a.codePointAt(b)}:function(a,b){var k=a.length;if(!(0>b||b>=k)){var d,c=a.charCodeAt(b);return 55296>c||56319<c||b+1===k||56320>(d=a.charCodeAt(b+1))||57343<d?c:d-56320+(c-55296<<10)+65536}},Ih=Fh?function(a){return a.trimStart()}:function(a){return a.replace(zh,"")},Jh=Gh?function(a){return a.trimEnd()}:function(a){return a.replace(Ah,"")};if(Jd){var Lf=
RegExp("([^\\p{White_Space}\\p{Pattern_Syntax}]*)","yu");var Mf=function(a,b){Lf.lastIndex=b;return(a=Lf.exec(a))&&void 0!==a[1]&&null!==a[1]?a[1]:""}}else Mf=function(a,b){for(var k=[];;){var d=Kf(a,b);if(void 0===d||Ie(d)||33<=d&&35>=d||36===d||37<=d&&39>=d||40===d||41===d||42===d||43===d||44===d||45===d||46<=d&&47>=d||58<=d&&59>=d||60<=d&&62>=d||63<=d&&64>=d||91===d||92===d||93===d||94===d||96===d||123===d||124===d||125===d||126===d||161===d||162<=d&&165>=d||166===d||167===d||169===d||171===d||
172===d||174===d||176===d||177===d||182===d||187===d||191===d||215===d||247===d||8208<=d&&8213>=d||8214<=d&&8215>=d||8216===d||8217===d||8218===d||8219<=d&&8220>=d||8221===d||8222===d||8223===d||8224<=d&&8231>=d||8240<=d&&8248>=d||8249===d||8250===d||8251<=d&&8254>=d||8257<=d&&8259>=d||8260===d||8261===d||8262===d||8263<=d&&8273>=d||8274===d||8275===d||8277<=d&&8286>=d||8592<=d&&8596>=d||8597<=d&&8601>=d||8602<=d&&8603>=d||8604<=d&&8607>=d||8608===d||8609<=d&&8610>=d||8611===d||8612<=d&&8613>=d||
8614===d||8615<=d&&8621>=d||8622===d||8623<=d&&8653>=d||8654<=d&&8655>=d||8656<=d&&8657>=d||8658===d||8659===d||8660===d||8661<=d&&8691>=d||8692<=d&&8959>=d||8960<=d&&8967>=d||8968===d||8969===d||8970===d||8971===d||8972<=d&&8991>=d||8992<=d&&8993>=d||8994<=d&&9E3>=d||9001===d||9002===d||9003<=d&&9083>=d||9084===d||9085<=d&&9114>=d||9115<=d&&9139>=d||9140<=d&&9179>=d||9180<=d&&9185>=d||9186<=d&&9254>=d||9255<=d&&9279>=d||9280<=d&&9290>=d||9291<=d&&9311>=d||9472<=d&&9654>=d||9655===d||9656<=d&&9664>=
d||9665===d||9666<=d&&9719>=d||9720<=d&&9727>=d||9728<=d&&9838>=d||9839===d||9840<=d&&10087>=d||10088===d||10089===d||10090===d||10091===d||10092===d||10093===d||10094===d||10095===d||10096===d||10097===d||10098===d||10099===d||10100===d||10101===d||10132<=d&&10175>=d||10176<=d&&10180>=d||10181===d||10182===d||10183<=d&&10213>=d||10214===d||10215===d||10216===d||10217===d||10218===d||10219===d||10220===d||10221===d||10222===d||10223===d||10224<=d&&10239>=d||10240<=d&&10495>=d||10496<=d&&10626>=d||
10627===d||10628===d||10629===d||10630===d||10631===d||10632===d||10633===d||10634===d||10635===d||10636===d||10637===d||10638===d||10639===d||10640===d||10641===d||10642===d||10643===d||10644===d||10645===d||10646===d||10647===d||10648===d||10649<=d&&10711>=d||10712===d||10713===d||10714===d||10715===d||10716<=d&&10747>=d||10748===d||10749===d||10750<=d&&11007>=d||11008<=d&&11055>=d||11056<=d&&11076>=d||11077<=d&&11078>=d||11079<=d&&11084>=d||11085<=d&&11123>=d||11124<=d&&11125>=d||11126<=d&&11157>=
d||11158===d||11159<=d&&11263>=d||11776<=d&&11777>=d||11778===d||11779===d||11780===d||11781===d||11782<=d&&11784>=d||11785===d||11786===d||11787===d||11788===d||11789===d||11790<=d&&11798>=d||11799===d||11800<=d&&11801>=d||11802===d||11803===d||11804===d||11805===d||11806<=d&&11807>=d||11808===d||11809===d||11810===d||11811===d||11812===d||11813===d||11814===d||11815===d||11816===d||11817===d||11818<=d&&11822>=d||11823===d||11824<=d&&11833>=d||11834<=d&&11835>=d||11836<=d&&11839>=d||11840===d||11841===
d||11842===d||11843<=d&&11855>=d||11856<=d&&11857>=d||11858===d||11859<=d&&11903>=d||12289<=d&&12291>=d||12296===d||12297===d||12298===d||12299===d||12300===d||12301===d||12302===d||12303===d||12304===d||12305===d||12306<=d&&12307>=d||12308===d||12309===d||12310===d||12311===d||12312===d||12313===d||12314===d||12315===d||12316===d||12317===d||12318<=d&&12319>=d||12320===d||12336===d||64830===d||64831===d||65093<=d&&65094>=d)break;k.push(d);b+=65536<=d?2:1}return Kd.apply(void 0,k)};var Kh=function(){return D(function w(a){var b=
1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};E(this,w);this.message=a;this.position={offset:0,line:1,column:1};this.ignoreTag=!!b.ignoreTag;this.locale=b.locale;this.requiresOtherClause=!!b.requiresOtherClause;this.shouldParseSkeletons=!!b.shouldParseSkeletons},[{key:"parse",value:function(){if(0!==this.offset())throw Error("parser can only be used once");return this.parseMessage(0,"",!1)}},{key:"parseMessage",value:function(a,b,d){for(var k=[];!this.isEOF();){var c=this.char();if(123===
c){c=this.parseArgument(a,d);if(c.err)return c;k.push(c.val)}else{if(125===c&&0<a)break;if(35!==c||"plural"!==b&&"selectordinal"!==b){if(60===c&&!this.ignoreTag&&47===this.peek()){if(d)break;return this.error(Q.UNMATCHED_CLOSING_TAG,T(this.clonePosition(),this.clonePosition()))}if(60===c&&!this.ignoreTag&&td(this.peek()||0)){c=this.parseTag(a,b);if(c.err)return c;k.push(c.val)}else{c=this.parseLiteral(a,b);if(c.err)return c;k.push(c.val)}}else c=this.clonePosition(),this.bump(),k.push({type:Y.pound,
location:T(c,this.clonePosition())})}}return{val:k,err:null}}},{key:"parseTag",value:function(a,b){var k=this.clonePosition();this.bump();var c=this.parseTagName();if(this.bumpSpace(),this.bumpIf("/\x3e"))return{val:{type:Y.literal,value:"\x3c".concat(c,"/\x3e"),location:T(k,this.clonePosition())},err:null};if(this.bumpIf("\x3e")){a=this.parseMessage(a+1,b,!0);if(a.err)return a;a=a.val;b=this.clonePosition();if(this.bumpIf("\x3c/")){if(this.isEOF()||!td(this.char()))return this.error(Q.INVALID_TAG,
T(b,this.clonePosition()));var w=this.clonePosition();return c!==this.parseTagName()?this.error(Q.UNMATCHED_CLOSING_TAG,T(w,this.clonePosition())):(this.bumpSpace(),this.bumpIf("\x3e")?{val:{type:Y.tag,value:c,children:a,location:T(k,this.clonePosition())},err:null}:this.error(Q.INVALID_TAG,T(b,this.clonePosition())))}return this.error(Q.UNCLOSED_TAG,T(k,this.clonePosition()))}return this.error(Q.INVALID_TAG,T(k,this.clonePosition()))}},{key:"parseTagName",value:function(){var a=this.offset();for(this.bump();!this.isEOF()&&
Vg(this.char());)this.bump();return this.message.slice(a,this.offset())}},{key:"parseLiteral",value:function(a,b){for(var k=this.clonePosition(),c="";;){var w=this.tryParseQuote(b);if(w)c+=w;else if(w=this.tryParseUnquoted(a,b))c+=w;else{w=this.tryParseLeftAngleBracket();if(!w)break;c+=w}}a=T(k,this.clonePosition());return{val:{type:Y.literal,value:c,location:a},err:null}}},{key:"tryParseLeftAngleBracket",value:function(){return this.isEOF()||60!==this.char()||!this.ignoreTag&&(td(a=this.peek()||
0)||47===a)?null:(this.bump(),"\x3c");var a}},{key:"tryParseQuote",value:function(a){if(this.isEOF()||39!==this.char())return null;switch(this.peek()){case 39:return this.bump(),this.bump(),"'";case 123:case 60:case 62:case 125:break;case 35:if("plural"===a||"selectordinal"===a)break;return null;default:return null}this.bump();a=[this.char()];for(this.bump();!this.isEOF();){var b=this.char();if(39===b){if(39!==this.peek()){this.bump();break}a.push(39);this.bump()}else a.push(b);this.bump()}return Kd.apply(void 0,
a)}},{key:"tryParseUnquoted",value:function(a,b){if(this.isEOF())return null;var k=this.char();return 60===k||123===k||35===k&&("plural"===b||"selectordinal"===b)||125===k&&0<a?null:(this.bump(),Kd(k))}},{key:"parseArgument",value:function(a,b){var k=this.clonePosition();if(this.bump(),this.bumpSpace(),this.isEOF())return this.error(Q.EXPECT_ARGUMENT_CLOSING_BRACE,T(k,this.clonePosition()));if(125===this.char())return this.bump(),this.error(Q.EMPTY_ARGUMENT,T(k,this.clonePosition()));var c=this.parseIdentifierIfPossible().value;
if(!c)return this.error(Q.MALFORMED_ARGUMENT,T(k,this.clonePosition()));if(this.bumpSpace(),this.isEOF())return this.error(Q.EXPECT_ARGUMENT_CLOSING_BRACE,T(k,this.clonePosition()));switch(this.char()){case 125:return this.bump(),{val:{type:Y.argument,value:c,location:T(k,this.clonePosition())},err:null};case 44:return this.bump(),this.bumpSpace(),this.isEOF()?this.error(Q.EXPECT_ARGUMENT_CLOSING_BRACE,T(k,this.clonePosition())):this.parseArgumentOptions(a,b,c,k);default:return this.error(Q.MALFORMED_ARGUMENT,
T(k,this.clonePosition()))}}},{key:"parseIdentifierIfPossible",value:function(){var a=this.clonePosition(),b=this.offset(),d=Mf(this.message,b);return this.bumpTo(b+d.length),{value:d,location:T(a,this.clonePosition())}}},{key:"parseArgumentOptions",value:function(a,b,d,c){var k=this.clonePosition(),w=this.parseIdentifierIfPossible().value,B=this.clonePosition();switch(w){case "":return this.error(Q.EXPECT_ARGUMENT_TYPE,T(k,B));case "number":case "price":case "date":case "time":this.bumpSpace();a=
null;if(this.bumpIf(",")){this.bumpSpace();a=this.clonePosition();b=this.parseSimpleArgStyleIfPossible();if(b.err)return b;b=Jh(b.val);if(0===b.length)return this.error(Q.EXPECT_ARGUMENT_STYLE,T(this.clonePosition(),this.clonePosition()));a={style:b,styleLocation:T(a,this.clonePosition())}}b=this.tryParseArgumentClose(c);if(b.err)return b;c=T(c,this.clonePosition());if(a&&a.style&&If(a.style,"::",0)){b=Ih(a.style.slice(2));if("number"===w)return w=this.parseNumberSkeletonFromString(b,a.styleLocation),
w.err?w:{val:{type:Y.number,value:d,location:c,style:w.val},err:null};if(0===b.length)return this.error(Q.EXPECT_DATE_TIME_SKELETON,c);k=b;if(this.locale){k=this.locale;B="";for(var h=0;h<b.length;h++){var l=b.charAt(h);if("j"===l){for(var r=0;h+1<b.length&&b.charAt(h+1)===l;)r++,h++;l=1+(1&r);r=2>r?1:3+(r>>1);var f=Ug(k);for("H"!=f&&"k"!=f||(r=0);0<r--;)B+="a";for(;0<l--;)B=f+B}else B+="J"===l?"H":l}k=B}a={type:qb.dateTime,pattern:k,location:a.styleLocation,parsedOptions:this.shouldParseSkeletons?
Pg(k):{}};return{val:{type:"date"===w?Y.date:Y.time,value:d,location:c,style:a},err:null}}return{val:{type:"number"===w?Y.number:"price"===w?Y.price:"date"===w?Y.date:Y.time,value:d,location:c,style:a&&void 0!==a.style&&null!==a.style?a.style:null},err:null};case "plural":case "selectordinal":case "select":k=this.clonePosition();if(this.bumpSpace(),!this.bumpIf(","))return this.error(Q.EXPECT_SELECT_ARGUMENT_OPTIONS,T(k,Object.assign({},k)));this.bumpSpace();B=this.parseIdentifierIfPossible();k=0;
if("select"!==w&&"offset"===B.value){if(!this.bumpIf(":"))return this.error(Q.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE,T(this.clonePosition(),this.clonePosition()));this.bumpSpace();k=this.tryParseDecimalInteger(Q.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE,Q.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE);if(k.err)return k;this.bumpSpace();B=this.parseIdentifierIfPossible();k=k.val}a=this.tryParsePluralOrSelectOptions(a,w,b,B);if(a.err)return a;b=this.tryParseArgumentClose(c);if(b.err)return b;c=T(c,this.clonePosition());
return"select"===w?{val:{type:Y.select,value:d,options:Jf(a.val),location:c},err:null}:{val:{type:Y.plural,value:d,options:Jf(a.val),offset:k,pluralType:"plural"===w?"cardinal":"ordinal",location:c},err:null};default:return this.error(Q.INVALID_ARGUMENT_TYPE,T(k,B))}}},{key:"tryParseArgumentClose",value:function(a){return this.isEOF()||125!==this.char()?this.error(Q.EXPECT_ARGUMENT_CLOSING_BRACE,T(a,this.clonePosition())):(this.bump(),{val:!0,err:null})}},{key:"parseSimpleArgStyleIfPossible",value:function(){for(var a=
0,b=this.clonePosition();!this.isEOF();)switch(this.char()){case 39:this.bump();var d=this.clonePosition();if(!this.bumpUntil("'"))return this.error(Q.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE,T(d,this.clonePosition()));this.bump();break;case 123:a+=1;this.bump();break;case 125:if(!(0<a))return{val:this.message.slice(b.offset,this.offset()),err:null};--a;break;default:this.bump()}return{val:this.message.slice(b.offset,this.offset()),err:null}}},{key:"parseNumberSkeletonFromString",value:function(a,b){var k=
[];try{k=function(a){if(0===a.length)throw Error("Number skeleton cannot be empty");var b=[],k=0;for(a=a.split(yh).filter(function(a){return 0<a.length});k<a.length;k++){var d=a[k].split("/");if(0===d.length)throw Error("Invalid number skeleton");var h=d[0];d=d.slice(1);for(var l=0,r=d;l<r.length;l++)if(0===r[l].length)throw Error("Invalid number skeleton");b.push({stem:h,options:d})}return b}(a)}catch(y){return this.error(Q.INVALID_NUMBER_SKELETON,b)}return{val:{type:qb.number,tokens:k,location:b,
parsedOptions:this.shouldParseSkeletons?Sg(k):{}},err:null}}},{key:"tryParsePluralOrSelectOptions",value:function(a,b,d,c){var k=!1,w=[],B=new Set,h=c.value;for(c=c.location;;){if(0===h.length){h=this.clonePosition();if("select"===b||!this.bumpIf("\x3d"))break;c=this.tryParseDecimalInteger(Q.EXPECT_PLURAL_ARGUMENT_SELECTOR,Q.INVALID_PLURAL_ARGUMENT_SELECTOR);if(c.err)return c;c=T(h,this.clonePosition());h=this.message.slice(h.offset,this.offset())}if(B.has(h))return this.error("select"===b?Q.DUPLICATE_SELECT_ARGUMENT_SELECTOR:
Q.DUPLICATE_PLURAL_ARGUMENT_SELECTOR,c);"other"===h&&(k=!0);this.bumpSpace();c=this.clonePosition();if(!this.bumpIf("{"))return this.error("select"===b?Q.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT:Q.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT,T(this.clonePosition(),this.clonePosition()));var l=this.parseMessage(a+1,b,d);if(l.err)return l;var r=this.tryParseArgumentClose(c);if(r.err)return r;w.push([h,{value:l.val,location:T(c,this.clonePosition())}]);B.add(h);this.bumpSpace();c=this.parseIdentifierIfPossible();
h=c.value;c=c.location}return 0===w.length?this.error("select"===b?Q.EXPECT_SELECT_ARGUMENT_SELECTOR:Q.EXPECT_PLURAL_ARGUMENT_SELECTOR,T(this.clonePosition(),this.clonePosition())):this.requiresOtherClause&&!k?this.error(Q.MISSING_OTHER_CLAUSE,T(this.clonePosition(),this.clonePosition())):{val:w,err:null}}},{key:"tryParseDecimalInteger",value:function(a,b){var k=1,c=this.clonePosition();this.bumpIf("+")||this.bumpIf("-")&&(k=-1);for(var w=!1,g=0;!this.isEOF();){var B=this.char();if(!(48<=B&&57>=B))break;
w=!0;g=10*g+(B-48);this.bump()}c=T(c,this.clonePosition());return w?Hh(g*=k)?{val:g,err:null}:this.error(b,c):this.error(a,c)}},{key:"offset",value:function(){return this.position.offset}},{key:"isEOF",value:function(){return this.offset()===this.message.length}},{key:"clonePosition",value:function(){return{offset:this.position.offset,line:this.position.line,column:this.position.column}}},{key:"char",value:function(){var a=this.position.offset;if(a>=this.message.length)throw Error("out of bound");
var b=Kf(this.message,a);if(void 0===b)throw Error("Offset ".concat(a," is at invalid UTF-16 code unit boundary"));return b}},{key:"error",value:function(a,b){return{val:null,err:{kind:a,message:this.message,location:b}}}},{key:"bump",value:function(){if(!this.isEOF()){var a=this.char();10===a?(this.position.line+=1,this.position.column=1,this.position.offset+=1):(this.position.column+=1,this.position.offset+=65536>a?1:2)}}},{key:"bumpIf",value:function(a){if(If(this.message,a,this.offset())){for(var b=
0;b<a.length;b++)this.bump();return!0}return!1}},{key:"bumpUntil",value:function(a){var b=this.offset();a=this.message.indexOf(a,b);return 0<=a?(this.bumpTo(a),!0):(this.bumpTo(this.message.length),!1)}},{key:"bumpTo",value:function(a){if(this.offset()>a)throw Error("targetOffset ".concat(a," must be greater than or equal to the current offset ").concat(this.offset()));for(a=Math.min(a,this.message.length);;){var b=this.offset();if(b===a)break;if(b>a)throw Error("targetOffset ".concat(a," is at invalid UTF-16 code unit boundary"));
if(this.bump(),this.isEOF())break}}},{key:"bumpSpace",value:function(){for(;!this.isEOF()&&Ie(this.char());)this.bump()}},{key:"peek",value:function(){if(this.isEOF())return null;var a=this.char(),b=this.offset();a=this.message.charCodeAt(b+(65536<=a?2:1));return null!=a?a:null}}])}(),Yg=function(){return JSON.stringify(arguments)};vd.prototype.get=function(a){return this.cache[a]};vd.prototype.set=function(a,b){this.cache[a]=b};var rb,Xg={create:function(){return new vd}},gc=function(a,b){var k=
b.cache.create();return Je.bind(this,a,k,b.serializer)};!function(a){a.MISSING_VALUE="MISSING_VALUE";a.INVALID_VALUE="INVALID_VALUE";a.MISSING_INTL_API="MISSING_INTL_API"}(rb||(rb={}));var $b=function(a){function b(a,k,c){var d;return E(this,b),(d=da(this,b,[a])).code=k,d.originalMessage=c,d}return ea(b,a),D(b,[{key:"toString",value:function(){return"[formatjs Error: ".concat(this.code,"] ").concat(this.message)}}])}(Wb(Error)),Le=function(a){function b(a,k,c,g){return E(this,b),da(this,b,['Invalid values for "'.concat(a,
'": "').concat(k,'". Options are "').concat(Object.keys(c).join('", "'),'"'),rb.INVALID_VALUE,g])}return ea(b,a),D(b)}($b),$g=function(a){function b(a,k,c){return E(this,b),da(this,b,['Value for "'.concat(a,'" must be of type ').concat(k),rb.INVALID_VALUE,c])}return ea(b,a),D(b)}($b),Ke=function(a){function b(a,k){return E(this,b),da(this,b,['The intl string context variable "'.concat(a,'" was not provided to the string "').concat(k,'"'),rb.MISSING_VALUE,k])}return ea(b,a),D(b)}($b),Aa,Lh=new Map([["no",
"nb"],["iw","he"],["in","id"],["ji","yi"]]),Zb=function(){function a(){E(this,a)}return D(a,null,[{key:"getCanonicalLocaleString",value:function(b){return Array.isArray(b)?b.map(function(b){return a.getCanonicalLocale(a.forLocaleStringInternal(b)).toLocaleString()}):a.getCanonicalLocale(a.forLocaleStringInternal(b)).toLocaleString()}},{key:"getCanonicalLocale",value:function(b){return null==b&&(b=new Intl.Locale((new Intl.NumberFormat).resolvedOptions().locale)),(b=a.processLocale(b)).numberingSystem?
b:new Intl.Locale(b,{numberingSystem:"latn"})}},{key:"processLocale",value:function(a){if(a.toLocaleString().startsWith("und"))return a;var b=Intl.NumberFormat.supportedLocalesOf(a.toLocaleString());return 0===b.length?(b=Lh.get(a.language))?new Intl.Locale(a.baseName.replace(a.language,b)):(console.log("Unsupported locale: ".concat(a.toLocaleString())),new Intl.Locale("und")):new Intl.Locale(b[0])}},{key:"forLocaleStringInternal",value:function(a){return a?new Intl.Locale(a.trim().replace(/_/g,"-")):
void 0}}])}(),Mh=Object.freeze({__proto__:null,LocaleUtil:Zb});!function(a){a[a.literal=0]="literal";a[a.object=1]="object"}(Aa||(Aa={}));var Ld=function(){return D(function k(){E(this,k)},[{key:"getObfuscatedMarketplaceId",value:function(){}},{key:"getDefaultLocale",value:function(){return Intl.DateTimeFormat().resolvedOptions().locale}},{key:"getDefaultCurrency",value:function(){}}])}(),Nh=function(a){function b(){return E(this,b),da(this,b,arguments)}return ea(b,a),D(b)}(Ld),Nf=function(){function a(){E(this,
a)}return D(a,[{key:"getMarketplace",value:function(){return a.emptyMarketplace}}])}();Nf.emptyMarketplace=new Nh;var Of=function(){function a(){E(this,a)}return D(a,null,[{key:"setProvider",value:function(b){a.marketplaceProvider=b}},{key:"provider",value:function(){return a.marketplaceProvider||(a.marketplaceProvider=new Nf),a.marketplaceProvider}}])}();Of.marketplaceProvider=void 0;var Md={A2Q3Y263D00KWC:{name:"BR",locale:"pt-BR",currency:"BRL"},AZXD3QD5B39HD:{name:"BR_DEVO",locale:"pt-BR",currency:"BRL"},
A2EUQ1WTGCTBG2:{name:"CA",locale:"en-CA",currency:"CAD"},A2WDZJZ5TCRMLH:{name:"CL",locale:"es-CL",currency:"CLP"},A2IDBVIE7EAGN4:{name:"CL_DEVO",locale:"es-CL",currency:"CLP"},A1ZXRLSQW2V54D:{name:"CO",locale:"es-CO",currency:"COP"},A1NOHO22DE3OHQ:{name:"CO_DEVO",locale:"es-CO",currency:"COP"},A1AM78C64UM0Y8:{name:"MX",locale:"es-MX",currency:"MXN"},A3P3J5A7D2ZVXI:{name:"MX_DEVO",locale:"es-MX",currency:"MXN"},ATVPDKIKX0DER:{name:"US",locale:"en-US",currency:"USD"},AGWSWK15IEJJ7:{name:"PYOP_US_PROD",
locale:"en-US",currency:"USD"},A3BXB0YN3XH17H:{name:"PYOP_US_PROD_SANDBOX",locale:"en-US",currency:"USD"},A35A4JO734ER04:{name:"PYOP_US_DEVO",locale:"en-US",currency:"USD"},A341L3VCFKNMIY:{name:"PYOP_US_DEVO_SANDBOX",locale:"en-US",currency:"USD"},A2CE4MDCUAASDP:{name:"PYOP_CA_PROD",locale:"en-CA",currency:"CAD"},A2VJI655WT2I0B:{name:"PYOP_CA_PROD_SANDBOX",locale:"en-CA",currency:"CAD"},A1NWP2E4EKQP94:{name:"PYOP_CA_DEVO",locale:"en-CA",currency:"CAD"},ASBG27DKM7EX6:{name:"PYOP_CA_DEVO_SANDBOX",locale:"en-CA",
currency:"CAD"},A2VIGQ35RCS4UG:{name:"AE",locale:"en-AE",currency:"AED"},A34GYYCZVDBSIK:{name:"AE_DEVO",locale:"en-AE",currency:"AED"},A1PA6795UKMFR9:{name:"DE",locale:"de-DE",currency:"EUR"},AMEN7PMS3EDWL:{name:"BE",locale:"fr-FR",currency:"EUR"},A1YFOMBPFBRY22:{name:"BE_DEVO",locale:"fr-FR",currency:"EUR"},ARBP9OOSHTCHU:{name:"EG",locale:"en-AE",currency:"EGP"},AUJPM9XGFJRC7:{name:"EG_DEVO",locale:"en-AE",currency:"EGP"},A1RKKUPIHCS9HS:{name:"ES",locale:"es-ES",currency:"EUR"},AJZF8LZ1EJVJN:{name:"ES_DEVO",
locale:"es-ES",currency:"EUR"},A13V1IB3VIYZZH:{name:"FR",locale:"fr-FR",currency:"EUR"},A1F83G8C2ARO7P:{name:"GB",locale:"en-GB",currency:"GBP"},APJ6JRA9NG5V4:{name:"IT",locale:"it-IT",currency:"EUR"},A3HOBANJMCMD83:{name:"IT_DEVO",locale:"it-IT",currency:"EUR"},A28R8C7NBKEWEA:{name:"IE",locale:"en-IE",currency:"EUR"},AQGJ466SKA0F0:{name:"IE_DEVO",locale:"en-IE",currency:"EUR"},A21TJRUUN4KGV:{name:"IN",locale:"en-IN",currency:"INR"},A2XZLSVIQ0F4JT:{name:"IN_DEVO",locale:"en-IN",currency:"INR"},A3OCL2LJ6GDH9T:{name:"NG",
locale:"en-NG",currency:"NGN"},A3PJZM0QIA8QDU:{name:"NG_DEVO",locale:"en-NG",currency:"NGN"},A1805IZSGTT6HS:{name:"NL",locale:"nl-NL",currency:"EUR"},A1M3WC0SJ3A38T:{name:"NL_DEVO",locale:"nl-NL",currency:"EUR"},A1C3SOZRARQ6R3:{name:"PL",locale:"pl-PL",currency:"PLN"},AKY4K4WKH21YQ:{name:"PL_DEVO",locale:"pl-PL",currency:"PLN"},A17E79C6D8DWNP:{name:"SA",locale:"en-AE",currency:"SAR"},A1MQPSGJ6U9Q54:{name:"SA_DEVO",locale:"en-AE",currency:"SAR"},A2NODRKZP88ZB9:{name:"SE",locale:"sv-SE",currency:"SEK"},
AT614YYYNOC1S:{name:"SE_DEVO",locale:"sv-SE",currency:"SEK"},A33AVAJ2PDY3EV:{name:"TR",locale:"tr-TR",currency:"TRY"},A3CQBQD3RGPJR8:{name:"TR_DEVO",locale:"tr-TR",currency:"TRY"},AE08WJ6YKNBMC:{name:"ZA",locale:"en-ZA",currency:"ZAR"},A3TFQ1G9L8TQ5L:{name:"ZA_DEVO",locale:"en-ZA",currency:"ZAR"},AZAJMM36N6WQL:{name:"PYOP_UK_PROD",locale:"en-GB",currency:"GBP"},A3M3RRFO9XDT2G:{name:"PYOP_UK_PROD_SANDBOX",locale:"en-GB",currency:"GBP"},A2UWQKHEFGNQY3:{name:"PYOP_UK_DEVO",locale:"en-GB",currency:"GBP"},
A2V84NPDZD3ZEH:{name:"PYOP_UK_DEVO_SANDBOX",locale:"en-GB",currency:"GBP"},A53RDEWN57UU5:{name:"PYOP_DE_PROD",locale:"de-DE",currency:"EUR"},A1G8446IYHA4MR:{name:"PYOP_DE_PROD_SANDBOX",locale:"de-DE",currency:"EUR"},A34RX6LWLXD2KA:{name:"PYOP_DE_DEVO",locale:"de-DE",currency:"EUR"},A225AO9WA6YYOF:{name:"PYOP_DE_DEVO_SANDBOX",locale:"de-DE",currency:"EUR"},A3FDG49KKM823Y:{name:"PYOP_IN_PROD",locale:"en-IN",currency:"INR"},A1IAUC0NN979H6:{name:"PYOP_IN_PROD_SANDBOX",locale:"en-IN",currency:"INR"},A18VPDB9UTK24D:{name:"PYOP_IN_DEVO",
locale:"en-IN",currency:"INR"},A16Z2XWZJTFS70:{name:"PYOP_IN_DEVO_SANDBOX",locale:"en-IN",currency:"INR"},A39IBJ37TRP1C6:{name:"AU",locale:"en-AU",currency:"AUD"},A1RNPCQ4K8U27I:{name:"AU_DEVO",locale:"en-AU",currency:"AUD"},A1VC38T7YXB528:{name:"JP",locale:"ja-JP",currency:"JPY"},AD2EMQ3L3PG8S:{name:"RU",locale:"ru-RU",currency:"RUB"},A38NPJYVS5YHNH:{name:"RU_DEVO",locale:"ru-RU",currency:"RUB"},A19VAU5U5O7RUS:{name:"SG",locale:"en-SG",currency:"SGD"},A1DQ6JV7I20JSG:{name:"SG_DEVO",locale:"en-SG",
currency:"SGD"},A75P1MG8VMU51:{name:"PYOP_JP_PROD",locale:"ja-JP",currency:"JPY"},A31YDYE76E6TCP:{name:"PYOP_JP_PROD_SANDBOX",locale:"ja-JP",currency:"JPY"},A2EFPHRCZ60KI3:{name:"PYOP_JP_DEVO",locale:"ja-JP",currency:"JPY"},A1U1OSY46WLA42:{name:"PYOP_JP_DEVO_SANDBOX",locale:"ja-JP",currency:"JPY"},AAHKV2X7AFYLW:{name:"CN",locale:"zh-CN",currency:"CNY"}},Nd=function(a){function b(a,k,c){var d;(E(this,b),d=da(this,b),a)?(d.obfuscatedMarketplaceId=a,a=Md[a],d.defaultLocale=k||(a?a.locale:function(a,
b,h,l){var k=qd(jb(1&l?a.prototype:a),b,h);return 2&l&&"function"==typeof k?function(a){return k.apply(h,a)}:k}(b,"getDefaultLocale",d,3)([])),d.defaultCurrency=c||(a?a.currency:void 0)):(d.obfuscatedMarketplaceId=void 0,d.defaultLocale=void 0,d.defaultCurrency=void 0);return d}return ea(b,a),D(b,[{key:"getObfuscatedMarketplaceId",value:function(){return this.obfuscatedMarketplaceId}},{key:"getDefaultLocale",value:function(){return this.defaultLocale}},{key:"getDefaultCurrency",value:function(){return this.defaultCurrency}},
{key:"toString",value:function(){return"Marketplace[obfuscatedMarketplaceId\x3d".concat(this.getObfuscatedMarketplaceId(),",defaultLocale\x3d").concat(this.getDefaultLocale(),",defaultCurrency\x3d").concat(this.getDefaultCurrency(),"]")}}],[{key:"getObfuscatedMarketplaceIdMap",value:function(){for(var a=new Map,b=0,k=Object.keys(Md);b<k.length;b++){var c=k[b];a.set(Md[c].name,c)}return a}}])}(Ld),t={},Ea={};Object.defineProperty(Ea,"__esModule",{value:!0});Ea.ConfigType=void 0;var Fa=function(){return D(function d(a,
b){E(this,d);this._name=a;this._parent=b},[{key:"parent",get:function(){return this._parent}},{key:"toString",value:function(){return this._name}}])}();Ea.ConfigType=Fa;Fa.MARKETPLACEID_TO_CX_TUPLE=new Fa("MARKETPLACEID_TO_CX_TUPLE");Fa.PRICE_FORMAT=new Fa("PRICE_FORMAT");Fa.RETAIL_PRICE_FORMAT=new Fa("RETAIL_PRICE_FORMAT",Fa.PRICE_FORMAT);Fa.POINTS_FORMAT=new Fa("POINTS_FORMAT");Fa.CX_TUPLE_TO_I18N_DOMAIN=new Fa("CX_TUPLE_TO_I18N_DOMAIN");Fa.CX_TUPLE_TO_DEFAULT_PREFERENCES=new Fa("CX_TUPLE_TO_DEFAULT_PREFERENCES");
var Ua={};Object.defineProperty(Ua,"__esModule",{value:!0});Ua.ConfigName=void 0;var Oh=function(){return D(function d(a,b){E(this,d);this._name=a;this._returnType=b},[{key:"getReturnType",value:function(){return this._returnType}},{key:"toString",value:function(){return this._name}}])}();Ua.ConfigName=Oh;var Va={};Object.defineProperty(Va,"__esModule",{value:!0});Va.QueryOutput=void 0;var Ph=function(){return D(function d(a,b){E(this,d);this._name=a;this._returnType=b},[{key:"getReturnType",value:function(){return this._returnType}},
{key:"toString",value:function(){return this._name}}])}();Va.QueryOutput=Ph;var Lb={},Mb={},Qa={};Object.defineProperty(Qa,"__esModule",{value:!0});Qa.isNullOrUndefined=void 0;Qa.isNullOrUndefined=function(a){return null==a||null==a};Object.defineProperty(Mb,"__esModule",{value:!0});Mb.ConfigurationData=void 0;var Qh=function(){return D(function w(a){E(this,w);this._configs=Qa.isNullOrUndefined(a)?new Map:a},[{key:"getStringValue",value:function(a){a=this._configs.get(a);return Qa.isNullOrUndefined(a)?
null:String(a)}},{key:"getNumberValue",value:function(a){var b=this._configs.get(a);if(Qa.isNullOrUndefined(b))return null;if(b=Number(b),Number.isNaN(b))throw Error("The value of ".concat(a," cannot be converted to a number"));return b}},{key:"getBooleanValue",value:function(a){a=this._configs.get(a);return Qa.isNullOrUndefined(a)?null:"true"===String(a).toLowerCase()}},{key:"getEnumValue",value:function(a,b){var d=this._configs.get(b);if(Qa.isNullOrUndefined(d))return null;b=Object.keys(a).filter(function(b){return a[b]==
d});return 0<b.length?a[b[0]]:null}},{key:"isPrimitiveData",value:function(){return 1>=this._configs.size}},{key:"getPrimitiveDataConfigName",value:function(){return 1==this._configs.size?this._configs.keys().next().value:null}},{key:"isEmpty",value:function(){if(0===this._configs.size)return!0;var a,b=ba(this._configs.values());try{for(b.s();!(a=b.n()).done;)if(!Qa.isNullOrUndefined(a.value))return!1}catch(d){b.e(d)}finally{b.f()}return!0}},{key:"merge",value:function(a){var b;a=ba(a._configs.entries());
try{for(a.s();!(b=a.n()).done;){var d=b.value;this._configs.set(d[0],d[1])}}catch(y){a.e(y)}finally{a.f()}return this}},{key:"toString",value:function(){var a,b="{",d=0,c=ba(this._configs.entries());try{for(c.s();!(a=c.n()).done;){var g=a.value;b+="".concat(g[0],":").concat(g[1]);++d!=this._configs.size&&(b+=",")}}catch(L){c.e(L)}finally{c.f()}return b+"}"}}])}();Mb.ConfigurationData=Qh;Object.defineProperty(Lb,"__esModule",{value:!0});Lb.I18nConfiguration=void 0;var Od=function(){return D(function w(a){E(this,
w);this._configData=a;this._isPrimitiveDataResult=a.isPrimitiveData()},[{key:"configData",get:function(){return this._configData}},{key:"getStringValue",value:function(){return this.validatePrimitiveResult("getStringValue"),this._configData.getStringValue(this._configData.getPrimitiveDataConfigName())}},{key:"getNumberValue",value:function(){return this.validatePrimitiveResult("getNumberValue"),this._configData.getNumberValue(this._configData.getPrimitiveDataConfigName())}},{key:"getBooleanValue",
value:function(){return this.validatePrimitiveResult("getBooleanValue"),this._configData.getBooleanValue(this._configData.getPrimitiveDataConfigName())}},{key:"getEnumValue",value:function(a){return this.validatePrimitiveResult("getEnumValue"),this._configData.getEnumValue(a,this._configData.getPrimitiveDataConfigName())}},{key:"isEmpty",value:function(){return this._configData.isEmpty()}},{key:"validatePrimitiveResult",value:function(a){if(!this._isPrimitiveDataResult)throw Error("Method ".concat(a,
" cannot be called on a configuration of type object.\n                Call getConfigData().").concat(a,"(configName) instead."));}},{key:"toString",value:function(){return"I18nConfiguration: ".concat(this._configData)}}])}();Lb.I18nConfiguration=Od;Od.Builder=function(){return D(function k(){E(this,k);this._configs=new Map},[{key:"addConfiguration",value:function(a,b){return this._configs.set(a,b),this}},{key:"build",value:function(){return new Od(new Mb.ConfigurationData(this._configs))}}])}();
var ma={};Object.defineProperty(ma,"__esModule",{value:!0});ma.DataType=void 0;var Na=function(){return D(function w(a){E(this,w);this._isPrimitive=a},[{key:"isPrimitive",get:function(){return this._isPrimitive}}])}();ma.DataType=Na;Na.STRING=new Na(!0);Na.INT=new Na(!0);Na.BOOLEAN=new Na(!0);Na.CONFIGURATION_DATA=new Na(!1);Na.ENUM=new Na(!0);var Wa={};Object.defineProperty(Wa,"__esModule",{value:!0});Wa.I18nArgs=void 0;var Rh=function(){return D(function k(){E(this,k)},[{key:"toString",value:function(){var a,
b="".concat(this.constructor.name,":{"),d=0,c=ba(this.getArgsMap().entries());try{for(c.s();!(a=c.n()).done;){var g=a.value;b+="".concat(g[0],":").concat(g[1]);++d!=this.getArgsMap().size&&(b+=",")}}catch(L){c.e(L)}finally{c.f()}return b+"}"}}])}();Wa.I18nArgs=Rh;var hc={};Object.defineProperty(hc,"__esModule",{value:!0});hc.QueryResolver=void 0;var Sh=function(){return D(function k(){E(this,k);this._isInitialized=!1},[{key:"validate",value:function(a,b){var d=this.getTargetConfigType();if(a.getConfigType()!==
d||b.getConfigType()!==d)throw Error(this.getValidationErrorMessage());}},{key:"isInitialized",value:function(){return this._isInitialized}},{key:"setInitializedState",value:function(a){this._isInitialized=a}}])}();hc.QueryResolver=Sh;var ic={};Object.defineProperty(ic,"__esModule",{value:!0});ic.I18nConfigurationProvider=void 0;var Th=function(){return D(function k(){E(this,k)},[{key:"getConfiguration",value:function(a,b){this.validate(a,b);try{var d=this.resolveConfiguration(a,b)}catch(y){console.warn("Failed to resolve configuration query with name ".concat(a.toString(),
" and args ").concat(b.toString(),". Error: ").concat(y)),d=(new Lb.I18nConfiguration.Builder).build()}return d}},{key:"validate",value:function(a,b){if(a.getConfigType()!==b.getConfigType()&&(void 0===b.getConfigType().parent||a.getConfigType()!==b.getConfigType().parent))throw Error("Input query args type need to match the config name type."+"Found ".concat(a.getConfigType()," for config name, but ").concat(b.getConfigType()," for config args."));}}])}();ic.I18nConfigurationProvider=Th;var jc={};
Object.defineProperty(jc,"__esModule",{value:!0});jc.ConfigurationProviderManager=void 0;var Uh=function(){function a(b){E(this,a);this._provider=b}return D(a,null,[{key:"register",value:function(b){if(null==b)throw Error("Configuration provider cannot be undefined or null");void 0===this.instance?(this._instance=new a(b),console.log("Registered provider ".concat(b.constructor.name," for configuration resolution."))):console.warn("Provider ".concat(this.instance._provider.constructor.name," is already registered. ")+
"Ignoring register request for ".concat(b.constructor.name))}},{key:"getProvider",value:function(){if(void 0!==this.instance)return this.instance._provider;console.warn("No provider has been registered yet. Returning undefined.")}},{key:"hasProvider",value:function(){return null!=this.instance}},{key:"instance",get:function(){return this._instance}},{key:"resetInstance",value:function(){this._instance=void 0}}])}();jc.ConfigurationProviderManager=Uh;var kc={};Object.defineProperty(kc,"__esModule",
{value:!0});kc.MarketplaceIdToCxTuple=void 0;var Nb=function(a){function b(a,d){return E(this,b),da(this,b,[a,d])}return ea(b,a),D(b,[{key:"getConfigType",value:function(){return Ea.ConfigType.MARKETPLACEID_TO_CX_TUPLE}}])}(Ua.ConfigName);kc.MarketplaceIdToCxTuple=Nb;Nb.CX_ID=new Nb("cx_id",ma.DataType.STRING);Nb.CX_FAMILY=new Nb("cx_family",ma.DataType.STRING);var lc={};Object.defineProperty(lc,"__esModule",{value:!0});lc.MarketplaceIdToCxTupleArgs=void 0;var Pd=function(a){function b(a){var d;return E(this,
b),(d=da(this,b))._obfuscatedMarketplaceId=a,d}return ea(b,a),D(b,[{key:"obfuscatedMarketplaceId",get:function(){return this._obfuscatedMarketplaceId}},{key:"getConfigType",value:function(){return Ea.ConfigType.MARKETPLACEID_TO_CX_TUPLE}},{key:"getArgsMap",value:function(){return new Map([["obfuscated_marketplace_id",this._obfuscatedMarketplaceId]])}}])}(Wa.I18nArgs);lc.MarketplaceIdToCxTupleArgs=Pd;Pd.Builder=function(){return D(function k(){E(this,k)},[{key:"withObfuscatedMarketplaceId",value:function(a){return this.obfuscatedMarketplaceId=
a,this}},{key:"build",value:function(){return new Pd(this.obfuscatedMarketplaceId)}}])}();var mc={};Object.defineProperty(mc,"__esModule",{value:!0});mc.MarketplaceIdToCxTupleResult=void 0;var Ob=function(a){function b(){return E(this,b),da(this,b,arguments)}return ea(b,a),D(b)}(Va.QueryOutput);mc.MarketplaceIdToCxTupleResult=Ob;Ob.CX_ID=new Ob("cx_id",ma.DataType.STRING);Ob.CX_FAMILY=new Ob("cx_family",ma.DataType.STRING);var nc={};Object.defineProperty(nc,"__esModule",{value:!0});nc.PriceFormat=
void 0;var Xa=function(a){function b(a,d){return E(this,b),da(this,b,[a,d])}return ea(b,a),D(b,[{key:"getConfigType",value:function(){return Ea.ConfigType.PRICE_FORMAT}},{key:"getReturnType",value:function(){return this._returnType}}])}(Ua.ConfigName);nc.PriceFormat=Xa;Xa.CURRENCY_FORMAT=new Xa("currency_format",ma.DataType.CONFIGURATION_DATA);Xa.SYMBOL_PREFIX=new Xa("symbol_prefix",ma.DataType.STRING);Xa.CURRENCY_SYMBOL_POSITION=new Xa("currency_symbol_position",ma.DataType.ENUM);Xa.TRAILING_ZERO_DISPLAY=
new Xa("trailing_zero_display",ma.DataType.ENUM);var Pb={};Object.defineProperty(Pb,"__esModule",{value:!0});Pb.PriceFormatArgs=void 0;var Vh=function(a){function b(a,d,c,k,g,B){var h;return E(this,b),(h=da(this,b))._locale=a,h._currency=d,h._cxFamily=c,h._cxId=k,h._cxProgram=g,h._priceFormatType=B,h}return ea(b,a),D(b,[{key:"locale",get:function(){return this._locale}},{key:"currency",get:function(){return this._currency}},{key:"cxFamily",get:function(){return this._cxFamily}},{key:"cxId",get:function(){return this._cxId}},
{key:"cxProgram",get:function(){return this._cxProgram}},{key:"priceFormatType",get:function(){return this._priceFormatType}}])}(Wa.I18nArgs);Pb.PriceFormatArgs=Vh;var oc={},xb={};Object.defineProperty(xb,"__esModule",{value:!0});xb.RetailPriceFormatArgs=void 0;var Pf=function(a){function b(a,d,c,k,g,B){return E(this,b),da(this,b,[a,d,c,k,g,B])}return ea(b,a),D(b,[{key:"getConfigType",value:function(){return Ea.ConfigType.RETAIL_PRICE_FORMAT}},{key:"getArgsMap",value:function(){return new Map([["locale",
this._locale],["currency",this._currency],["cx_family",b.RETAIL_CX_FAMILY],["cx_id",this._cxId],["cx_program",this._cxProgram],["price_format_type",this._priceFormatType]])}}])}(Pb.PriceFormatArgs);xb.RetailPriceFormatArgs=Pf;Pf.RETAIL_CX_FAMILY="retail";Object.defineProperty(oc,"__esModule",{value:!0});oc.PriceFormatArgsBuilder=void 0;var Qf=function(){return D(function k(){E(this,k);this._cxProgram=k.EMPTY_CX_PROGRAM},[{key:"withLocale",value:function(a){return this._locale=a,this}},{key:"withCurrency",
value:function(a){return this._currency=a,this}},{key:"withCxId",value:function(a){return this._cxId=a,this}},{key:"withCxProgram",value:function(a){return this._cxProgram=a,this}},{key:"withCxFamily",value:function(a){return this._cxFamily=a,this}},{key:"withPriceFormatType",value:function(a){return this._priceFormatType=a,this}},{key:"fromPriceFormatArgs",value:function(a){return this.withCurrency(a.currency).withLocale(a.locale).withCxFamily(a.cxFamily).withCxId(a.cxId).withCxProgram(a.cxProgram).withPriceFormatType(a.priceFormatType)}},
{key:"build",value:function(){if(t.isNullOrUndefined(this._cxFamily)||xb.RetailPriceFormatArgs.RETAIL_CX_FAMILY===this._cxFamily)return new xb.RetailPriceFormatArgs(this._locale,this._currency,this._cxFamily,this._cxId,this._cxProgram,this._priceFormatType);throw Error("CX family ".concat(this._cxFamily," is currently not supported."));}}])}();oc.PriceFormatArgsBuilder=Qf;Qf.EMPTY_CX_PROGRAM="[]";var Rf={};!function(a){Object.defineProperty(a,"__esModule",{value:!0});a.PriceFormatType=void 0;(a=a.PriceFormatType||
(a.PriceFormatType={})).ISO="iso";a.PLURAL="plural";a.AMAZON_SYMBOL="amazonSymbol";a.COMPACT="compact";a.IN_SENTENCE="inSentence"}(Rf);var pc={};Object.defineProperty(pc,"__esModule",{value:!0});pc.PriceFormatResult=void 0;var Ja=function(a){function b(){return E(this,b),da(this,b,arguments)}return ea(b,a),D(b)}(Va.QueryOutput);pc.PriceFormatResult=Ja;Ja.SYMBOL=new Ja("symbol",ma.DataType.STRING);Ja.INSERT_SPACE_IN_PATTERN=new Ja("insert_space_in_pattern",ma.DataType.BOOLEAN);Ja.FORMAT_PATTERN=new Ja("format_pattern",
ma.DataType.STRING);Ja.SYMBOL_PREFIX=new Ja("symbol_prefix",ma.DataType.STRING);Ja.CURRENCY_SYMBOL_POSITION=new Ja("currency_symbol_position",ma.DataType.ENUM);Ja.TRAILING_ZERO_DISPLAY=new Ja("trailing_zero_display",ma.DataType.ENUM);var Sf={};!function(a){Object.defineProperty(a,"__esModule",{value:!0});a.TrailingZeroDisplay=void 0;(a=a.TrailingZeroDisplay||(a.TrailingZeroDisplay={})).AUTO="AUTO";a.HIDE_IF_WHOLE="HIDE_IF_WHOLE"}(Sf);var Tf={};!function(a){Object.defineProperty(a,"__esModule",{value:!0});
a.CurrencySymbolPosition=void 0;(a=a.CurrencySymbolPosition||(a.CurrencySymbolPosition={})).DEFAULT="default";a.START="start";a.END="end"}(Tf);var qc={};Object.defineProperty(qc,"__esModule",{value:!0});qc.PointsFormat=void 0;var Qd=function(a){function b(a,d){return E(this,b),da(this,b,[a,d])}return ea(b,a),D(b,[{key:"getConfigType",value:function(){return Ea.ConfigType.POINTS_FORMAT}}])}(Ua.ConfigName);qc.PointsFormat=Qd;Qd.PATTERN=new Qd("pattern",ma.DataType.STRING);var rc={};Object.defineProperty(rc,
"__esModule",{value:!0});rc.PointsFormatArgs=void 0;var Rd=function(a){function b(a,d,c){var k;return E(this,b),(k=da(this,b))._locale=a,k._programName=d,k._style=c,k}return ea(b,a),D(b,[{key:"getConfigType",value:function(){return Ea.ConfigType.POINTS_FORMAT}},{key:"getArgsMap",value:function(){return new Map([["locale",this._locale],["program_name",this._programName],["style",this._style]])}},{key:"locale",get:function(){return this._locale}},{key:"programName",get:function(){return this._programName}},
{key:"style",get:function(){return this._style}}])}(Wa.I18nArgs);rc.PointsFormatArgs=Rd;Rd.Builder=function(){return D(function k(){E(this,k)},[{key:"withLocale",value:function(a){return this.locale=a,this}},{key:"withProgramName",value:function(a){return this.programName=a,this}},{key:"withStyle",value:function(a){return this.style=a,this}},{key:"build",value:function(){return new Rd(this.locale,this.programName,this.style)}}])}();var sc={};Object.defineProperty(sc,"__esModule",{value:!0});sc.PointsFormatResult=
void 0;var Sd=function(a){function b(){return E(this,b),da(this,b,arguments)}return ea(b,a),D(b)}(Va.QueryOutput);sc.PointsFormatResult=Sd;Sd.PATTERN=new Sd("pattern",ma.DataType.STRING);var Uf={};!function(a){Object.defineProperty(a,"__esModule",{value:!0});a.PointsFormatStyle=void 0;(a=a.PointsFormatStyle||(a.PointsFormatStyle={})).DEFAULT="default";a.IMPLICIT="implicit"}(Uf);var tc={};Object.defineProperty(tc,"__esModule",{value:!0});tc.CXTupleToI18nDomain=void 0;var Td=function(a){function b(a,
d){return E(this,b),da(this,b,[a,d])}return ea(b,a),D(b,[{key:"getConfigType",value:function(){return Ea.ConfigType.CX_TUPLE_TO_I18N_DOMAIN}}])}(Ua.ConfigName);tc.CXTupleToI18nDomain=Td;Td.I18N_DOMAIN=new Td("i18n_domain",ma.DataType.STRING);var Vf,uc={};Object.defineProperty(uc,"__esModule",{value:!0});uc.CXTupleToI18nDomainArgs=void 0;var vc=function(a){function b(a,d,c){var k;return E(this,b),(k=da(this,b))._cxFamily=a,k._cxId=d,k._cxProgram=c,k}return ea(b,a),D(b,[{key:"cxFamily",get:function(){return this._cxFamily}},
{key:"cxId",get:function(){return this._cxId}},{key:"cxProgram",get:function(){return this._cxProgram}},{key:"getConfigType",value:function(){return Ea.ConfigType.CX_TUPLE_TO_I18N_DOMAIN}},{key:"getArgsMap",value:function(){return new Map([["cx_family",this._cxFamily],["cx_id",this._cxId],["cx_program",this._cxProgram]])}}])}(Wa.I18nArgs);uc.CXTupleToI18nDomainArgs=vc;vc.Builder=((Vf=function(){return D(function k(){E(this,k);this.cxProgram=vc.Builder.EMPTY_CX_PROGRAM},[{key:"withCxFamily",value:function(a){return this.cxFamily=
a,this}},{key:"withCxId",value:function(a){return this.cxId=a,this}},{key:"withCxProgram",value:function(a){return this.cxProgram=a,this}},{key:"build",value:function(){return new vc(this.cxFamily,this.cxId,this.cxProgram)}}])}()).EMPTY_CX_PROGRAM="[]",Vf);var wc={};Object.defineProperty(wc,"__esModule",{value:!0});wc.CXTupleToI18nDomainResult=void 0;var Ud=function(a){function b(){return E(this,b),da(this,b,arguments)}return ea(b,a),D(b)}(Va.QueryOutput);wc.CXTupleToI18nDomainResult=Ud;Ud.I18N_DOMAIN=
new Ud("i18n_domain",ma.DataType.STRING);var xc={};Object.defineProperty(xc,"__esModule",{value:!0});xc.CXTupleToDefaultPreferences=void 0;var Qb=function(a){function b(a,d){return E(this,b),da(this,b,[a,d])}return ea(b,a),D(b,[{key:"getConfigType",value:function(){return Ea.ConfigType.CX_TUPLE_TO_DEFAULT_PREFERENCES}}])}(Ua.ConfigName);xc.CXTupleToDefaultPreferences=Qb;Qb.DEFAULT_CURRENCY=new Qb("default_currency",ma.DataType.STRING);Qb.DEFAULT_LANGUAGE=new Qb("default_language",ma.DataType.STRING);
var yc={};Object.defineProperty(yc,"__esModule",{value:!0});yc.CXTupleToDefaultPreferencesArgs=void 0;var Vd=function(a){function b(a,d,c){var k;return E(this,b),(k=da(this,b))._cxFamily=a,k._cxId=d,k._cxProgram=c,k}return ea(b,a),D(b,[{key:"getConfigType",value:function(){return Ea.ConfigType.CX_TUPLE_TO_DEFAULT_PREFERENCES}},{key:"getArgsMap",value:function(){return new Map([["cx_family",this._cxFamily],["cx_id",this._cxId],["cx_program",this._cxProgram]])}},{key:"cxFamily",get:function(){return this._cxFamily}},
{key:"cxId",get:function(){return this._cxId}},{key:"cxProgram",get:function(){return this._cxProgram}}])}(Wa.I18nArgs);yc.CXTupleToDefaultPreferencesArgs=Vd;Vd.Builder=function(){return D(function k(){E(this,k)},[{key:"withCxFamily",value:function(a){return this.cxFamily=a,this}},{key:"withCxId",value:function(a){return this.cxId=a,this}},{key:"withCxProgram",value:function(a){return this.cxProgram=a,this}},{key:"build",value:function(){return new Vd(this.cxFamily,this.cxId,this.cxProgram)}}])}();
var zc={};Object.defineProperty(zc,"__esModule",{value:!0});zc.CXTupleToDefaultPreferencesResult=void 0;var Rb=function(a){function b(){return E(this,b),da(this,b,arguments)}return ea(b,a),D(b)}(Va.QueryOutput);zc.CXTupleToDefaultPreferencesResult=Rb;Rb.DEFAULT_CURRENCY=new Rb("default_currency",ma.DataType.STRING);Rb.DEFAULT_LANGUAGE=new Rb("default_language",ma.DataType.STRING);(function(a){Object.defineProperty(a,"__esModule",{value:!0});Object.defineProperty(a,"ConfigType",{enumerable:!0,get:function(){return Ea.ConfigType}});
Object.defineProperty(a,"ConfigName",{enumerable:!0,get:function(){return Ua.ConfigName}});Object.defineProperty(a,"QueryOutput",{enumerable:!0,get:function(){return Va.QueryOutput}});Object.defineProperty(a,"I18nConfiguration",{enumerable:!0,get:function(){return Lb.I18nConfiguration}});Object.defineProperty(a,"ConfigurationData",{enumerable:!0,get:function(){return Mb.ConfigurationData}});Object.defineProperty(a,"DataType",{enumerable:!0,get:function(){return ma.DataType}});Object.defineProperty(a,
"I18nArgs",{enumerable:!0,get:function(){return Wa.I18nArgs}});Object.defineProperty(a,"QueryResolver",{enumerable:!0,get:function(){return hc.QueryResolver}});Object.defineProperty(a,"I18nConfigurationProvider",{enumerable:!0,get:function(){return ic.I18nConfigurationProvider}});Object.defineProperty(a,"ConfigurationProviderManager",{enumerable:!0,get:function(){return jc.ConfigurationProviderManager}});Object.defineProperty(a,"isNullOrUndefined",{enumerable:!0,get:function(){return Qa.isNullOrUndefined}});
Object.defineProperty(a,"MarketplaceIdToCxTuple",{enumerable:!0,get:function(){return kc.MarketplaceIdToCxTuple}});Object.defineProperty(a,"MarketplaceIdToCxTupleArgs",{enumerable:!0,get:function(){return lc.MarketplaceIdToCxTupleArgs}});Object.defineProperty(a,"MarketplaceIdToCxTupleResult",{enumerable:!0,get:function(){return mc.MarketplaceIdToCxTupleResult}});Object.defineProperty(a,"PriceFormat",{enumerable:!0,get:function(){return nc.PriceFormat}});Object.defineProperty(a,"PriceFormatArgs",{enumerable:!0,
get:function(){return Pb.PriceFormatArgs}});Object.defineProperty(a,"PriceFormatArgsBuilder",{enumerable:!0,get:function(){return oc.PriceFormatArgsBuilder}});Object.defineProperty(a,"RetailPriceFormatArgs",{enumerable:!0,get:function(){return xb.RetailPriceFormatArgs}});Object.defineProperty(a,"PriceFormatType",{enumerable:!0,get:function(){return Rf.PriceFormatType}});Object.defineProperty(a,"PriceFormatResult",{enumerable:!0,get:function(){return pc.PriceFormatResult}});Object.defineProperty(a,
"TrailingZeroDisplay",{enumerable:!0,get:function(){return Sf.TrailingZeroDisplay}});Object.defineProperty(a,"CurrencySymbolPosition",{enumerable:!0,get:function(){return Tf.CurrencySymbolPosition}});Object.defineProperty(a,"PointsFormat",{enumerable:!0,get:function(){return qc.PointsFormat}});Object.defineProperty(a,"PointsFormatArgs",{enumerable:!0,get:function(){return rc.PointsFormatArgs}});Object.defineProperty(a,"PointsFormatResult",{enumerable:!0,get:function(){return sc.PointsFormatResult}});
Object.defineProperty(a,"PointsFormatStyle",{enumerable:!0,get:function(){return Uf.PointsFormatStyle}});Object.defineProperty(a,"CXTupleToI18nDomain",{enumerable:!0,get:function(){return tc.CXTupleToI18nDomain}});Object.defineProperty(a,"CXTupleToI18nDomainArgs",{enumerable:!0,get:function(){return uc.CXTupleToI18nDomainArgs}});Object.defineProperty(a,"CXTupleToI18nDomainResult",{enumerable:!0,get:function(){return wc.CXTupleToI18nDomainResult}});Object.defineProperty(a,"CXTupleToDefaultPreferences",
{enumerable:!0,get:function(){return xc.CXTupleToDefaultPreferences}});Object.defineProperty(a,"CXTupleToDefaultPreferencesArgs",{enumerable:!0,get:function(){return yc.CXTupleToDefaultPreferencesArgs}});Object.defineProperty(a,"CXTupleToDefaultPreferencesResult",{enumerable:!0,get:function(){return zc.CXTupleToDefaultPreferencesResult}})})(t);var Wd={},Xd={},Yd={},Zd={},$d={};Object.defineProperty($d,"__esModule",{value:!0});var Wf=function(){function a(){E(this,a)}return D(a,[{key:"getContent",
value:function(){return a.CX_TUPLE_TO_DEFAULT_PREFERENCES_MAPPING}}])}();$d.default=Wf;Wf.CX_TUPLE_TO_DEFAULT_PREFERENCES_MAPPING=new Map([["retail/amazon.ae|default_language","en-AE"],["retail/amazon.ae|default_currency","AED"],["retail/amazon.au|default_language","en-AU"],["retail/amazon.au|default_currency","AUD"],["retail/amazon.com.be|default_language","fr-BE"],["retail/amazon.com.be|default_currency","EUR"],["retail/amazon.com.br|default_language","pt-BR"],["retail/amazon.com.br|default_currency",
"BRL"],["retail/amazon.ca|default_language","en-CA"],["retail/amazon.ca|default_currency","CAD"],["retail/amazon.cl|default_language","es-CL"],["retail/amazon.cl|default_currency","CLP"],["retail/amazon.com.co|default_language","es-CO"],["retail/amazon.com.co|default_currency","COP"],["retail/amazon.cn|default_language","zh-CN"],["retail/amazon.cn|default_currency","CNY"],["retail/amazon.de|default_language","de-DE"],["retail/amazon.de|default_currency","EUR"],["retail/amazon.eg|default_language",
"ar-AE"],["retail/amazon.eg|default_currency","EGP"],["retail/amazon.es|default_language","es-ES"],["retail/amazon.es|default_currency","EUR"],["retail/amazon.fr|default_language","fr-FR"],["retail/amazon.fr|default_currency","EUR"],["retail/amazon.in|default_language","en-IN"],["retail/amazon.in|default_currency","INR"],["retail/amazon.it|default_language","it-IT"],["retail/amazon.it|default_currency","EUR"],["retail/amazon.co.jp|default_language","ja-JP"],["retail/amazon.co.jp|default_currency",
"JPY"],["retail/amazon.com.mx|default_language","es-MX"],["retail/amazon.com.mx|default_currency","MXN"],["retail/amazon.com.ng|default_language","en-NG"],["retail/amazon.com.ng|default_currency","NGN"],["retail/amazon.nl|default_language","nl-NL"],["retail/amazon.nl|default_currency","EUR"],["retail/amazon.pl|default_language","pl-PL"],["retail/amazon.pl|default_currency","PLN"],["retail/amazon.ru|default_language","ru-RU"],["retail/amazon.ru|default_currency","RUB"],["retail/amazon.sa|default_language",
"ar-AE"],["retail/amazon.sa|default_currency","SAR"],["retail/amazon.se|default_language","sv-SE"],["retail/amazon.se|default_currency","SEK"],["retail/amazon.sg|default_language","en-SG"],["retail/amazon.sg|default_currency","SGD"],["retail/amazon.com.tr|default_language","tr-TR"],["retail/amazon.com.tr|default_currency","TRY"],["retail/amazon.co.uk|default_language","en-GB"],["retail/amazon.co.uk|default_currency","GBP"],["retail/amazon.com|default_language","en-US"],["retail/amazon.com|default_currency",
"USD"],["retail/amazon.co.za|default_language","en-ZA"],["retail/amazon.co.za|default_currency","ZAR"],["pyop/apa.amazon.ca|default_language","en-CA"],["pyop/apa.amazon.ca|default_currency","CAD"],["pyop/apa.amazon.de|default_language","de-DE"],["pyop/apa.amazon.de|default_currency","EUR"],["pyop/apa.amazon.in|default_language","en-IN"],["pyop/apa.amazon.in|default_currency","INR"],["pyop/apa.amazon.co.jp|default_language","ja-JP"],["pyop/apa.amazon.co.jp|default_currency","JPY"],["pyop/apa.amazon.com|default_language",
"en-US"],["pyop/apa.amazon.com|default_currency","USD"],["pyop/apa.amazon.co.uk|default_language","en-GB"],["pyop/apa.amazon.co.uk|default_currency","GBP"]]);var Sb={};Object.defineProperty(Sb,"__esModule",{value:!0});var Xf=function(a){function b(){var a;return E(this,b),(a=da(this,b)).initialize(),a}return ea(b,a),D(b,[{key:"initialize",value:function(){if(!this.isInitialized())try{this._resourceConfigRetriever=this.createMapResourceConfigRetriever(),this.setInitializedState(!0)}catch(w){console.error("Failed to initialize query resolver ".concat(this.constructor.name))}return this.isInitialized()}}])}(t.QueryResolver);
Sb.default=Xf;Xf.MAP_ATTRIBUTE_KEY_SEPARATOR="|";var Yf=Ba&&Ba.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Zd,"__esModule",{value:!0});var Wh=Yf($d),Zf=Yf(Sb),ae=function(a){function b(){return E(this,b),da(this,b)}return ea(b,a),D(b,[{key:"resolve",value:function(a,b){return this.validate(a,b),this.doResolve(a,b)}},{key:"doResolve",value:function(a,b){var d=new t.I18nConfiguration.Builder;switch(a){case t.CXTupleToDefaultPreferences.DEFAULT_CURRENCY:a=
this.getResource(a,b);d.addConfiguration(t.CXTupleToDefaultPreferencesResult.DEFAULT_CURRENCY,a);break;case t.CXTupleToDefaultPreferences.DEFAULT_LANGUAGE:a=this.getResource(a,b);d.addConfiguration(t.CXTupleToDefaultPreferencesResult.DEFAULT_LANGUAGE,a);break;default:throw Error("Attribute name ".concat(a," is not defined for feature ").concat(a.getConfigType()));}return d.build()}},{key:"getResource",value:function(a,d){d=d.cxFamily+b.CX_TUPLE_SEPARATOR+d.cxId;return d+=Zf.default.MAP_ATTRIBUTE_KEY_SEPARATOR,
d+=a,this._resourceConfigRetriever.getContent().get(d)}},{key:"createMapResourceConfigRetriever",value:function(){return new Wh.default}},{key:"getTargetConfigType",value:function(){return b.CONFIG_TYPE}},{key:"getValidationErrorMessage",value:function(){return"CXTuple to default preferences configs can only be resolved for configType ".concat(b.CONFIG_TYPE)}}])}(Zf.default);Zd.default=ae;ae.CX_TUPLE_SEPARATOR="/";ae.CONFIG_TYPE=t.ConfigType.CX_TUPLE_TO_DEFAULT_PREFERENCES;var be={},ce={};Object.defineProperty(ce,
"__esModule",{value:!0});var $f=function(){function a(){E(this,a)}return D(a,[{key:"getContent",value:function(){return a.CX_TUPLE_TO_I18N_DOMAIN_MAPPINGS}}])}();ce.default=$f;$f.CX_TUPLE_TO_I18N_DOMAIN_MAPPINGS=new Map([["retail/amazon.ae|i18n_domain","retail-ae"],["retail/amazon.com.au|i18n_domain","retail-au"],["retail/amazon.com.be|i18n_domain","retail-be"],["retail/amazon.com.br|i18n_domain","retail-br"],["retail/amazon.ca|i18n_domain","retail-ca"],["retail/amazon.cl|i18n_domain","retail-cl"],
["retail/amazon.com.co|i18n_domain","retail-co"],["retail/amazon.cn|i18n_domain","retail-cn"],["retail/amazon.de|i18n_domain","retail-de"],["retail/amazon.eg|i18n_domain","retail-eg"],["retail/amazon.es|i18n_domain","retail-es"],["retail/amazon.fr|i18n_domain","retail-fr"],["retail/amazon.in|i18n_domain","retail-in"],["retail/amazon.it|i18n_domain","retail-it"],["retail/amazon.co.jp|i18n_domain","retail-jp"],["retail/amazon.com.mx|i18n_domain","retail-mx"],["retail/amazon.com.ng|i18n_domain","retail-ng"],
["retail/amazon.nl|i18n_domain","retail-nl"],["retail/amazon.pl|i18n_domain","retail-pl"],["retail/amazon.ru|i18n_domain","retail-ru"],["retail/amazon.sa|i18n_domain","retail-sa"],["retail/amazon.se|i18n_domain","retail-se"],["retail/amazon.sg|i18n_domain","retail-sg"],["retail/amazon.com.tr|i18n_domain","retail-tr"],["retail/amazon.co.uk|i18n_domain","retail-uk"],["retail/amazon.com|i18n_domain","retail-us"],["retail/amazon.co.za|i18n_domain","retail-za"]]);var ag=Ba&&Ba.__importDefault||function(a){return a&&
a.__esModule?a:{default:a}};Object.defineProperty(be,"__esModule",{value:!0});var Xh=ag(ce),bg=ag(Sb),de=function(a){function b(){return E(this,b),da(this,b)}return ea(b,a),D(b,[{key:"resolve",value:function(a,b){return this.validate(a,b),this.doResolve(a,b)}},{key:"doResolve",value:function(a,b){var d=new t.I18nConfiguration.Builder;if(a!==t.CXTupleToI18nDomain.I18N_DOMAIN)throw Error("Attribute name ".concat(a," is not defined for feature ").concat(a.getConfigType()));a=this.getResource(a,b);return d.addConfiguration(t.CXTupleToI18nDomainResult.I18N_DOMAIN,
a),d.build()}},{key:"getResource",value:function(a,d){d=d.cxFamily+b.CX_TUPLE_SEPARATOR+d.cxId;return d+=bg.default.MAP_ATTRIBUTE_KEY_SEPARATOR,d+=a,this._resourceConfigRetriever.getContent().get(d)}},{key:"createMapResourceConfigRetriever",value:function(){return new Xh.default}},{key:"getTargetConfigType",value:function(){return b.CONFIG_TYPE}},{key:"getValidationErrorMessage",value:function(){return"CXTuple to I18nDomain configs can only be resolved for configType ".concat(b.CONFIG_TYPE)}}])}(bg.default);
be.default=de;de.CX_TUPLE_SEPARATOR="/";de.CONFIG_TYPE=t.ConfigType.CX_TUPLE_TO_I18N_DOMAIN;var ee={},fe={};Object.defineProperty(fe,"__esModule",{value:!0});var cg=function(){function a(){E(this,a)}return D(a,[{key:"getContent",value:function(){return a.MARKETPLACE_TO_CXTUPLE_MAPPINGS}}])}();fe.default=cg;cg.MARKETPLACE_TO_CXTUPLE_MAPPINGS=new Map([["A2VIGQ35RCS4UG|cx_id","amazon.ae"],["A2VIGQ35RCS4UG|cx_family","retail"],["A34GYYCZVDBSIK|cx_id","amazon.ae"],["A34GYYCZVDBSIK|cx_family","retail"],
["A39IBJ37TRP1C6|cx_id","amazon.com.au"],["A39IBJ37TRP1C6|cx_family","retail"],["A1RNPCQ4K8U27I|cx_id","amazon.com.au"],["A1RNPCQ4K8U27I|cx_family","retail"],["AMEN7PMS3EDWL|cx_id","amazon.com.be"],["AMEN7PMS3EDWL|cx_family","retail"],["A1YFOMBPFBRY22|cx_id","amazon.com.be"],["A1YFOMBPFBRY22|cx_family","retail"],["A2Q3Y263D00KWC|cx_id","amazon.com.br"],["A2Q3Y263D00KWC|cx_family","retail"],["AZXD3QD5B39HD|cx_id","amazon.com.br"],["AZXD3QD5B39HD|cx_family","retail"],["A2EUQ1WTGCTBG2|cx_id","amazon.ca"],
["A2EUQ1WTGCTBG2|cx_family","retail"],["A2WDZJZ5TCRMLH|cx_id","amazon.cl"],["A2WDZJZ5TCRMLH|cx_family","retail"],["A2IDBVIE7EAGN4|cx_id","amazon.cl"],["A2IDBVIE7EAGN4|cx_family","retail"],["A1NOHO22DE3OHQ|cx_id","amazon.com.co"],["A1NOHO22DE3OHQ|cx_family","retail"],["AAHKV2X7AFYLW|cx_id","amazon.cn"],["AAHKV2X7AFYLW|cx_family","retail"],["A1PA6795UKMFR9|cx_id","amazon.de"],["A1PA6795UKMFR9|cx_family","retail"],["ARBP9OOSHTCHU|cx_id","amazon.eg"],["ARBP9OOSHTCHU|cx_family","retail"],["AUJPM9XGFJRC7|cx_id",
"amazon.eg"],["AUJPM9XGFJRC7|cx_family","retail"],["A1RKKUPIHCS9HS|cx_id","amazon.es"],["A1RKKUPIHCS9HS|cx_family","retail"],["AJZF8LZ1EJVJN|cx_id","amazon.es"],["AJZF8LZ1EJVJN|cx_family","retail"],["A13V1IB3VIYZZH|cx_id","amazon.fr"],["A13V1IB3VIYZZH|cx_family","retail"],["A21TJRUUN4KGV|cx_id","amazon.in"],["A21TJRUUN4KGV|cx_family","retail"],["A2XZLSVIQ0F4JT|cx_family","retail"],["A2XZLSVIQ0F4JT|cx_id","amazon.in"],["APJ6JRA9NG5V4|cx_id","amazon.it"],["APJ6JRA9NG5V4|cx_family","retail"],["A3HOBANJMCMD83|cx_id",
"amazon.it"],["A3HOBANJMCMD83|cx_family","retail"],["A1VC38T7YXB528|cx_id","amazon.co.jp"],["A1VC38T7YXB528|cx_family","retail"],["A1AM78C64UM0Y8|cx_id","amazon.com.mx"],["A1AM78C64UM0Y8|cx_family","retail"],["A3P3J5A7D2ZVXI|cx_id","amazon.com.mx"],["A3P3J5A7D2ZVXI|cx_family","retail"],["A3OCL2LJ6GDH9T|cx_id","amazon.com.ng"],["A3OCL2LJ6GDH9T|cx_family","retail"],["A3PJZM0QIA8QDU|cx_id","amazon.com.ng"],["A3PJZM0QIA8QDU|cx_family","retail"],["A1805IZSGTT6HS|cx_id","amazon.nl"],["A1805IZSGTT6HS|cx_family",
"retail"],["A1M3WC0SJ3A38T|cx_id","amazon.nl"],["A1M3WC0SJ3A38T|cx_family","retail"],["A1C3SOZRARQ6R3|cx_id","amazon.pl"],["A1C3SOZRARQ6R3|cx_family","retail"],["AKY4K4WKH21YQ|cx_id","amazon.pl"],["AKY4K4WKH21YQ|cx_family","retail"],["AD2EMQ3L3PG8S|cx_id","amazon.ru"],["AD2EMQ3L3PG8S|cx_family","retail"],["A38NPJYVS5YHNH|cx_id","amazon.ru"],["A38NPJYVS5YHNH|cx_family","retail"],["A17E79C6D8DWNP|cx_id","amazon.sa"],["A17E79C6D8DWNP|cx_family","retail"],["A1MQPSGJ6U9Q54|cx_id","amazon.sa"],["A1MQPSGJ6U9Q54|cx_family",
"retail"],["A2NODRKZP88ZB9|cx_id","amazon.se"],["A2NODRKZP88ZB9|cx_family","retail"],["AT614YYYNOC1S|cx_id","amazon.se"],["AT614YYYNOC1S|cx_family","retail"],["A19VAU5U5O7RUS|cx_id","amazon.sg"],["A19VAU5U5O7RUS|cx_family","retail"],["A1DQ6JV7I20JSG|cx_id","amazon.sg"],["A1DQ6JV7I20JSG|cx_family","retail"],["A33AVAJ2PDY3EV|cx_id","amazon.com.tr"],["A33AVAJ2PDY3EV|cx_family","retail"],["A3CQBQD3RGPJR8|cx_id","amazon.com.tr"],["A3CQBQD3RGPJR8|cx_family","retail"],["A1F83G8C2ARO7P|cx_id","amazon.co.uk"],
["A1F83G8C2ARO7P|cx_family","retail"],["ATVPDKIKX0DER|cx_id","amazon.com"],["ATVPDKIKX0DER|cx_family","retail"],["AE08WJ6YKNBMC|cx_id","amazon.co.za"],["AE08WJ6YKNBMC|cx_family","retail"],["A3TFQ1G9L8TQ5L|cx_id","amazon.co.za"],["A3TFQ1G9L8TQ5L|cx_family","retail"],["A2CE4MDCUAASDP|cx_id","apa.amazon.ca"],["A2CE4MDCUAASDP|cx_family","pyop"],["A2VJI655WT2I0B|cx_id","apa.amazon.ca"],["A2VJI655WT2I0B|cx_family","pyop"],["A1NWP2E4EKQP94|cx_id","apa.amazon.ca"],["A1NWP2E4EKQP94|cx_family","pyop"],["ASBG27DKM7EX6|cx_id",
"apa.amazon.ca"],["ASBG27DKM7EX6|cx_family","pyop"],["A53RDEWN57UU5|cx_id","apa.amazon.de"],["A53RDEWN57UU5|cx_family","pyop"],["A1G8446IYHA4MR|cx_id","apa.amazon.de"],["A1G8446IYHA4MR|cx_family","pyop"],["A34RX6LWLXD2KA|cx_id","apa.amazon.de"],["A34RX6LWLXD2KA|cx_family","pyop"],["A225AO9WA6YYOF|cx_id","apa.amazon.de"],["A225AO9WA6YYOF|cx_family","pyop"],["A3FDG49KKM823Y|cx_id","apa.amazon.in"],["A3FDG49KKM823Y|cx_family","pyop"],["A1IAUC0NN979H6|cx_id","apa.amazon.in"],["A1IAUC0NN979H6|cx_family",
"pyop"],["A18VPDB9UTK24D|cx_id","apa.amazon.in"],["A18VPDB9UTK24D|cx_family","pyop"],["A16Z2XWZJTFS70|cx_id","apa.amazon.in"],["A16Z2XWZJTFS70|cx_family","pyop"],["A75P1MG8VMU51|cx_id","apa.amazon.co.jp"],["A75P1MG8VMU51|cx_family","pyop"],["A31YDYE76E6TCP|cx_id","apa.amazon.co.jp"],["A31YDYE76E6TCP|cx_family","pyop"],["A2EFPHRCZ60KI3|cx_id","apa.amazon.co.jp"],["A2EFPHRCZ60KI3|cx_family","pyop"],["A1U1OSY46WLA42|cx_id","apa.amazon.co.jp"],["A1U1OSY46WLA42|cx_family","pyop"],["AGWSWK15IEJJ7|cx_id",
"apa.amazon.com"],["AGWSWK15IEJJ7|cx_family","pyop"],["A3BXB0YN3XH17H|cx_id","apa.amazon.com"],["A3BXB0YN3XH17H|cx_family","pyop"],["A35A4JO734ER04|cx_id","apa.amazon.com"],["A35A4JO734ER04|cx_family","pyop"],["A341L3VCFKNMIY|cx_id","apa.amazon.com"],["A341L3VCFKNMIY|cx_family","pyop"],["AZAJMM36N6WQL|cx_id","apa.amazon.co.uk"],["AZAJMM36N6WQL|cx_family","pyop"],["A3M3RRFO9XDT2G|cx_id","apa.amazon.co.uk"],["A3M3RRFO9XDT2G|cx_family","pyop"],["A2UWQKHEFGNQY3|cx_id","apa.amazon.co.uk"],["A2UWQKHEFGNQY3|cx_family",
"pyop"],["A2V84NPDZD3ZEH|cx_id","apa.amazon.co.uk"],["A2V84NPDZD3ZEH|cx_family","pyop"]]);var dg=Ba&&Ba.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(ee,"__esModule",{value:!0});var Yh=dg(fe),eg=dg(Sb),fg=function(a){function b(){return E(this,b),da(this,b)}return ea(b,a),D(b,[{key:"resolve",value:function(a,b){return this.validate(a,b),this.doResolve(a,b)}},{key:"doResolve",value:function(a,b){var d=new t.I18nConfiguration.Builder;switch(a){case t.MarketplaceIdToCxTuple.CX_ID:a=
this.getResource(a,b);d.addConfiguration(t.MarketplaceIdToCxTupleResult.CX_ID,a);break;case t.MarketplaceIdToCxTuple.CX_FAMILY:a=this.getResource(a,b);d.addConfiguration(t.MarketplaceIdToCxTupleResult.CX_FAMILY,a);break;default:throw Error("Attribute name ".concat(a," is not defined for feature ").concat(a.getConfigType()));}return d.build()}},{key:"getResource",value:function(a,b){b=b.obfuscatedMarketplaceId;return b+=eg.default.MAP_ATTRIBUTE_KEY_SEPARATOR,b+=a,this._resourceConfigRetriever.getContent().get(b)}},
{key:"createMapResourceConfigRetriever",value:function(){return new Yh.default}},{key:"getTargetConfigType",value:function(){return b.CONFIG_TYPE}},{key:"getValidationErrorMessage",value:function(){return"Marketplace to CXTuple configs can only be resolved for configType ".concat(b.CONFIG_TYPE)}}])}(eg.default);ee.default=fg;fg.CONFIG_TYPE=t.ConfigType.MARKETPLACEID_TO_CX_TUPLE;var ge={},he={},Ac={},Bc={};Object.defineProperty(Bc,"__esModule",{value:!0});Bc.DEFAULT_PRICE_FORMAT_OVERRIDES=void 0;Bc.DEFAULT_PRICE_FORMAT_OVERRIDES=
{symbolPosition:{},customSymbolData:{"sek_amazon.se":{customSymbol:"kr",insertSpaceInPattern:!1},"pln_amazon.pl":{customSymbol:"zł",insertSpaceInPattern:!1},sgd:{customSymbol:"S$",insertSpaceInPattern:!1},"aed_amazon.ae":{customSymbol:"AED",insertSpaceInPattern:!0},"sar_amazon.sa":{customSymbol:"SAR",insertSpaceInPattern:!0},"egp_amazon.eg":{customSymbol:"EGP",insertSpaceInPattern:!0},"try_amazon.com.tr":{customSymbol:"TL",insertSpaceInPattern:!0}},trailingZeroDisplayOverrides:{cop:t.TrailingZeroDisplay.HIDE_IF_WHOLE,
ngn:t.TrailingZeroDisplay.HIDE_IF_WHOLE}};var Cc={};Object.defineProperty(Cc,"__esModule",{value:!0});Cc.AR_PRICE_FORMAT_OVERRIDES=void 0;Cc.AR_PRICE_FORMAT_OVERRIDES={symbolPosition:{symbol_position:t.CurrencySymbolPosition.END},customSymbolData:{"aed_amazon.ae":{customSymbol:"درهم",insertSpaceInPattern:!0},"egp_amazon.eg":{customSymbol:"جنيه",insertSpaceInPattern:!0},"sar_amazon.sa":{customSymbol:"ريال",insertSpaceInPattern:!0},"usd_amazon.com":{customSymbol:"؜US$",insertSpaceInPattern:!1}},symbolPrefix:"؜"};
var Dc={};Object.defineProperty(Dc,"__esModule",{value:!0});Dc.BN_PRICE_FORMAT_OVERRIDES=void 0;Dc.BN_PRICE_FORMAT_OVERRIDES={symbolPosition:{symbol_position:t.CurrencySymbolPosition.START},customSymbolData:{}};var Ec={};Object.defineProperty(Ec,"__esModule",{value:!0});Ec.DA_PRICE_FORMAT_OVERRIDES=void 0;Ec.DA_PRICE_FORMAT_OVERRIDES={symbolPosition:{},customSymbolData:{"sek_amazon.se":{customSymbol:"Skr",insertSpaceInPattern:!1}}};var Fc={};Object.defineProperty(Fc,"__esModule",{value:!0});Fc.ET_PRICE_FORMAT_OVERRIDES=
void 0;Fc.ET_PRICE_FORMAT_OVERRIDES={symbolPosition:{},customSymbolData:{"sek_amazon.se":{customSymbol:"Skr",insertSpaceInPattern:!1}}};var Gc={};Object.defineProperty(Gc,"__esModule",{value:!0});Gc.EN_XD_PRICE_FORMAT_OVERRIDES=void 0;Gc.EN_XD_PRICE_FORMAT_OVERRIDES={symbolPosition:{},customSymbolData:{}};var Hc={};Object.defineProperty(Hc,"__esModule",{value:!0});Hc.EN_PHNX_XD_UNIFON_PRICE_FORMAT_OVERRIDES=void 0;Hc.EN_PHNX_XD_UNIFON_PRICE_FORMAT_OVERRIDES={symbolPosition:{},customSymbolData:{}};
var Ic={};Object.defineProperty(Ic,"__esModule",{value:!0});Ic.ES_PRICE_FORMAT_OVERRIDES=void 0;Ic.ES_PRICE_FORMAT_OVERRIDES={symbolPosition:{},customSymbolData:{"usd_amazon.com_compact":{customSymbol:"$",insertSpaceInPattern:!1},"usd_amazon.com":{customSymbol:"US$",insertSpaceInPattern:!1}}};var Jc={};Object.defineProperty(Jc,"__esModule",{value:!0});Jc.FR_CA_PRICE_FORMAT_OVERRIDES=void 0;Jc.FR_CA_PRICE_FORMAT_OVERRIDES={symbolPosition:{},customSymbolData:{"cad_amazon.ca":{customSymbol:"$",insertSpaceInPattern:!1}}};
var Kc={};Object.defineProperty(Kc,"__esModule",{value:!0});Kc.FR_XD_PRICE_FORMAT_OVERRIDES=void 0;Kc.FR_XD_PRICE_FORMAT_OVERRIDES={symbolPosition:{symbol_position:t.CurrencySymbolPosition.END},customSymbolData:{}};var Lc={};Object.defineProperty(Lc,"__esModule",{value:!0});Lc.FR_XD_UNIFON_PRICE_FORMAT_OVERRIDES=void 0;Lc.FR_XD_UNIFON_PRICE_FORMAT_OVERRIDES={symbolPosition:{},customSymbolData:{}};var Mc={};Object.defineProperty(Mc,"__esModule",{value:!0});Mc.FR_PHNX_XD_UNIFON_PRICE_FORMAT_OVERRIDES=
void 0;Mc.FR_PHNX_XD_UNIFON_PRICE_FORMAT_OVERRIDES={symbolPosition:{symbol_position:t.CurrencySymbolPosition.START},customSymbolData:{}};var Nc={};Object.defineProperty(Nc,"__esModule",{value:!0});Nc.HE_PRICE_FORMAT_OVERRIDES=void 0;Nc.HE_PRICE_FORMAT_OVERRIDES={symbolPosition:{},customSymbolData:{},symbolPrefix:"‏"};var Oc={};Object.defineProperty(Oc,"__esModule",{value:!0});Oc.IS_PRICE_FORMAT_OVERRIDES=void 0;Oc.IS_PRICE_FORMAT_OVERRIDES={symbolPosition:{},customSymbolData:{"sek_amazon.se":{customSymbol:"Skr",
insertSpaceInPattern:!1}}};var Pc={};Object.defineProperty(Pc,"__esModule",{value:!0});Pc.JA_PRICE_FORMAT_OVERRIDES=void 0;Pc.JA_PRICE_FORMAT_OVERRIDES={symbolPosition:{jpy_insentence:t.CurrencySymbolPosition.END},customSymbolData:{jpy_insentence:{customSymbol:"円",insertSpaceInPattern:!1},"jpy_amazon.co.jp_compact":{customSymbol:"¥",insertSpaceInPattern:!1}}};var Qc={};Object.defineProperty(Qc,"__esModule",{value:!0});Qc.NB_PRICE_FORMAT_OVERRIDES=void 0;Qc.NB_PRICE_FORMAT_OVERRIDES={symbolPosition:{},
customSymbolData:{"sek_amazon.se":{customSymbol:"Skr",insertSpaceInPattern:!1}}};var Rc={};Object.defineProperty(Rc,"__esModule",{value:!0});Rc.NN_PRICE_FORMAT_OVERRIDES=void 0;Rc.NN_PRICE_FORMAT_OVERRIDES={symbolPosition:{},customSymbolData:{"sek_amazon.se":{customSymbol:"Skr",insertSpaceInPattern:!1}}};var Sc={};Object.defineProperty(Sc,"__esModule",{value:!0});Sc.NO_PRICE_FORMAT_OVERRIDES=void 0;Sc.NO_PRICE_FORMAT_OVERRIDES={symbolPosition:{},customSymbolData:{"sek_amazon.se":{customSymbol:"Skr",
insertSpaceInPattern:!1}}};var Tc={};Object.defineProperty(Tc,"__esModule",{value:!0});Tc.TR_PRICE_FORMAT_OVERRIDES=void 0;Tc.TR_PRICE_FORMAT_OVERRIDES={symbolPosition:{symbol_position:t.CurrencySymbolPosition.END},customSymbolData:{}};var Uc={};Object.defineProperty(Uc,"__esModule",{value:!0});Uc.ZH_PRICE_FORMAT_OVERRIDES=void 0;Uc.ZH_PRICE_FORMAT_OVERRIDES={symbolPosition:{jpy_insentence:t.CurrencySymbolPosition.END,cny_insentence:t.CurrencySymbolPosition.END},customSymbolData:{cny_insentence:{customSymbol:"元",
insertSpaceInPattern:!1},jpy_insentence:{customSymbol:"日元",insertSpaceInPattern:!1}}};var Vc={};Object.defineProperty(Vc,"__esModule",{value:!0});Vc.HI_XD_PRICE_FORMAT_OVERRIDES=void 0;Vc.HI_XD_PRICE_FORMAT_OVERRIDES={symbolPosition:{},customSymbolData:{},trailingZeroDisplayOverrides:{"inr_amazon.in_insentence":t.TrailingZeroDisplay.HIDE_IF_WHOLE,"inr_amazon.in_amazonsymbol":t.TrailingZeroDisplay.HIDE_IF_WHOLE}};var Zh=function(a){if(a.__esModule)return a;var b=Object.defineProperty({},"__esModule",
{value:!0});return Object.keys(a).forEach(function(c){var d=Object.getOwnPropertyDescriptor(a,c);Object.defineProperty(b,c,d.get?d:{enumerable:!0,get:function(){return a[c]}})}),b}(Mh);Object.defineProperty(Ac,"__esModule",{value:!0});Ac.CustomSymbolOverrides=void 0;var gg=/-/g,hg=Fb({ar:Cc.AR_PRICE_FORMAT_OVERRIDES,bn:Dc.BN_PRICE_FORMAT_OVERRIDES,da:Ec.DA_PRICE_FORMAT_OVERRIDES,et:Fc.ET_PRICE_FORMAT_OVERRIDES,es:Ic.ES_PRICE_FORMAT_OVERRIDES,fr_ca:Jc.FR_CA_PRICE_FORMAT_OVERRIDES,he:Nc.HE_PRICE_FORMAT_OVERRIDES,
is:Oc.IS_PRICE_FORMAT_OVERRIDES,ja:Pc.JA_PRICE_FORMAT_OVERRIDES,nb:Qc.NB_PRICE_FORMAT_OVERRIDES,nn:Rc.NN_PRICE_FORMAT_OVERRIDES,no:Sc.NO_PRICE_FORMAT_OVERRIDES,tr:Tc.TR_PRICE_FORMAT_OVERRIDES,zh:Uc.ZH_PRICE_FORMAT_OVERRIDES,en_xd:Gc.EN_XD_PRICE_FORMAT_OVERRIDES,en_phnx_xd_unifon:Hc.EN_PHNX_XD_UNIFON_PRICE_FORMAT_OVERRIDES,fr_xd:Kc.FR_XD_PRICE_FORMAT_OVERRIDES,fr_xd_unifon:Lc.FR_XD_UNIFON_PRICE_FORMAT_OVERRIDES,fr_phnx_xd_unifon:Mc.FR_PHNX_XD_UNIFON_PRICE_FORMAT_OVERRIDES,hi_xd:Vc.HI_XD_PRICE_FORMAT_OVERRIDES},
"default",Bc.DEFAULT_PRICE_FORMAT_OVERRIDES),$h=function(){return D(function w(a){E(this,w);this.overrides=[];this.intlLocale=Zh.LocaleUtil.getCanonicalLocale(new Intl.Locale(a));a=[];for(var b=this.intlLocale.baseName,c=(b=b.replace(gg,"_")).lastIndexOf("_");0<c;)a.push(b.toLocaleLowerCase("und")),c=(b=b.substring(0,c)).lastIndexOf("_");if(this.intlLocale.script)for(c=(b=(b=(new Intl.Locale(this.intlLocale.baseName.replace("-"+this.intlLocale.script,""))).baseName).replace(gg,"_")).lastIndexOf("_");0<
c;)a.push(b.toLocaleLowerCase("und")),c=(b=b.substring(0,c)).lastIndexOf("_");a.push(b.toLocaleLowerCase("und"));for(b=0;b<a.length;b++)(c=hg[a[b]])&&this.overrides.push(c);this.overrides.push(hg["default"])},[{key:"getCustomSymbolData",value:function(a){var b;a=this.getResourceFallbackKeys(a);var c=ba(this.overrides);try{for(c.s();!(b=c.n()).done;){var k=this.getResourceValue(b.value.customSymbolData,a);if(k)return k}}catch(ca){c.e(ca)}finally{c.f()}return null}},{key:"getResourceValue",value:function(a,
b){var c;b=ba(b);try{for(b.s();!(c=b.n()).done;){var k=c.value;if(this.containsKey(k,a))return a[k]}}catch(ca){b.e(ca)}finally{b.f()}return null}},{key:"getResourceFallbackKeys",value:function(a){var b=[];if(!a.currencyCode)return[];var c=a.typeName;c&&(c=c.toLowerCase());var k=a.currencyCode.toLowerCase();a=a.cxId;return a&&(a=a.toLowerCase(),b.push(ac(k,a,c),ac(k,a))),b.push(ac(k,c),ac(k)),b}},{key:"getSymbolPrefix",value:function(){var a,b=ba(this.overrides);try{for(b.s();!(a=b.n()).done;){var c=
a.value;if(this.containsKey("symbolPrefix",c))return c.symbolPrefix}}catch(y){b.e(y)}finally{b.f()}return null}},{key:"getSymbolPositionOverride",value:function(a){var b=[];a&&b.push.apply(b,ab(this.getResourceFallbackKeys(a)));b.push("symbol_position");var c;a=ba(this.overrides);try{for(a.s();!(c=a.n()).done;){var k=this.getResourceValue(c.value.symbolPosition,b);if(k)return k}}catch(ca){a.e(ca)}finally{a.f()}return t.CurrencySymbolPosition.DEFAULT}},{key:"getTrailingZeroDisplay",value:function(a){var b;
a=this.getResourceFallbackKeys(a);var c=ba(this.overrides);try{for(c.s();!(b=c.n()).done;){var k=b.value;if(k.trailingZeroDisplayOverrides){var g=this.getResourceValue(k.trailingZeroDisplayOverrides,a);if(g)return g}}}catch(L){c.e(L)}finally{c.f()}return null}},{key:"containsKey",value:function(a,b){return!!b&&b.hasOwnProperty(a)}}])}();Ac.CustomSymbolOverrides=$h;Object.defineProperty(he,"__esModule",{value:!0});var ai=function(){return D(function w(a){E(this,w);this._locale=a},[{key:"getContent",
value:function(){return new Ac.CustomSymbolOverrides(this._locale)}}])}();he.default=ai;var ie={};Object.defineProperty(ie,"__esModule",{value:!0});var bi=function(a){function b(a){var c;return E(this,b),(c=da(this,b))._locale=a,c.initialize(),c}return ea(b,a),D(b,[{key:"initialize",value:function(){if(!this.isInitialized())try{this._resourceConfigRetriever=this.createResourceConfigRetriever(),this.setInitializedState(!0)}catch(w){console.error("Failed to initialize query resolver ".concat(this.constructor.name))}return this.isInitialized()}}])}(t.QueryResolver);
ie.default=bi;var ig=Ba&&Ba.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(ge,"__esModule",{value:!0});var ci=ig(he),je=function(a){function b(){return E(this,b),da(this,b,arguments)}return ea(b,a),D(b,[{key:"resolve",value:function(a,b){return this.validate(a,b),this.doResolve(a,b)}},{key:"doResolve",value:function(a,b){var c=new t.I18nConfiguration.Builder,d=this._resourceConfigRetriever.getContent();b={currencyCode:b.currency,typeName:b.priceFormatType,
cxId:b.cxId};switch(a){case t.PriceFormat.CURRENCY_FORMAT:a=d.getCustomSymbolData(b);(0,t.isNullOrUndefined)(a)||(c.addConfiguration(t.PriceFormatResult.SYMBOL,a.customSymbol),c.addConfiguration(t.PriceFormatResult.INSERT_SPACE_IN_PATTERN,a.insertSpaceInPattern),c.addConfiguration(t.PriceFormatResult.FORMAT_PATTERN,a.formatPattern));break;case t.PriceFormat.CURRENCY_SYMBOL_POSITION:c.addConfiguration(t.PriceFormatResult.CURRENCY_SYMBOL_POSITION,d.getSymbolPositionOverride(b)||t.CurrencySymbolPosition.DEFAULT);
break;case t.PriceFormat.SYMBOL_PREFIX:c.addConfiguration(t.PriceFormatResult.SYMBOL_PREFIX,d.getSymbolPrefix());break;case t.PriceFormat.TRAILING_ZERO_DISPLAY:c.addConfiguration(t.PriceFormatResult.TRAILING_ZERO_DISPLAY,d.getTrailingZeroDisplay(b)||t.TrailingZeroDisplay.AUTO);break;default:throw Error("Attribute name ".concat(a," is not defined for feature ").concat(a.getConfigType()));}return c.build()}},{key:"validate",value:function(a,c){if(a.getConfigType()!==this.getTargetConfigType()||c.getConfigType()!==
b.SPECIFIC_CONFIG_TYPE)throw Error(this.getValidationErrorMessage());}},{key:"createResourceConfigRetriever",value:function(){return new ci.default(this._locale)}},{key:"getTargetConfigType",value:function(){return b.CONFIG_TYPE}},{key:"getValidationErrorMessage",value:function(){return"Retail Price Format configs can only be resolved for"+"configType ".concat(b.CONFIG_TYPE," and args type ").concat(b.SPECIFIC_CONFIG_TYPE)}}],[{key:"create",value:function(a){if(a instanceof t.PriceFormatArgs)return a=
a.locale,new b((0,t.isNullOrUndefined)(a)?"und":a);throw Error("Cannot create PriceFormatResourceBundleQueryResolver using args of type ".concat(ra(a),".")+"Use RetailPriceFormatArgs to query Price Format data.");}}])}(ig(ie).default);ge.default=je;je.CONFIG_TYPE=t.ConfigType.PRICE_FORMAT;je.SPECIFIC_CONFIG_TYPE=t.ConfigType.RETAIL_PRICE_FORMAT;var Wc=Ba&&Ba.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Yd,"__esModule",{value:!0});var di=Wc(Zd),ei=Wc(be),
fi=Wc(ee),gi=Wc(ge),hi=function(){return D(function k(){E(this,k)},null,[{key:"getResolver",value:function(a){switch(a.getConfigType()){case t.ConfigType.RETAIL_PRICE_FORMAT:a=gi.default.create(a);break;case t.ConfigType.MARKETPLACEID_TO_CX_TUPLE:a=new fi.default;break;case t.ConfigType.CX_TUPLE_TO_I18N_DOMAIN:a=new ei.default;break;case t.ConfigType.CX_TUPLE_TO_DEFAULT_PREFERENCES:a=new di.default;break;default:throw Error("No resolver has been registered for config type ".concat(a.getConfigType()));
}return a}}])}();Yd.default=hi;var ii=Ba&&Ba.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Xd,"__esModule",{value:!0});var ji=ii(Yd),ki=function(a){function b(){return E(this,b),da(this,b,arguments)}return ea(b,a),D(b,[{key:"resolveConfiguration",value:function(a,b){return ji.default.getResolver(b).resolve(a,b)}}])}(t.I18nConfigurationProvider);Xd.default=ki;var li=Ba&&Ba.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Wd,
"__esModule",{value:!0});var jg=Wd.ResourceBundleI18nConfigurationProvider=void 0,mi=li(Xd);jg=Wd.ResourceBundleI18nConfigurationProvider=mi.default;var kg,ni=function(){return D(function w(a){E(this,w);this._configProvider=a},[{key:"resolve",value:function(a){if(t.isNullOrUndefined(a)||t.isNullOrUndefined(a.getObfuscatedMarketplaceId()))return vb.UNKNOWN;var b=(new t.MarketplaceIdToCxTupleArgs.Builder).withObfuscatedMarketplaceId(a.getObfuscatedMarketplaceId()).build();a=this._configProvider.getConfiguration(t.MarketplaceIdToCxTuple.CX_FAMILY,
b).getStringValue();b=this._configProvider.getConfiguration(t.MarketplaceIdToCxTuple.CX_ID,b).getStringValue();return t.isNullOrUndefined(a)||t.isNullOrUndefined(b)?vb.UNKNOWN:vb.of(a,b)}}])}(),oi=function(){return D(function w(a){E(this,w);this._configProvider=a},[{key:"resolveDefaultCurrency",value:function(a){a=(new t.CXTupleToDefaultPreferencesArgs.Builder).withCxFamily(a.cxFamily).withCxId(a.cxFamily).build();return this._configProvider.getConfiguration(t.CXTupleToDefaultPreferences.DEFAULT_CURRENCY,
a).getStringValue()||""}},{key:"resolveDefaultLanguage",value:function(a){a=(new t.CXTupleToDefaultPreferencesArgs.Builder).withCxFamily(a.cxFamily).withCxId(a.cxFamily).build();return this._configProvider.getConfiguration(t.CXTupleToDefaultPreferences.DEFAULT_LANGUAGE,a).getStringValue()||""}}])}(),ah=/[‎‏‪-‮⁦-⁩؜]+/,pi="undefined"!=typeof process&&process.env.I18N_PRICE_FORMAT_NUMBER_FORMAT_CACHE_SIZE?parseInt(process.env.I18N_PRICE_FORMAT_NUMBER_FORMAT_CACHE_SIZE,10):1E3,qi=new Set(["retail"]),
ri=new Map([["end",t.CurrencySymbolPosition.END],["start",t.CurrencySymbolPosition.START],["default",t.CurrencySymbolPosition.DEFAULT]]),lg=new Map([["HIDE_IF_WHOLE",t.TrailingZeroDisplay.HIDE_IF_WHOLE],["AUTO",t.TrailingZeroDisplay.AUTO]]),Xc=new Map([["inSentence",t.PriceFormatType.IN_SENTENCE],["amazonSymbol",t.PriceFormatType.AMAZON_SYMBOL],["iso",t.PriceFormatType.ISO],["compact",t.PriceFormatType.COMPACT],["plural",t.PriceFormatType.PLURAL]]),Yc=function(){return D(function L(a,b,c,g,m){E(this,
L);this.numberFormatCache=new Df({maxSize:pi});this.type=b;this.trailingZeroDisplay=m;this.localizationContext=g;this.configurationProvider=this.resolveConfigProvider();g=new ni(this.configurationProvider);m=new oi(this.configurationProvider);this.cxTuple=this.localizationContext.getAttribute(pa.CX_TUPLE_KEY)||g.resolve(c);this.locale=Zb.getCanonicalLocaleString(this.resolveLocale(a,this.cxTuple,c,m));this.marketplaceDefaultCurrencyCode=this.resolveDefaultCurrency(this.cxTuple,c,m);a=(new t.PriceFormatArgsBuilder).withLocale(this.locale).withPriceFormatType(Ib(b,
Xc)).build();a=this.getConfigurationDataWithArgs(a,[t.PriceFormat.SYMBOL_PREFIX,t.PriceFormat.CURRENCY_SYMBOL_POSITION]);this.symbolPosition=this.getCurrencySymbolPositionFromConfig(a);this.symbolPrefix=a.getStringValue(t.PriceFormatResult.SYMBOL_PREFIX)||""},[{key:"format",value:function(a){return Ne(this.getNumberFormatParts(a))}},{key:"formatToParts",value:function(a){var b=this.getNumberFormatParts(a);var c=this.type;c=yd(b,"fraction")&&"compact"!==c?lb(b)?yd(b,"decimal")?3:4:yd(b,"decimal")?
0:1:lb(b)?5:2;var k=cc(b,"integer"),g=cc(b,"currency"),L=cc(b,"decimal"),B=cc(b,"fraction");if(!k||!g)throw Error("Currency symbol or integer value are not present");c={fieldOrder:c,integerValue:k,currencySymbol:g,decimalSeparator:L,fractionalValue:B};return{amount:a.amount,currency:a.currency,displayString:Ne(b),displayFields:c}}},{key:"getConfigurationData",value:function(a,b){if(t.isNullOrUndefined(a))throw Error("The currency code must not be null or undefined");var c=new t.ConfigurationData;
if(this.checkCachedConfig(a,b,c),0==b.length)return c;var k=this.buildQueryArgs(a);k=this.getConfigurationDataWithArgs(k,b);return this.cacheConfig(a,b,k),k.merge(c),k}},{key:"resolveSymbolPositionOverride",value:function(a){a?a=this.getConfigurationData(a,[t.PriceFormat.CURRENCY_SYMBOL_POSITION]):(a=(new t.PriceFormatArgsBuilder).withLocale(this.locale).withPriceFormatType(Ib(this.type,Xc)).build(),a=this.getConfigurationDataWithArgs(a,[t.PriceFormat.CURRENCY_SYMBOL_POSITION]));return this.getCurrencySymbolPositionFromConfig(a)}},
{key:"resolveTrailingZeroDisplay",value:function(a){return void 0!==this.trailingZeroDisplay?this.trailingZeroDisplay:Me(this.getConfigurationData(a,[t.PriceFormat.TRAILING_ZERO_DISPLAY]).getEnumValue(t.TrailingZeroDisplay,t.PriceFormatResult.TRAILING_ZERO_DISPLAY),lg)||"AUTO"}},{key:"resolveConfigProvider",value:function(){return t.ConfigurationProviderManager.hasProvider()||t.ConfigurationProviderManager.register(new jg),t.ConfigurationProviderManager.getProvider()}},{key:"resolveLocale",value:function(a,
b,c,g){if(!t.isNullOrUndefined(a))return""!==a?a:(console.warn("An empty locale string was passed in; this will be interpreted as the Root locale. This is generally an I18n anti-pattern. Consider passing in a valid BCP 47 language tag."),"und");a=g.resolveDefaultLanguage(b);return""!==a?a:c.getDefaultLocale()||"und"}},{key:"resolveDefaultCurrency",value:function(a,b,c){a=c.resolveDefaultCurrency(a);return""!==a?a:b.getDefaultCurrency()}},{key:"getConfigurationDataWithArgs",value:function(a,b){var c=
new t.ConfigurationData;if(t.isNullOrUndefined(a))return console.log("Return empty configuration data with args undefined."),c;var k;b=ba(b);try{for(b.s();!(k=b.n()).done;){var g=this.configurationProvider.getConfiguration(k.value,a);c.merge(g.configData)}}catch(L){b.e(L)}finally{b.f()}return c}},{key:"checkCachedConfig",value:function(a,b,c){if(this.currencyFormatCache&&this.currencyFormatCache.key===a&&(bc(b,t.PriceFormat.CURRENCY_FORMAT),c.merge(this.currencyFormatCache.value)),this.trailingZeroDisplay||
this.trailingZeroDisplayCache&&this.trailingZeroDisplayCache.key===a){bc(b,t.PriceFormat.TRAILING_ZERO_DISPLAY);var d=this.trailingZeroDisplay?Ib(this.trailingZeroDisplay,lg):this.trailingZeroDisplayCache.value;d=(new t.I18nConfiguration.Builder).addConfiguration(t.PriceFormatResult.TRAILING_ZERO_DISPLAY,d).build();c.merge(d.configData)}this.symbolPositionCache&&this.symbolPositionCache.key===a&&(bc(b,t.PriceFormat.CURRENCY_SYMBOL_POSITION),d=(new t.I18nConfiguration.Builder).addConfiguration(t.PriceFormatResult.CURRENCY_SYMBOL_POSITION,
this.symbolPositionCache.value).build().configData,c.merge(d));this.symbolPrefixCache&&this.symbolPrefixCache.key===a&&(bc(b,t.PriceFormat.SYMBOL_PREFIX),a=(new t.I18nConfiguration.Builder).addConfiguration(t.PriceFormatResult.SYMBOL_PREFIX,this.symbolPrefixCache.value).build().configData,c.merge(a))}},{key:"cacheConfig",value:function(a,b,c){b.includes(t.PriceFormat.CURRENCY_FORMAT)&&(this.currencyFormatCache={key:a,value:c});b.includes(t.PriceFormat.CURRENCY_SYMBOL_POSITION)&&(this.symbolPositionCache=
{key:a,value:c.getEnumValue(t.CurrencySymbolPosition,t.PriceFormatResult.CURRENCY_SYMBOL_POSITION)});b.includes(t.PriceFormat.TRAILING_ZERO_DISPLAY)&&(this.trailingZeroDisplayCache={key:a,value:c.getEnumValue(t.TrailingZeroDisplay,t.PriceFormatResult.TRAILING_ZERO_DISPLAY)});b.includes(t.PriceFormat.SYMBOL_PREFIX)&&(this.symbolPrefixCache={key:a,value:c.getStringValue(t.PriceFormatResult.SYMBOL_PREFIX)})}},{key:"getCurrencySymbolPositionFromConfig",value:function(a){return Me(a.getEnumValue(t.CurrencySymbolPosition,
t.PriceFormatResult.CURRENCY_SYMBOL_POSITION),ri)||"default"}},{key:"buildQueryArgs",value:function(a){return qi.has(this.cxTuple.cxFamily)?(new t.PriceFormatArgsBuilder).withCurrency(a).withCxFamily(this.cxTuple.cxFamily).withCxId(this.cxTuple.cxId).withLocale(this.locale).withPriceFormatType(Ib(this.type,Xc)).build():vb.UNKNOWN.cxFamily===this.cxTuple.cxFamily?(new t.PriceFormatArgsBuilder).withCurrency(a).withLocale(this.locale).withPriceFormatType(Ib(this.type,Xc)).build():void 0}},{key:"getFormat",
value:function(a){var b,c=!1,k=!1,g="default",L=this.getConfigurationData(a.currencyCode,[t.PriceFormat.CURRENCY_FORMAT,t.PriceFormat.SYMBOL_PREFIX,t.PriceFormat.CURRENCY_SYMBOL_POSITION]);a:switch(this.type){case "iso":case "plural":var B=!1;break a;default:B=!0}B&&(B=L.getStringValue(t.PriceFormatResult.SYMBOL),this.marketplaceDefaultCurrencyCode&&this.marketplaceDefaultCurrencyCode!==a.currencyCode&&!B?(c=!0,b=this.symbolPrefix+a.currencyCode,k=!0):B&&(b=B,c=!0,k=L.getBooleanValue(t.PriceFormatResult.INSERT_SPACE_IN_PATTERN)||
!1));return"iso"!==this.type&&(g="default"!==this.symbolPosition?this.symbolPosition:this.resolveSymbolPositionOverride(a.currencyCode)),{numberFormat:this.getNumberFormatFromCacheOrCreate(this.locale,a,this.type),currencySymbol:b,insertSpaceInPattern:k,symbolOverrideApplied:c,symbolPosition:g}}},{key:"getNumberFormatParts",value:function(a){var b=a.currency,c=this.getFormat(b),k=function(a,b){b=Math.pow(10,b||0);var h=Number((a*b).toFixed(5));return 0!=h%.5?a:0==Math.floor(h)%2?Math.floor(h)/b:Math.round(h)/
b}(a.amount,c.numberFormat.resolvedOptions().minimumFractionDigits);if("number"!=typeof k||Number.isNaN(k))throw Error("Amount is not a number");var g,L,B;k=c.numberFormat.formatToParts("compact"===this.type?0>k?Math.ceil(k)||0:Math.floor(k):k);if("compact"===this.type?k=function(a){var b;wd(a)&&"literal"===a[b=lb(a)?kb(a,"literal",!0):kb(a,"literal",!1)].type&&" "===a[b].value&&a.splice(b,1);return a}(k):c.insertSpaceInPattern&&(B={type:"literal",value:" "},wd(g=k)||(lb(g)?(L=kb(g,"currency",!0),
g.splice(L,0,B)):(L=kb(g,"currency",!1),g.splice(L+1,0,B))),k=g),"default"!==c.symbolPosition&&(k=function(a,b,c){if("end"!==c||lb(b)){if("start"===c&&lb(b)){var h=0;"literal"===b[h].type&&h++;"minusSign"===b[h].type&&h++;b=xd(b=Oe(a,b,c,h,!0),kb(b,"currency",!0),h)}}else b=xd(b=Oe(a,b,c,b.length-1,!1),kb(b,"currency",!1),b.length-1);return b}(this.type,k,c.symbolPosition)),!k)throw Error("Intl.NumberFormat formatToParts returned empty");return"HIDE_IF_WHOLE"===this.resolveTrailingZeroDisplay(b.currencyCode)&&
(k=this.hideTrailingZeroIfInteger(a,c,k)),k.map(function(a){var b=a.type;a=a.value;return"currency"===b?(c.symbolOverrideApplied&&c.currencySymbol&&(a=c.currencySymbol),{type:b,value:a}):{type:b,value:a}})}},{key:"hideTrailingZeroIfInteger",value:function(a,b,c){return 0!=a.amount.toFixed(b.numberFormat.resolvedOptions().minimumFractionDigits)%1?c:c.filter(function(a){return"decimal"!==a.type&&"fraction"!==a.type})}},{key:"getNumberFormatFromCacheOrCreate",value:function(a,b,c){a=this.serializeNumberFormatCacheKey(a,
b,c);var d=this.numberFormatCache.get(a);return void 0===d&&(d=new Intl.NumberFormat(this.locale,function(a,b){return Object.assign({currency:a.currencyCode},function(a){return Object.assign({style:"currency",currencyDisplay:bh(a),useGrouping:"compact"!==a},"compact"===a?{maximumFractionDigits:0,minimumFractionDigits:0}:{})}(b))}(b,c)),this.numberFormatCache.set(a,d)),d}},{key:"serializeNumberFormatCacheKey",value:function(a,b,c){return"".concat(a,"-").concat(b.currencyCode,"-").concat(c)}}],[{key:"getInstance",
value:function(a){return(new this.Builder).withLocale(a).withType("amazonSymbol").build()}},{key:"getInstanceByType",value:function(a,b){return(new this.Builder).withLocale(a).withType(b).build()}},{key:"getInstanceByMarketplaceId",value:function(a,b){return(new this.Builder).withLocale(a).withType("amazonSymbol").withMarketplace(new Nd(b)).build()}},{key:"getInstanceByMarketplace",value:function(a,b){return(new this.Builder).withLocale(a).withType("amazonSymbol").withMarketplace(b).build()}},{key:"getInstanceByTypeAndMarketplaceId",
value:function(a,b,c){return(new this.Builder).withLocale(a).withType(b).withMarketplace(new Nd(c)).build()}},{key:"getInstanceByTypeAndMarketplace",value:function(a,b,c){return(new this.Builder).withLocale(a).withType(b).withMarketplace(c).build()}}])}();Yc.Builder=((kg=function(){return D(function k(){E(this,k)},[{key:"withLocale",value:function(a){return this.locale=a,this}},{key:"withType",value:function(a){return this.type=a,this}},{key:"withMarketplace",value:function(a){return this.marketplace=
a,this}},{key:"withMarketplaceId",value:function(a){return this.marketplace=new Nd(a),this}},{key:"withTrailingZeroDisplay",value:function(a){return this.trailingZeroDisplay=a,this}},{key:"withLocalizationContext",value:function(a){this.locale=a.getLocale();this.localizationContext=a;a=a.asAttributesMap().get("marketplace");return a instanceof Ld&&(this.marketplace=a),this}},{key:"build",value:function(){var a=this.marketplace||Of.provider().getMarketplace();return new Yc(this.locale,this.type||"amazonSymbol",
a,this.localizationContext||Yc.Builder.DEFAULT_LC,this.trailingZeroDisplay)}}])}()).DEFAULT_LC=(new mb).build(),kg);var si=function(){return D(function d(a,b){E(this,d);a||(a=(new Intl.NumberFormat).resolvedOptions().locale);b=b&&b.style?Pe(b.style):Pe("default");var c=new Yc.Builder;if(void 0!==a.getLocale){a.getLocale();var k=a.asAttributesMap().get("marketplace");c.withLocalizationContext(a).withMarketplace(k)}else a=Array.isArray(a)?0===a.length?(new Intl.NumberFormat).resolvedOptions().locale:
a[0]:a,c.withLocale(a);this.priceFormat=c.withType(b).build()},[{key:"format",value:function(a){return this.priceFormat.format(a)}}])}(),Tb=function(){function a(b){var c,d=this,k=1<arguments.length&&void 0!==arguments[1]?arguments[1]:a.defaultLocale,g=2<arguments.length?arguments[2]:void 0,L=3<arguments.length?arguments[3]:void 0;if(E(this,a),this.formatterCache={number:{},dateTime:{},pluralRules:{},price:{}},this.format=function(a){a=d.formatToParts(a);if(1===a.length)return a[0].value;a=a.reduce(function(a,
b){return a.length&&b.type===Aa.literal&&"string"==typeof a[a.length-1]?a[a.length-1]+=b.value:a.push(b.value),a},[]);return 1>=a.length?a[0]||"":a},this.formatToParts=function(a){return Hb(d.ast,d.localesOrLocalizationContext,d.formatters,d.formats,a,void 0,d.message,void 0,d.resolvedLocales)},this.formatToVdomParts=function(a,b){return function(a,b,h,c,d,k,g,B,L){return Hb(a,b,h,c,k,void 0,B,d,L).map(function(a){return a.value})}(d.ast,d.localesOrLocalizationContext,d.formatters,d.formats,a,b,0,
d.message,d.resolvedLocales)},this.resolvedOptions=function(){return{locale:d.resolvedLocale.toLocaleString()}},this.getAst=function(){return d.ast},this.localesOrLocalizationContext=k,this.resolvedLocales=a.resolveLocale(void 0!==k.getLocale?k.getLocale():k),Array.isArray(this.resolvedLocales)?this.resolvedLocale=new Intl.Locale(this.resolvedLocales[0]):this.resolvedLocale=new Intl.Locale(this.resolvedLocales),"string"==typeof b){if(this.message=b,!a.__parse)throw new TypeError("IntlMessageFormat.__parse must be set to process `message` of type `string`");
this.ast=a.__parse(b,{ignoreTag:void 0!==L?L.ignoreTag:void 0,locale:this.resolvedLocale})}else this.ast=b;if(!Array.isArray(this.ast))throw new TypeError("A message must be provided as a String or AST.");this.formats=(c=a.formats,g?Object.keys(c).reduce(function(a,b){var h,r;return a[b]=(h=c[b],(r=g[b])?Object.assign(Object.assign(Object.assign({},h||{}),r||{}),Object.keys(h).reduce(function(a,b){return a[b]=Object.assign(Object.assign({},h[b]),r[b]||{}),a},{})):h),a},Object.assign({},c)):c);this.formatters=
L&&L.formatters||function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{number:{},dateTime:{},pluralRules:{},price:{}};return{getNumberFormat:Yb(function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return Eb(Intl.NumberFormat,b)},{cache:dc(a.number),strategy:gc}),getDateTimeFormat:Yb(function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return Eb(Intl.DateTimeFormat,b)},{cache:dc(a.dateTime),strategy:gc}),getPluralRules:Yb(function(){for(var a=
arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return Eb(Intl.PluralRules,b)},{cache:dc(a.pluralRules),strategy:gc}),getPriceFormat:Yb(function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return Eb(si,b)},{cache:dc(a.price),strategy:gc})}}(this.formatterCache)}return D(a,null,[{key:"defaultLocale",get:function(){return a.memoizedDefaultLocale||(a.memoizedDefaultLocale=(new Intl.NumberFormat).resolvedOptions().locale),a.memoizedDefaultLocale}}])}();Tb.memoizedDefaultLocale=
null;Tb.resolveLocale=function(a){return Zb.getCanonicalLocaleString(a)};Tb.__parse=function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};b=Object.assign({shouldParseSkeletons:!0,requiresOtherClause:!0},b);var c=(new Kh(a,b)).parse();if(c.err)throw b=SyntaxError(Q[c.err.kind]),b.location=c.err.location,b.originalMessage=c.err.message,b;return b&&b.captureLocation||ud(c.val),c.val};Tb.formats={number:{integer:{maximumFractionDigits:0},currency:{style:"currency"},percent:{style:"percent"}},
date:{short:{month:"numeric",day:"numeric",year:"2-digit"},medium:{month:"short",day:"numeric",year:"numeric"},long:{month:"long",day:"numeric",year:"numeric"},full:{weekday:"long",month:"long",day:"numeric",year:"numeric"}},time:{short:{hour:"numeric",minute:"numeric"},medium:{hour:"numeric",minute:"numeric",second:"numeric"},long:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},full:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"}},price:{default:{style:"default"},
aui:{style:"aui"},iso:{style:"iso"},plural:{style:"plural"},amazon_symbol:{style:"amazon_symbol"},compact:{style:"compact"},in_sentence:{style:"in_sentence"}}};var ti=function(){return D(function y(a,b,c){E(this,y);this.message=a;this.context=b;this.options=c},[{key:"format",value:function(a){return void 0===this.formatter&&(this.formatter=new Tb(this.message,this.context)),this.formatter.format(a)}}])}(),ui=function(){return D(function y(a,b,c){E(this,y);this.messages=a;this.baseName=b;this.context=
c},[{key:"getMessage",value:function(a){var b=this.messages.get(a);if(void 0===b)throw Error("Resource does not exist: bundle\x3d".concat(this.baseName,", key\x3d").concat(a,", context\x3d").concat(this.context));return b}},{key:"formatMessage",value:function(a,b){a=this.getMessage(a);return(new ti(a,this.context)).format(b)}}])}(),vi=Object.freeze({runtimeResourceFormat:"JsonFileHierarchy",fallbackMechanismAttributes:[["i18nDomain"]]}),ke={};var mg=function(){function a(a,b){var h=a[b];if("function"==
typeof h.bind)return h.bind(a);try{return Function.prototype.bind.call(h,a)}catch(Ha){return function(){return Function.prototype.apply.apply(h,[a,arguments])}}}function b(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments]));console.trace&&console.trace()}function g(a,b){for(var c=0;c<h.length;c++){var f=h[c];this[f]=c<a?L:this.methodFactory(f,a,b)}this.log=this.debug}function d(a,b,h){return function(){"undefined"!==
("undefined"==typeof console?"undefined":ra(console))&&(g.call(this,b,h),this[a].apply(this,arguments))}}function m(h,c,f){var l=h;return("debug"===l&&(l="log"),"undefined"!==("undefined"==typeof console?"undefined":ra(console))&&("trace"===l&&B?b:void 0!==console[l]?a(console,l):void 0!==console.log?a(console,"log"):L))||d.apply(this,arguments)}function p(a,b,f){function l(){if("undefined"!==("undefined"==typeof c?"undefined":ra(c))&&k){try{var a=c.localStorage[k]}catch(Og){}if("undefined"===ra(a))try{var b=
c.document.cookie,h=b.indexOf(encodeURIComponent(k)+"\x3d");-1!==h&&(a=/^([^;]+)/.exec(b.slice(h))[1])}catch(Og){}return void 0===d.levels[a]&&(a=void 0),a}}var r,d=this;b=null==b?"WARN":b;var k="loglevel";"string"==typeof a?k+=":"+a:"symbol"===ra(a)&&(k=void 0);d.name=a;d.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5};d.methodFactory=f||m;d.getLevel=function(){return r};d.setLevel=function(b,f){if("string"==typeof b&&void 0!==d.levels[b.toUpperCase()]&&(b=d.levels[b.toUpperCase()]),!("number"==
typeof b&&0<=b&&b<=d.levels.SILENT))throw"log.setLevel() called with invalid level: "+b;r=b;if(!1!==f)a:if(f=(h[b]||"silent").toUpperCase(),"undefined"!==("undefined"==typeof c?"undefined":ra(c))&&k){try{c.localStorage[k]=f;break a}catch(md){}try{c.document.cookie=encodeURIComponent(k)+"\x3d"+f+";"}catch(md){}}if(g.call(d,b,a),"undefined"===("undefined"==typeof console?"undefined":ra(console))&&b<d.levels.SILENT)return"No console available for logging"};d.setDefaultLevel=function(a){b=a;l()||d.setLevel(a,
!1)};d.resetLevel=function(){d.setLevel(b,!1);a:if("undefined"!==("undefined"==typeof c?"undefined":ra(c))&&k){try{c.localStorage.removeItem(k);break a}catch(kd){}try{c.document.cookie=encodeURIComponent(k)+"\x3d; expires\x3dThu, 01 Jan 1970 00:00:00 UTC"}catch(kd){}}};d.enableAll=function(a){d.setLevel(d.levels.TRACE,a)};d.disableAll=function(a){d.setLevel(d.levels.SILENT,a)};f=l();null==f&&(f=b);d.setLevel(f,!1)}var L=function(){},B="undefined"!==("undefined"==typeof c?"undefined":ra(c))&&"undefined"!==
ra(c.navigator)&&/Trident\/|MSIE /.test(c.navigator.userAgent),h=["trace","debug","info","warn","error"],l=new p,r={};l.getLogger=function(a){if("symbol"!==ra(a)&&"string"!=typeof a||""===a)throw new TypeError("You must supply a name when creating a logger.");var b=r[a];return b||(b=r[a]=new p(a,l.getLevel(),l.methodFactory)),b};var f="undefined"!==("undefined"==typeof c?"undefined":ra(c))?c.log:void 0;return l.noConflict=function(){return"undefined"!==("undefined"==typeof c?"undefined":ra(c))&&c.log===
l&&(c.log=f),l},l.getLoggers=function(){return r},l.default=l,l};ke?ke=mg():Ba.log=mg();var yb=ke.getLogger("arb-js"),Ma={trace:function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];this.output("trace",b)},debug:function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];this.output("debug",b)},info:function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];this.output("info",b)},warn:function(){for(var a=arguments.length,b=Array(a),
c=0;c<a;c++)b[c]=arguments[c];this.output("warn",b)},error:function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];this.output("error",b)},isDebugEnabled:function(){return yb.getLevel()<=yb.levels.DEBUG},isInfoEnabled:function(){return yb.getLevel()<=yb.levels.INFO},output:function(a,b){b[0]="[".concat("arb-js","] ").concat(b[0]);yb[a].apply(yb,ab(b))}},wi={},dh=function(){return D(function d(a){E(this,d);this.RETRY_LIMIT=1;this.loaded={};this.options=Object.assign(Object.assign({},
wi),a)},[{key:"readManifest",value:function(a){return vi}},{key:"readResource",value:(a=ib(na().m(function y(a){var b,c,d,h;return na().w(function(l){for(;;)switch(l.p=l.n){case 0:b=0;case 1:if(!(b<=this.RETRY_LIMIT)){l.n=9;break}if(c=void 0,l.p=2,void 0!==(c=this.options.resolveBundleUrl(this.options,a))){l.n=3;break}return Ma.error("No resource endpoint found. Fallback item: ",a),l.a(2);case 3:return void 0===this.loaded[c]?(Ma.info("Fetching ".concat(c," for fallback item: "),a),this.loaded[c]=
this.options.resolveResourcePack(c)):Ma.info("Request already fetched for fallback item: ",a),l.n=4,this.loaded[c];case 4:if(null!=(d=l.v)){l.n=5;break}return Ma.error("Loading resource has failed. Fallback item: ",a),l.a(2);case 5:return l.a(2,d);case 6:if(l.p=6,h=l.v,!(b<this.RETRY_LIMIT&&h.retry&&c)){l.n=7;break}return Ma.info("Retrying request for ".concat(c,". Fallback item: "),a),this.loaded[c]=void 0,l.a(3,8);case 7:return Ma.error("Failed to load resource. Error: ".concat(h.message,". Fallback item: "),
a),l.a(3,9);case 8:b++;l.n=1;break;case 9:return l.a(2,void 0)}},y,this,[[2,6]])})),function(b){return a.apply(this,arguments)})}]);var a}(),eh=function(a){function b(a){var c,k=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return E(this,b),(c=da(this,b,[a])).retry=k,c.retry=k,c}return ea(b,a),D(b)}(Wb(Error)),ng=function(){return D(function y(a,b){E(this,y);this.resourceReader=a;this.fallbackHandler=b;this.resourcesCache=new Ef(this.resourceReader.readResource.bind(this.resourceReader),
{maxSize:y.RESOURCE_CACHE_SIZE,keyFn:Id.cacheKey})},[{key:"load",value:(a=ib(na().m(function ca(a,b){var c,d,h,l,r,f,F,g,X,m,Da,y,p,t,v,x=this;return na().w(function(B){for(;;)switch(B.p=B.n){case 0:if(c=new Map,d=this.resourceReader.readManifest(a)){B.n=1;break}throw Error("Manifest can not be null!");case 1:return h=this.fallbackHandler.getFallbackChains(a,d.fallbackMechanismAttributes,b),Ma.info('Requesting resource packs for "'.concat(a,'" bundle. Localization context: %0'),b),B.n=2,ch('Resource pack requests for "'.concat(a,
'" bundle'),ib(na().m(function xh(){var a,b,c,f;return na().w(function(l){for(;;)switch(l.n){case 0:a=[];b=ba(h);try{for(b.s();!(c=b.n()).done;)f=c.value,a.push(x.resourcesCache.get(f))}catch(Ai){b.e(Ai)}finally{b.f()}return l.n=1,Promise.all(a);case 1:return l.a(2)}},xh)})));case 2:l=0,r=ba(h),B.p=3,r.s();case 4:if((f=r.n()).done){B.n=8;break}return F=f.value,l++,B.n=5,this.resourcesCache.get(F);case 5:if(void 0!==(g=B.v)&&void 0!==g[F.locale]&&void 0!==g[F.locale][F.bundle]){B.n=6;break}return Ma.debug("No bundled resources were found for %0",
F),B.a(3,7);case 6:for(X=g[F.locale][F.bundle],m=0,Da=Object.entries(X);m<Da.length;m++)y=Ta(Da[m],2),p=y[0],t=y[1],c.has(p)||c.set(p,this.findMessage(t,F));case 7:B.n=4;break;case 8:B.n=10;break;case 9:B.p=9,v=B.v,r.e(v);case 10:return B.p=10,r.f(),B.f(10);case 11:return 0===l&&Ma.error("The generated locale fallback chain was empty.This is bad as no context messages could be populated in MessageBundle."),B.a(2,new ui(c,a,b))}},ca,this,[[3,9,10,11]])})),function(b,c){return a.apply(this,arguments)})},
{key:"findMessage",value:function(a,b){var c=ra(a);if("string"===c)return a;if("object"===c)return(b=this.findMatchingVariant(a,b))?b.value:a.value;throw Error("Unsupported resource pack value type");}},{key:"findMatchingVariant",value:function(a,b){a=a.overrides;for(var c=a.length-1;0<=c;c--){for(var d=a[c],g=!0,h=0,l=Object.entries(d.localizationContext);h<l.length;h++){var r=Ta(l[h],2),f=r[0];r=r[1];if(b.variants&&(!b.variants.has(f)||b.variants.get(f)!==r)){g=!1;break}}if(g)return d}}}]);var a}();
ng.RESOURCE_CACHE_SIZE=512;var Se=function(){return D(function ca(a,b){E(this,ca);this.localizationContextProvider=a;this.asyncResourceReader=b;a=new Ff;this.bundleLoader=new ng(b,a);this.bundleCache=new Ef(this.generateMessageBundle.bind(this),{maxSize:ca.MESSAGE_BUNDLE_CACHE_SIZE,keyFn:Hd.generateCacheKey})},[{key:"generateMessageBundle",value:(b=ib(na().m(function ca(a){return na().w(function(b){for(;;)if(0===b.n)return b.a(2,this.bundleLoader.load(a.bundle,a.context))},ca,this)})),function(a){return b.apply(this,
arguments)})},{key:"getBundle",value:(a=ib(na().m(function B(a,b){var c,l,r;return na().w(function(h){for(;;)switch(h.n){case 0:return c=b||this.localizationContextProvider.getLocalizationContext(),l=new Hd(a,c),h.n=1,this.bundleCache.get(l);case 1:return r=h.v,h.a(2,r)}},B,this)})),function(b,c){return a.apply(this,arguments)})}]);var a,b}();Se.MESSAGE_BUNDLE_CACHE_SIZE=512;var gh={endpointMap:{ar:{strings:"translation-ar.json"},"ar-AE":{strings:"translation-ar.json"},bn:{strings:"translation-bn.json"},
"bn-IN":{strings:"translation-bn.json"},cs:{strings:"translation-cs.json"},"cs-CZ":{strings:"translation-cs.json"},da:{strings:"translation-da.json"},"da-DK":{strings:"translation-da.json"},de:{strings:"translation-de.json"},"de-DE":{strings:"translation-de.json"},en:{strings:"translation-en.json"},"en-CA":{strings:"translation-en.json"},"en-GB":{strings:"translation-en.json"},"en-IN":{strings:"translation-en.json"},"en-US":{strings:"translation-en.json"},es:{strings:"translation-es.json"},"es-ES":{strings:"translation-es.json"},
"es-US":{strings:"translation-es.json"},fr:{strings:"translation-fr.json"},"fr-CA":{strings:"translation-fr.json"},"fr-FR":{strings:"translation-fr.json"},he:{strings:"translation-he.json"},"he-IL":{strings:"translation-he.json"},hi:{strings:"translation-hi.json"},"hi-IN":{strings:"translation-hi.json"},it:{strings:"translation-it.json"},"it-IT":{strings:"translation-it.json"},ja:{strings:"translation-ja.json"},"ja-JP":{strings:"translation-ja.json"},kn:{strings:"translation-kn.json"},"kn-IN":{strings:"translation-kn.json"},
ko:{strings:"translation-ko.json"},"ko-KR":{strings:"translation-ko.json"},ml:{strings:"translation-ml.json"},"ml-IN":{strings:"translation-ml.json"},mr:{strings:"translation-mr.json"},"mr-IN":{strings:"translation-mr.json"},nl:{strings:"translation-nl.json"},"nl-NL":{strings:"translation-nl.json"},pl:{strings:"translation-pl.json"},"pl-PL":{strings:"translation-pl.json"},pt:{strings:"translation-pt.json"},"pt-BR":{strings:"translation-pt.json"},"pt-PT":{strings:"translation-pt.json"},ta:{strings:"translation-ta.json"},
"ta-IN":{strings:"translation-ta.json"},te:{strings:"translation-te.json"},"te-IN":{strings:"translation-te.json"},tr:{strings:"translation-tr.json"},"tr-TR":{strings:"translation-tr.json"},und:{strings:"translation.json"},zh:{strings:"translation-zh.json"},"zh-CN":{strings:"translation-zh.json"},"zh-TW":{strings:"translation-zh.json"}}},hh=new Map([["translations/translation.json",R(254)],["translations/translation-ar.json",R(3278)],["translations/translation-de.json",R(214)],["translations/translation-en.json",
R(8494)],["translations/translation-es.json",R(1045)],["translations/translation-he.json",R(602)],["translations/translation-ko.json",R(3743)],["translations/translation-pt.json",R(2061)],["translations/translation-zh.json",R(3847)],["translations/translation-fr.json",R(8925)],["translations/translation-it.json",R(7992)],["translations/translation-ja.json",R(2300)]]),Zc=x(function k(){var b=this,c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";z(this,k);a(this,"missingElements",[]);a(this,
"getElementOrRecordMissing",function(a){var c=1<arguments.length&&void 0!==arguments[1]&&arguments[1],d=document.getElementById(a);!d&&(b.missingElements.push(a),c)&&(c=b.sourceComponentName?"[".concat(b.sourceComponentName,"] "):"",m.logErrorWithLevel(H.ERROR,"".concat(c,"Rufus element ID was not found: ").concat(a)));return d});a(this,"getMissingElements",function(){return b.missingElements});a(this,"logMissingElementsAndThrowError",function(){if(0<b.missingElements.length){var a=b.sourceComponentName?
"[".concat(b.sourceComponentName,"] "):"";a="".concat(a,"Rufus element IDs were not found: ").concat(b.missingElements.join(", "));throw m.logErrorWithLevel(H.ERROR,a),Error(a);}});this.sourceComponentName=c}),ta=function(){function a(){z(this,a);this.weblabTreatmentsMap=this.getWeblabTreatmentsMap()}return x(a,[{key:"parseWeblabTreatmentsMap",value:function(a){var b=this,c={};if(!a)return c;try{a.slice(1,-1).split(",").forEach(function(a){a=Ca(a.trim().split("\x3d"),2);var d=a[1];c[a[0].trim()]=
b.isTreatmentNull(d.trim())?void 0:d.trim()}),m.addCount(p.RUFUS_CLIENT_WEBLAB_TREATMENTS_PARSED,1)}catch(ca){m.logErrorWithLevelWithException(H.ERROR,ca,"Could not parse the weblab treatments, weblabTreatments: ".concat(a))}return c}},{key:"isTreatmentNull",value:function(a){return"null"===a||"undefined"===a}},{key:"getWeblabTreatmentsMap",value:function(){var a=fa("clientWeblabTreatmentMap");return this.parseWeblabTreatmentsMap(a)}},{key:"getWeblabTreatment",value:function(a){var b;return null===
(b=this.weblabTreatmentsMap)||void 0===b?void 0:b[a]}},{key:"getWeblabTreatments",value:function(a){var b=this;return a.map(function(a){var c;return null===(c=b.weblabTreatmentsMap)||void 0===c?void 0:c[a]})}},{key:"isWeblabTreatmentEnabledAndRecordTrigger",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"T1",c=this.getWeblabTreatment(a);return c&&m.recordTrigger(a,c),c===b}}],[{key:"getInstance",value:function(){return a.instance||(a.instance=new a),a.instance}}])}(),
gb=function(){function a(){z(this,a);var b=(new Zc("ErrorRenderer")).getElementOrRecordMissing("rufus-active-conversation-container",!0),c=document.getElementById("rufus-error-container");c?this.errorContainer=c:(c=document.createElement("div"),c.classList.add("rufus-error-container"),c.id="rufus-error-container",null==b||b.insertAdjacentElement("afterend",c),this.errorContainer=c)}return x(a,null,[{key:"initialize",value:function(){a.instance=new a}},{key:"renderError",value:function(b){this.logCount(b.errorCode);
a.resetErrorContainer();a.hideLoader();a.populateErrorContainerInner(b.errorCode,b.errorMessage,b.retryCallback);a.getInstance().currentErrorCode=b.errorCode}},{key:"removeError",value:function(b){a.getInstance().currentErrorCode===b&&a.resetErrorContainer()}},{key:"getInstance",value:function(){return a.instance||(a.initialize(),m.logErrorWithLevel(H.ERROR,"ErrorRenderer should be initialized at the top level before calling renderError")),a.instance}},{key:"logCount",value:function(a){m.addCount(p.RENDERED_ERROR_CODE_PREFIX+
a,1)}},{key:"resetErrorContainer",value:function(){a.getInstance().errorContainer.innerHTML="";a.getInstance().currentErrorCode=void 0}},{key:"hideLoader",value:function(){var a=document.getElementById("rufus-conversation-loader-container");null==a||a.classList.add("aok-hidden")}},{key:"populateErrorContainerInner",value:function(b,c,g){var d=a.getInstance(),k=document.createElement("div");k.classList.add("rufus-error-container-inner","rufus-remove-section");b&&k.setAttribute("data-error-code",b.toString());
a.shouldApplyAvatarPadding()&&k.classList.add("rufus-avatar-padding");a.renderErrorMessage(k,c);g&&a.renderRetryButton(k,g);d.errorContainer.appendChild(k)}},{key:"shouldApplyAvatarPadding",value:function(){var a=document.getElementById("rufus-history-container"),b=document.getElementById("rufus-active-conversation-container"),c=ta.getInstance().getWeblabTreatment("RUFUS_DESKTOP_VISUAL_BRANDING_UPDATE_1201601");return(this.hasConversation(b)||this.hasConversation(a))&&"T1"!==c&&"T2"!==c}},{key:"hasConversation",
value:function(a){return!!(a&&0<a.children.length)&&Array.from(a.children).some(function(a){return 0<a.children.length})}},{key:"renderErrorMessage",value:(b=A(P().mark(function L(a,b){var c,h,l,r;return P().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(c=document.createElement("div"),f.prev=1,"offline_error_message"!==b&&void 0!==b){f.next=3;break}return h="offline_error_message"===b?"offline_error_message":"default_error_message",f.next=2,zd(document.documentElement.lang);case 2:l=f.sent;
c.innerHTML=l.getMessage(h);f.next=4;break;case 3:c.innerHTML=b;case 4:f.next=6;break;case 5:f.prev=5,r=f.catch(1),m.logErrorWithLevel(H.ERROR,"Failed to load translation bundle",r instanceof Error?r.message:String(r)),c.innerHTML="Something went wrong. Please try again later.";case 6:return f.prev=6,c.classList.add("rufus-error-text"),a.appendChild(c),f.finish(6);case 7:case "end":return f.stop()}},L,null,[[1,5,6,7]])})),function(a,c){return b.apply(this,arguments)})},{key:"renderRetryButton",value:function(a,
b){var c=document.createElement("span");c.classList.add("rufus-retry-button-container","a-button","a-button-toggle","system-pill");var k=document.createElement("span");k.classList.add("a-button-inner");var h=document.createElement("button");h.classList.add("rufus-retry-button","a-button-text","a-text-center");h.type="button";var l=document.createElement("span");l.classList.add("a-color-link");l.textContent="Retry";h.appendChild(l);k.appendChild(h);c.appendChild(k);a.appendChild(c);h.addEventListener("click",
function(){b()})}},{key:"destroy",value:function(){a.instance=void 0}}]);var b}(),Bi=x(function w(){z(this,w);a(this,"firstInferenceChunkProcessed",!1);a(this,"activeChunk",{});a(this,"patchMap",{})}),og=x(function d(){z(this,d);a(this,"renderingTimestamps",[]);a(this,"networkTimestamps",[]);a(this,"backendTimestamps",[])}),$c=function(a){return a.NEW_STREAM="NEW_STREAM",a.SSE_ERROR="SSE_ERROR",a.TIMEOUT="TIMEOUT",a.PAGE_NAVIGATION="PAGE_NAVIGATION",a.UNKNOWN="UNKNOWN",a}({}),pg=x(function ca(b){z(this,
ca);a(this,"activeChunkPatchIds",[]);a(this,"chunkFirstReceivedMap",new Map);a(this,"latencyData",new Bi);this.tabId=b}),ad=function(a,b){if(!(this instanceof ad))return new ad(a,b);this.INITIALIZING=-1;this.CONNECTING=0;this.OPEN=1;this.CLOSED=2;this.url=a;b=b||{};this.headers=b.headers||{};this.payload=void 0!==b.payload?b.payload:"";this.method=b.method||this.payload&&"POST"||"GET";this.withCredentials=!!b.withCredentials;this.debug=!!b.debug;this.FIELD_SEPARATOR=":";this.listeners={};this.xhr=
null;this.readyState=this.INITIALIZING;this.progress=0;this.lastEventId=this.chunk="";this.addEventListener=function(a,b){void 0===this.listeners[a]&&(this.listeners[a]=[]);-1===this.listeners[a].indexOf(b)&&this.listeners[a].push(b)};this.removeEventListener=function(a,b){if(void 0!==this.listeners[a]){var c=[];this.listeners[a].forEach(function(a){a!==b&&c.push(a)});0===c.length?delete this.listeners[a]:this.listeners[a]=c}};this.dispatchEvent=function(a){if(!a)return!0;this.debug&&console.debug(a);
a.source=this;var b="on"+a.type;return(!this.hasOwnProperty(b)||(this[b].call(this,a),!a.defaultPrevented))&&(!this.listeners[a.type]||this.listeners[a.type].every(function(b){return b(a),!a.defaultPrevented}))};this._markClosed=function(){this.xhr=null;this._setReadyState(this.CLOSED)};this._setReadyState=function(a){var b=new CustomEvent("readystatechange");this.readyState=b.readyState=a;this.dispatchEvent(b)};this._onStreamFailure=function(a){var b=new CustomEvent("error");b.responseCode=a.currentTarget.status;
b.data=a.currentTarget.response;this.dispatchEvent(b);this._markClosed()};this._onStreamAbort=function(){this.dispatchEvent(new CustomEvent("abort"));this._markClosed()};this._onStreamProgress=function(a){if(this.xhr)if(200===this.xhr.status){a=this.xhr.responseText.substring(this.progress);this.progress+=a.length;a=(this.chunk+a).split(/(\r\n\r\n|\r\r|\n\n)/g);var b=a.pop();a.forEach(function(a){0<a.trim().length&&this.dispatchEvent(this._parseEventChunk(a))}.bind(this));this.chunk=b}else this._onStreamFailure(a)};
this._onStreamLoaded=function(a){this._onStreamProgress(a);this.dispatchEvent(this._parseEventChunk(this.chunk));this.chunk="";this._markClosed()};this._preProcessChunk=function(a){var b,c=[],l=!1;a=Te(a.split(/\n|\r\n|\r/));try{for(a.s();!(b=a.n()).done;){var r=b.value,f=r.trim();f.startsWith("data:")?(l=!0,c.push(r)):f.startsWith("event:")||f.startsWith("id:")||""===f?(l=!1,c.push(r)):l?c.push("data: ".concat(f)):c.push(r)}}catch(F){a.e(F)}finally{a.f()}return c.join("\n")};this._parseEventChunk=
function(a){if(!a||0===a.length)return null;this.debug&&console.debug(a);a=this._preProcessChunk(a);var b={id:null,retry:null,data:null,event:null};a.split(/\n|\r\n|\r/).forEach(function(a){var c=a.indexOf(this.FIELD_SEPARATOR);if(0<c){var h=" "===a[c+1]?2:1;var f=a.substring(0,c);a=a.substring(c+h)}else{if(!(0>c))return;f=a;a=""}f in b&&("data"===f&&null!==b[f]?b.data+="\n"+a:b[f]=a)}.bind(this));null!==b.id&&(this.lastEventId=b.id);a=new CustomEvent(b.event||"message");return a.id=b.id,a.data=b.data||
"",a.lastEventId=this.lastEventId,a};this._onReadyStateChange=function(){if(this.xhr&&this.xhr.readyState===XMLHttpRequest.HEADERS_RECEIVED){var a,b={},c=Te(this.xhr.getAllResponseHeaders().trim().split("\r\n"));try{for(c.s();!(a=c.n()).done;){var l=void 0,r=void 0,f=void 0,g=a.value.split(":");r=Array.isArray(g)?g:void 0;(f=r)||(f="undefined"!=typeof Symbol&&null!=g[Symbol.iterator]||null!=g["@@iterator"]?Array.from(g):void 0);if(!(l=f||Ue(g)))throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
var Z=l;var X=Z[0],m=Z.slice(1).join(":").trim();b[X.trim().toLowerCase()]=b[X.trim().toLowerCase()]||[];b[X.trim().toLowerCase()].push(m)}}catch(Da){c.e(Da)}finally{c.f()}a=new CustomEvent("open");a.responseCode=this.xhr.status;a.headers=b;this.dispatchEvent(a);this._setReadyState(this.OPEN)}};this.stream=function(){if(!this.xhr){for(var a in this._setReadyState(this.CONNECTING),this.xhr=new XMLHttpRequest,this.xhr.addEventListener("progress",this._onStreamProgress.bind(this)),this.xhr.addEventListener("load",
this._onStreamLoaded.bind(this)),this.xhr.addEventListener("readystatechange",this._onReadyStateChange.bind(this)),this.xhr.addEventListener("error",this._onStreamFailure.bind(this)),this.xhr.addEventListener("abort",this._onStreamAbort.bind(this)),this.xhr.open(this.method,this.url),this.headers)this.xhr.setRequestHeader(a,this.headers[a]);0<this.lastEventId.length&&this.xhr.setRequestHeader("Last-Event-ID",this.lastEventId);this.xhr.withCredentials=this.withCredentials;this.xhr.send(this.payload)}};
this.close=function(){this.readyState!==this.CLOSED&&this.xhr.abort()};(void 0===b.start||b.start)&&this.stream()};"undefined"!=typeof exports&&(exports.SSE=ad);var qg,xa=function(a){return a.SEARCH_RESULTS="SEARCH_RESULTS",a.DETAIL_PAGE="DETAIL_PAGE",a.GATEWAY="GATEWAY",a.CART="CART",a.UNKNOWN="UNKNOWN",a}({}),Xe=(qg=a(a(a(a(a({},xa.DETAIL_PAGE,["ATVDetail","Detail","MASDetailPage","MoneraDetailPage","vindp"]),xa.SEARCH_RESULTS,["Search"]),xa.GATEWAY,["Gateway"]),xa.CART,["ShoppingCart"]),xa.UNKNOWN,
["Unknown"]),Object.fromEntries(Object.entries(qg).flatMap(function(a){a=Ca(a,2);var b=a[0];return a[1].map(function(a){return[a,b]})}))),M=x(function ca(){z(this,ca)});a(M,"timeouts",new Map);a(M,"startTimeout",function(a,b,c){M.validateTimeoutId(a)&&(M.clear(a),b=M.createTimeoutInfo(b,c),M.setTimeoutWithCallback(a,b))});a(M,"extendTimeout",function(a,b){var c=M.timeouts.get(a);if(!c)return!1;void 0!==c.id&&clearTimeout(c.id);b=M.calculateExtendedDuration(c,b).newDuration;b=M.updateTimeoutInfo(c,
b);return void 0===c.pausedAt?M.setTimeoutWithCallback(a,b):M.timeouts.set(a,b),!0});a(M,"pauseTimeout",function(a){var b=M.timeouts.get(a);if(!b||void 0!==b.pausedAt)return!1;M.clearExistingTimeout(b);b=M.createPausedTimeoutInfo(b);return M.timeouts.set(a,b),!0});a(M,"resumeTimeout",function(a){var b=M.timeouts.get(a);if(!b||void 0===b.pausedAt)return!1;b=M.createResumedTimeoutInfo(b);return M.setTimeoutWithCallback(a,b),!0});a(M,"clear",function(a){var b=M.timeouts.get(a);return!!b&&(M.clearExistingTimeout(b),
M.timeouts.delete(a),!0)});a(M,"clearTimeouts",function(a){a.forEach(function(a){M.clear(a)})});a(M,"hasTimeout",function(a){return M.timeouts.has(a)});a(M,"validateTimeoutId",function(a){return!!a||(m.logErrorWithLevel(H.ERROR,"Empty timeout id. Timeout id must be a non-empty string."),!1)});a(M,"createTimeoutInfo",function(a,b){return{id:void 0,callback:a,startTime:Date.now(),duration:b,pausedAt:void 0}});a(M,"setTimeoutWithCallback",function(a,b){var c=setTimeout(function(){M.timeouts.delete(a);
b.callback()},b.duration);M.timeouts.set(a,bb(bb({},b),{},{id:c}))});a(M,"calculateExtendedDuration",function(a,b){var c,h,l=Date.now();return void 0!==a.pausedAt?(c=a.pausedAt-a.startTime,h=a.duration-c+b):(c=l-a.startTime,h=Math.max(0,a.duration-c)+b),{elapsedTime:c,newDuration:h}});a(M,"updateTimeoutInfo",function(a,b){return bb(bb({},a),{},{id:void 0,startTime:Date.now(),duration:b})});a(M,"createPausedTimeoutInfo",function(a){var b=Date.now(),c=Math.max(0,a.duration-(b-a.startTime));return bb(bb({},
a),{},{id:void 0,duration:c,pausedAt:b})});a(M,"createResumedTimeoutInfo",function(a){return bb(bb({},a),{},{id:void 0,startTime:Date.now(),pausedAt:void 0})});a(M,"clearExistingTimeout",function(a){void 0!==a.id&&clearTimeout(a.id)});var zb=function(){function b(){var c=this;z(this,b);a(this,"loggers",new Map);a(this,"initialize",function(a,b){c.loggers.set(a.configName,new Ci(a,b))});a(this,"getLogger",function(a){return c.loggers.get(a)})}return x(b,null,[{key:"getInstance",value:function(){return b.instance||
(b.instance=new b),b.instance}}])}(),Ci=x(function h(b,c){var l=this;z(this,h);a(this,"setMarker",function(a){var b=l.markers.findIndex(function(b){return b.name===a});-1!==b?l.markers[b].timestamp=Date.now():m.logErrorWithLevel(H.WARN,'Marker "'.concat(a,'" not found in configuration.'))});a(this,"skipMarker",function(a){var b=l.markers.findIndex(function(b){return b.name===a});-1!==b?l.markers[b].timestamp=null:m.logErrorWithLevel(H.WARN,'Marker "'.concat(a,'" not found in configuration.'))});a(this,
"markerProcessed",function(a){var b=l.markers.findIndex(function(b){return b.name===a});return-1!==b&&void 0!==l.markers[b].timestamp});a(this,"emitMetrics",function(){if(l.allMarkersProcessed()){var a=l.calculateLatencyMetrics();l.emitCSMLatencyMetrics(a)}});a(this,"allMarkersProcessed",function(){return l.markers.every(function(a){return void 0!==a.timestamp})});a(this,"calculateLatencyMetrics",function(){return l.markers.map(function(a){var b=l.config.markers.findIndex(function(b){return b.name===
a.name});return{timestamp:a.timestamp,csmLatencyEvent:l.config.markers[b].csmLatencyEvent,biMetricName:l.config.markers[b].biMetricName}})});a(this,"emitCSMLatencyMetrics",function(a){var b=l.config.configName;m.widgetBodyBegin(b,l.startTime);a.map(function(a){a.timestamp&&m.logCsmFeatureLatency(a.csmLatencyEvent,b,a.timestamp)});m.widgetBodyEnd(b)});this.startTime=null!=c?c:Date.now();this.config=b;this.markers=b.markers.map(function(a){return{name:a.name,timestamp:void 0}})}),bd={configName:"RUFUS_USER_PERCEIVED_LATENCY",
markers:[{name:"initialized",biMetricName:"RUFUS_INITIALIZE_UPL",csmLatencyEvent:db.ClickToATF},{name:"initial_streaming_first_chunk_received",biMetricName:"RUFUS_INITIAL_STREAMING_FIRST_CHUNK_UPL",csmLatencyEvent:db.ClickToCF}]},rg={configName:"RUFUS_USER_PERCEIVED_LATENCY_BF_CACHE",markers:[{name:"initialized",biMetricName:"RUFUS_INITIALIZE_BF_CACHE_UPL",csmLatencyEvent:db.ClickToATF},{name:"initial_streaming_first_chunk_received",biMetricName:"RUFUS_INITIAL_STREAMING_FIRST_CHUNK_BF_CACHE_UPL",
csmLatencyEvent:db.ClickToCF}]},V=function(a){return a.CLOSE="close",a.INTERNAL_ERROR="internal_error",a.SOFTLANDING_ERROR="softlanding_error",a.UNSUPPORTED_QUERY_ERROR="unsupported_query_error",a.CONTEXT="context",a.AFFORDANCE="affordance",a.MESSAGE="message",a.INTERIM="interim",a.INFERENCE="inference",a.CURATED_ANSWER="curated_answer",a.FEEDBACK="feedback",a.UNKNOWN="unknown",a.REMOVE="remove",a.ACTION="action",a}({}),ya=function(a){return a.OPEN="open",a.STREAMING="streaming",a.CLOSED="closed",
a.ERROR="error",a}({}),sg=function(b){function c(b,h,f,g){var l;return z(this,c),a(l=function(a,b,c){return b=v(b),C(a,Ze()?Reflect.construct(b,[],v(a).constructor):b.apply(a,c))}(this,c),"startInitialStreamingCall",function(a){var b=Pa(a.pageType),c=a.qis,h=a.metadata;l.startStream({actionType:l.getInitialStreamingActionType(b,c),isInitialStream:!0,qis:c,externalQuery:l.getInitialStreamingExternalQuery(a.keyword,c),metadata:h,reftag:K.extractNileReftagFromUrl(K.getCurrentPageUrl())})}),a(l,"genericStreamingEventHandler",
function(a){l.eventSource?(l.shouldUseRufusCommonModule?l.streamingLogger.setChunkReceived(a,l.streamingStatus,!0):l.streamingLogger.setChunkReceived(a,l.streamingStatus),M.clearTimeouts(c.streamingTimeoutIds),M.startTimeout("midstream_timeout",l.streamTimeoutHandler,4E4),l.shouldUseRufusCommonModule?l.dispatch("onEventReceivedV2",{event:a,streamingStatusDetails:l.streamingStatus,streamingEventType:a.type}):l.dispatch("onEventReceived",{event:a,streamingStatusDetails:l.streamingStatus,streamingEventType:a.type}),
Object.values(V).includes(a.type)||m.logErrorWithLevel(H.ERROR,"Unsupported event type ".concat(a.type," received"))):(m.logErrorWithLevel(H.ERROR,"SSE stream event received with undefined event source: ".concat(a.type)),gb.renderError({errorCode:nb.UNDEFINED_EVENT_SOURCE}))}),a(l,"streamOpenHandler",function(){l.setStreamingStatus({streamingStatus:ya.OPEN});l.streamingLogger.openStreamingRequest()}),a(l,"streamCloseEventHandler",function(){l.setStreamingStatus({streamingStatus:ya.CLOSED});M.clearTimeouts(c.streamingTimeoutIds);
l.eventSource&&l.streamingLogger.closeStreamingRequest()}),a(l,"streamErrorHandler",function(a){if(l.setStreamingStatus({streamingStatus:ya.ERROR}),M.clearTimeouts(c.streamingTimeoutIds),navigator.onLine)a=l.getResponseCode(a),l.streamingLogger.handleStreamError($c.SSE_ERROR,a),gb.renderError({errorCode:nb.SSE_HANDLER_ERROR})}),a(l,"streamTimeoutHandler",function(){l.setStreamingStatus({streamingStatus:ya.ERROR});M.clearTimeouts(c.streamingTimeoutIds);l.abortCurrentStream($c.TIMEOUT);gb.renderError({errorCode:nb.TIMEOUT})}),
l.A=b,l.contextManager=h,l.tabId=f,l.streamingLogger=g,l.streamingStatus={streamingStatus:void 0,actionType:void 0,inputQuery:void 0,asinId:void 0,isInitialStream:void 0,requestContext:void 0,metadata:void 0},l.isBfcacheNavigation=!1,l.shouldUseRufusCommonModule=ta.getInstance().isWeblabTreatmentEnabledAndRecordTrigger("RUFUS_ORTELIUS_COMPLETE_DIALUP_1259431")||ta.getInstance().isWeblabTreatmentEnabledAndRecordTrigger("RUFUS_COMMON_ASSETS_MIGRATION_CL_1189218"),l}return N(c,b),x(c,[{key:"startStream",
value:(h=A(P().mark(function f(a){var b,c,h,r,g,B,m,p,L,t,v,x,A;return P().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(c=a.actionType,h=a.inputQuery,r=a.asinId,g=a.isInitialStream,B=a.qis,m=a.externalQuery,p=a.metadata,L=a.reftag,this.abortCurrentStream($c.NEW_STREAM),this.streamingLogger.startStreamingRequest(c),t=this.contextManager.buildContext(c,h,r,g,B,m,p,this.shouldUseRufusCommonModule),v=null===(b=t.bottomSheetContext)||void 0===b?void 0:b.bottomSheetEmpty,c!==U.SWIPE_UP||!1!==
v){f.next=1;break}return null===(x=zb.getInstance().getLogger(bd.configName))||void 0===x||x.skipMarker("initial_streaming_first_chunk_received"),this.dispatch("invalidatePanelCache",!1),f.abrupt("return");case 1:this.dispatch("saveRequestMetadataToPanelCache",{actionType:c,inputQuery:h,asinId:r,isInitialStream:g,qis:B,externalQuery:m,metadata:p,reftag:L}),g&&this.isBfcacheNavigation&&O(G.BACK_NAVIGATION),A=this.getUrl(L),this.setStreamingStatus({streamingStatus:ya.STREAMING,actionType:c,requestContext:t,
inputQuery:null!=h?h:void 0,asinId:null!=r?r:void 0,isInitialStream:!0===g,metadata:null!=p?p:void 0}),M.startTimeout("initial_chunk_timeout",this.streamTimeoutHandler,4E4),this.initEventSource(A,t);case 2:case "end":return f.stop()}},f,this)})),function(a){return h.apply(this,arguments)})},{key:"getStreamingStatus",value:function(){return this.streamingStatus}},{key:"abortCurrentStream",value:function(a){this.eventSource&&(this.streamingStatus.streamingStatus!==ya.CLOSED&&this.streamingLogger.handleRequestInterrupted(a),
this.eventSource.close(),this.eventSource=void 0)}},{key:"setIsBfcacheNavigation",value:function(a){this.isBfcacheNavigation=a}},{key:"getIsRufusStayBehaviorRequired",value:function(){return this.contextManager.getIsRufusStayBehaviorRequired()}},{key:"initEventSource",value:function(b,c){var h=Ed();this.eventSource=new ad(b,{payload:JSON.stringify(c),method:"POST",headers:ih(a(a({},eb.CONTENT_TYPE,"application/json"),eb.ANTI_CSRF_TOKEN,Dd()),void 0!==h&&a({},eb.FLOW_CLOSURE_ID,h))});this.eventSource.onopen=
this.streamOpenHandler;b=0;for(c=Object.values(V);b<c.length;b++)h=c[b],this.eventSource.addEventListener(h,this.getEventHandler(h));this.eventSource.onerror=this.streamErrorHandler}},{key:"getEventHandler",value:function(a){return a===V.CLOSE?this.streamCloseEventHandler:this.genericStreamingEventHandler}},{key:"setStreamingStatus",value:function(a){var b=a.streamingStatus,c=a.actionType,h=a.inputQuery,r=a.asinId,g=a.isInitialStream;a=a.requestContext;b={streamingStatus:void 0===b?this.streamingStatus.streamingStatus:
b,actionType:void 0===c?this.streamingStatus.actionType:c,inputQuery:void 0===h?this.streamingStatus.inputQuery:h,asinId:void 0===r?this.streamingStatus.asinId:r,isInitialStream:void 0===g?this.streamingStatus.isInitialStream:g,requestContext:void 0===a?this.streamingStatus.requestContext:a};this.dispatch("onStreamingStatusChange",b);this.streamingStatus=b}},{key:"getResponseCode",value:function(a){try{var b=JSON.stringify(a);return JSON.parse(b).responseCode}catch(F){return console.error("".concat("StreamingClient",
" - Error parsing SSEvent ").concat(F instanceof Error?"(".concat(F.message,")"):"")),"unknown"}}},{key:"getUrl",value:function(a){var b=this.A.$(location).attr("href");b=new URL(b);var c=b.searchParams.get("auditEnabled");return b.search="?tabId\x3d".concat(this.tabId),"true"===c&&b.searchParams.append("auditEnabled","true"),b.hash="",b.pathname="/rufus/cl/streaming",a&&b.searchParams.append("ref",a),this.shouldUseRufusCommonModule&&b.searchParams.append("programId","NILE_CLASSIC"),b.toString()}},
{key:"shouldShowDeepLinkFallbackCX",value:function(a){return!(a!==La.NILE_INGRESS_LINK||"T1"!==ta.getInstance().getWeblabTreatment("RUFUS_DESKTOP_DEEP_LINK_FALLBACK_1106261"))}},{key:"getInitialStreamingExternalQuery",value:function(a,b){return this.shouldShowDeepLinkFallbackCX(b)?void 0:a}},{key:"getInitialStreamingActionType",value:function(a,b){if(Object.values(La).includes(b))return this.shouldShowDeepLinkFallbackCX(b)?U.SWIPE_UP:U.SEARCH;switch(a){case xa.SEARCH_RESULTS:return a=K.extractQueryFromUrl(K.getCurrentPageUrl()),
b=this.contextManager.getSearchBarQuery(),a||b?U.SEARCH:U.SWIPE_UP;case xa.DETAIL_PAGE:return U.ASIN_CLICK;default:return U.SWIPE_UP}}}]);var h}(Ia);a(sg,"streamingTimeoutIds",["initial_chunk_timeout","midstream_timeout"]);var Di=function(a){function b(a){z(this,b);var c=b;var h=(c=v(c),C(this,$e()?Reflect.construct(c,[],v(this).constructor):c.apply(this,void 0)));return h.A=a,h.initialize(),h}return N(b,a),x(b,[{key:"initialize",value:function(){this.registerOnClickedAction(this.A)}},{key:"registerOnClickedAction",
value:function(a){var c=this;a.declarative("rufus-action","click",function(a){void 0!==a.data.action?(a=b.eventDataToActionData(a.data),c.onAction(a)):void 0!==a.data.actionType&&c.onAction(b.eventDataToAction(a.data))})}},{key:"onAction",value:function(a){this.dispatch("onAction",a)}}],[{key:"eventDataToActionData",value:function(a){return new wf(a.action,null==a?void 0:a.query,null==a?void 0:a.sectionId,null==a?void 0:a.clickEventName)}},{key:"eventDataToAction",value:function(a){return new wf(a)}}])}(Ia),
le=function(){return x(function B(){z(this,B)},null,[{key:"isWDCSSection",value:function(a,b){return"ReviewAspectPillCarousel"===a&&b===ua.NILE_NDSWDCS_RELATED_QUESTION}}])}();a(le,"removeDataMixClaimedAttribute",function(a){var b;a=a.querySelector("#cr-product-insights-cards");null==a||null===(b=a.parentElement)||void 0===b||b.removeAttribute("data-mix-claimed")});var tg=function(a,b,c){m.logErrorWithLevel(H.ERROR,"".concat(a.toLowerCase()," resolution image could not be ").concat(b.toLowerCase(),
"ed due to error: ").concat(c));m.addCount("ERROR_ON_".concat(b,"ING_").concat(a,"_RES_IMAGE"),1);m.widgetBodyEnd("RUFUS_".concat(a,"_RESOLUTION_IMAGE_").concat(b,"ED_LATENCY"),!0)},W=function(){function a(){z(this,a)}return x(a,null,[{key:"handleLinkWrapperLeftClick",value:function(b,c){var h=a.getAnchorElement(c);b=b(c);var r=c.metaKey;c.ctrlKey||r?a.handleModifierKeyLeftClick(b):a.handleStandardLeftClick(c,b,null==h?void 0:h.href)}},{key:"handleModifierKeyLeftClick",value:function(a){a&&m.addCount(p.RUFUS_HYPERLINK_CLICK_PREFIX+
"OPENED_IN_NEW_TAB_"+a,1)}},{key:"handleStandardLeftClick",value:function(a,b,l){a.preventDefault();b&&m.addCount(p.RUFUS_HYPERLINK_CLICK_PREFIX+"OPENED_IN_CURRENT_TAB_"+b,1);l&&c.location.assign(l)}},{key:"handleLinkWrapperAuxClick",value:function(a,b){(a=a(b))&&m.addCount(p.RUFUS_HYPERLINK_CLICK_PREFIX+"OPENED_IN_NEW_TAB_"+a,1)}},{key:"handleLinkWrapperOpenContextMenu",value:function(a,b){(a=a(b))&&m.addCount(p.RUFUS_HYPERLINK_CLICK_PREFIX+"OPENED_CONTEXT_MENU_"+a,1)}},{key:"getAnchorElement",value:function(a){return a.currentTarget instanceof
HTMLAnchorElement?a.currentTarget:void 0}}])}();a(W,"LINK_WRAPPER_CLASS_NAME","rufus-link-wrapper");a(W,"ASIN_FACEOUT_LINK_SELECTOR",".rufus-asin-faceout-wrapper a");a(W,"ASIN_FACEOUT_DATA_SECTION_CLASS","AsinFaceoutList");a(W,"addListeners",function(a){"T1"==W.triggerWeblabAndGetTreatment()&&a&&(W.addListenersToLinkWrappers(a),W.addListenersToAsinFaceoutLinks(a))});a(W,"addListenersToLinkWrappers",function(a){a=a.getElementsByClassName(W.LINK_WRAPPER_CLASS_NAME);Array.from(a).forEach(function(a){return W.addLinkEventListeners(a,
W.getRegularLinkEventName)})});a(W,"addListenersToAsinFaceoutLinks",function(a){a=a.querySelectorAll(W.ASIN_FACEOUT_LINK_SELECTOR);Array.from(a).forEach(function(a){return W.addLinkEventListeners(a,W.getAsinFaceoutEventName)})});a(W,"getRegularLinkEventName",function(a){var b;return null===(b=W.getAnchorElement(a))||void 0===b?void 0:b.getAttribute("data-click-event-name")});a(W,"getAsinFaceoutEventName",function(){return W.ASIN_FACEOUT_DATA_SECTION_CLASS});a(W,"addLinkEventListeners",function(a,
b){a.addEventListener("click",W.handleLinkWrapperLeftClick.bind(null,b));a.addEventListener("contextmenu",W.handleLinkWrapperOpenContextMenu.bind(null,b));a.addEventListener("auxclick",W.handleLinkWrapperAuxClick.bind(null,b))});a(W,"triggerWeblabAndGetTreatment",function(){var a=ta.getInstance().getWeblabTreatment("RUFUS_DESKTOP_LINK_REPLACEMENT_1164286");if(a)return m.recordTrigger("RUFUS_DESKTOP_LINK_REPLACEMENT_1164286",a),a});var ug=function(){return x(function B(){z(this,B)},null,[{key:"parseEventData",
value:function(a){try{return JSON.parse(a.data)}catch(h){return m.logErrorWithLevelWithException(H.ERROR,h,"Rufus - Error parsing event data: ".concat(h instanceof Error?"(".concat(h.message,")"):"")),null}}}])}(),Ub=function(a){a.forEach(function(a){a.classList.remove("fade-in","rufus-fade-in","rufus-web-fade-in")})},Ei=["type","src","charset","class"],Fi=function(a){return Ei.includes(a)||a.startsWith("data-")},Gi=function(a){a=a.getAttribute("type");return!a||"text/javascript"===a||"application/javascript"===
a},me=function(a){var b=document.getElementById("rufus-conversation-container");b&&Array.from(a.querySelectorAll("script")).map(function(a){var b=document.createElement("script");return a.getAttributeNames().filter(Fi).forEach(function(c){var h=a.getAttribute(c);b.setAttribute(c,h)}),b.text=a.text,b}).forEach(function(a){try{b.appendChild(a)}catch(l){m.logErrorWithLevelWithException(H.ERROR,l,"Failed to load additional script for execution")}})},Ya=function(a){return a.VisibleWithAvatar="visibileWithAvatar",
a.VisibleWithoutAvatar="visibleWithoutAvatar",a.Hidden="hidden",a}({}),za=function(a){return a.AppendActive="appendActive",a.PrependHistory="prependHistory",a.ReplaceActive="replaceActive",a.ReplaceHistory="replaceHistory",a.InsertIntoLastActiveTurn="insertIntoLastActiveTurn",a.RemoveLastActiveTurn="removeLastActiveTurn",a.ReplaceInterruptedConversation="replaceInterruptedConversation",a}({}),Hi=function(b){function g(b,c,r){var h;return z(this,g),a(h=function(a,b,c){return b=v(b),C(a,bf()?Reflect.construct(b,
[],v(a).constructor):b.apply(a,c))}(this,g),"isTopLoading",!1),a(h,"currentGeneratingMessage","Rufus is currently generating a response"),a(h,"completedGeneratingMessage","Rufus has completed generating a response"),a(h,"MULTIMODAL_IMAGE_ID_SECTION_SELECTOR",'[id^\x3d"rufus-panel-image-carousel-card-"]'),a(h,"MULTIMODAL_IMAGE_ID_SELECTOR",'[id^\x3d"conversation-layer-image"]'),a(h,"SECTIONS_WITH_SCRIPTS",["ReviewAspectPillCarousel","AsinFaceoutList"]),a(h,"moveInterruptionRecoveryContainerOutOfConversation",
function(){h.toggleInterruptionRecoveryButtonVisibility(!1);h.toggleInterruptionRecoverySpinnerVisibility(!1);h.getInterruptionRecoveryContainer().classList.add("aok-hidden");h.elements.mainContainer.appendChild(h.getInterruptionRecoveryContainer())}),a(h,"fixUnsupportedSymbols",function(a){return lh.forEach(function(b,c){a=a.replace(new RegExp(c,"g"),b)}),a}),a(h,"isSpinnerShowing",function(){return null!=h.elements.spinnerContainer&&!h.elements.spinnerContainer.classList.contains("aok-hidden")}),
a(h,"removeActiveConversationTurnsFromHistory",function(a){for(var b=h.getNumberOfConversationTurns(),c=0;c<b&&a.lastChild;c++)a.removeChild(a.lastChild)}),a(h,"getSectionGroupIdsFromSection",function(a){a=a.querySelectorAll('[id^\x3d"section_groupId_"]');return Array.from(a).map(function(a){return a.id})}),a(h,"selectSectionWithId",function(a,b){return a.querySelector("#".concat(b))}),a(h,"replaceStreamingElement",function(a,b){var c=parseInt(a.getAttribute("data-rufus-sequenceid")||""),l=parseInt(b.getAttribute("data-rufus-sequenceid")||
"");return!isNaN(c)&&!isNaN(l)&&c<l?(h.animationUtil.prepareSectionForReplaceAnimation(a,b),a.style.height="".concat(a.getBoundingClientRect().height,"px"),a.innerHTML=b.innerHTML,a.style.removeProperty("height"),a.setAttribute("data-rufus-sequenceid",String(l)),a):void 0}),a(h,"appendElementToContainer",function(a){var b=1<arguments.length&&void 0!==arguments[1]&&arguments[1],c=2<arguments.length?arguments[2]:void 0,l=3<arguments.length?arguments[3]:void 0;h.animationUtil.prepareSectionForAppendAnimation(a);
void 0===h.elements.currentStreamContainer&&h.createNewStreamContainer(b,U.UNKNOWN);var f=a.getAttribute("data-section-class")||void 0,r=c&&c===V.MESSAGE;if("TextSubsections"!==f||l!==ua.NILE_NDSWDCS_RELATED_QUESTION){if(le.isWDCSSection(f,l)||"AsinFaceoutList"===f){var g=a.cloneNode(!0),F=g.id;!function(a){Ub([a]);a.classList.remove("rufus-visibility-hidden")}(g);(function(a,b){var c;a=function(a,b){var c="undefined"!=typeof Symbol&&a[Symbol.iterator]||a["@@iterator"];if(!c){if(Array.isArray(a)||
(c=function(a,b){if(a){if("string"==typeof a)return af(a,b);var c={}.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?af(a,b):void 0}}(a))||b&&a&&"number"==typeof a.length){c&&(a=c);var h=0;b=function(){};return{s:b,n:function(){return h>=a.length?{done:!0}:{done:!1,value:a[h++]}},e:function(a){throw a;},f:b}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
}var l,f=!0,r=!1;return{s:function(){c=c.call(a)},n:function(){var a=c.next();return f=a.done,a},e:function(a){r=!0;l=a},f:function(){try{f||null==c.return||c.return()}finally{if(r)throw l;}}}}(a.querySelectorAll("script"));try{for(a.s();!(c=a.n()).done;){var h=c.value;Gi(h)&&(h.text="//".concat(b,"\n").concat(h.text))}}catch(xi){a.e(xi)}finally{a.f()}})(g,F);h.sectionIdToScriptSectionsMap[F]=g;me(g)}var m;return h.shouldAddRemoveSectionClass(b,l,r,f)&&a.classList.add("rufus-remove-section"),"Carousel"===
f&&h.updateConversationLayerImageURL(a),"PriceHistoryChart"===f&&h.appendSvgChartToContainer(a),b&&c===V.AFFORDANCE&&(null===(m=h.elements.currentStreamContainer)||void 0===m||m.classList.remove("rufus-contextual-pills-container")),h.elements.currentStreamContainer.appendChild(a),h.handleHidingLoaderAvatar(c),a}}),a(h,"handleLoadMoreHistoryButtonClick",function(){m.addCount(p.LOAD_HISTORY_BUTTON_CLICK,1);O(G.LOAD_HISTORY);h.dispatch("onLoadMoreHistoryButtonClick",void 0)}),a(h,"replaceContentInContainer",
function(a,b){h.elements.container.style.removeProperty("scroll-behavior");var c=document.createElement("div");c.innerHTML=a;Bd(c,function(){b===za.ReplaceActive?(h.elements.activeConversationContainer.innerHTML="".concat(c.innerHTML),W.addListeners(h.elements.activeConversationContainer)):b===za.ReplaceHistory&&(h.elements.historyContainer.innerHTML="".concat(c.innerHTML),W.addListeners(h.elements.historyContainer));h.elements.container.scrollTop=h.elements.container.scrollHeight;h.elements.container.style.scrollBehavior=
"smooth";h.dispatch("completeReplacingContentInContainer",void 0)})}),a(h,"handleInterruptionRecoveryButtonClick",function(a){m.addCount(p.INTERRUPTION_RECOVERY_BUTTON_CLICK,1);O(G.INTERRUPTION_RECOVERY_BUTTON_CLICK);h.toggleInterruptionRecoveryButtonVisibility(!1);h.toggleInterruptionRecoverySpinnerVisibility(!0);h.dispatch("onInterruptionRecoveryButtonClick",a)}),a(h,"updateCache",function(){h.cacheManager.setPanelContent(h.getPanelContentSnapshot())}),h.missingElementsRecorder=new Zc("ConversationList"),
h.sectionIdToScriptSectionsMap={},h.elements=h.readHtmlElementsFromDom(),h.animationUtil=b,h.streamingLifecycleEventLogger=c,h.cacheManager=r,h.asinFaceoutState={expectAsinFaceoutChunkNext:!1},h.loadTranslations(),h.SECTIONS_WITH_SCRIPTS.forEach(function(a){a=h.elements.container.querySelectorAll("[".concat("data-section-class",'\x3d"').concat(a,'"]'));Array.from(a).forEach(function(a){a=a.cloneNode(!0);h.sectionIdToScriptSectionsMap[a.id]=a;me(a)})}),h.updateCache(),h.elements.container.style.scrollBehavior=
"smooth",h.attachEventListeners(),h}return N(g,b),x(g,[{key:"refreshOnBfCacheNavigation",value:function(){Object.assign(this.elements,this.readHtmlElementsFromDom());this.attachEventListeners();this.loadTranslations()}},{key:"loadTranslations",value:function(){var a=this;zd(document.documentElement.lang).then(function(b){a.currentGeneratingMessage=b.getMessage("currently_generating_a_response");a.completedGeneratingMessage=b.getMessage("completed_generating_a_response")}).catch(function(a){m.logErrorWithLevelWithException(H.ERROR,
a,"Failed to load accessibility translations for Rufus generation status messages")})}},{key:"readHtmlElementsFromDom",value:function(){var a={container:this.missingElementsRecorder.getElementOrRecordMissing("rufus-conversation-container"),mainContainer:this.missingElementsRecorder.getElementOrRecordMissing("rufus-container-main-view"),containerInner:this.missingElementsRecorder.getElementOrRecordMissing("rufus-conversation-container-inner"),activeConversationContainer:this.missingElementsRecorder.getElementOrRecordMissing("rufus-active-conversation-container"),
historyContainer:this.missingElementsRecorder.getElementOrRecordMissing("rufus-history-container"),rufusFlyoutDiv:this.missingElementsRecorder.getElementOrRecordMissing("nav-flyout-rufus"),overflowMenu:this.missingElementsRecorder.getElementOrRecordMissing("rufus-overflow-menu-container"),loadMoreHistoryButton:document.getElementById("rufus-load-more-history-button"),beginningOfHistoryContainer:document.getElementById("rufus-history-beginning-container"),loader:document.getElementById("rufus-conversation-loader-container"),
loaderAvatar:document.getElementById("rufus-loader-avatar"),rufusPanelContent:document.getElementById("nav-rufus-content"),spinnerContainer:document.getElementById("rufus-load-history-spinner-container")};return this.missingElementsRecorder.logMissingElementsAndThrowError(),a}},{key:"attachEventListeners",value:function(){var a;null===(a=this.elements.loadMoreHistoryButton)||void 0===a||a.addEventListener("click",this.handleLoadMoreHistoryButtonClick);W.addListeners(this.elements.activeConversationContainer)}},
{key:"modifyContent",value:function(a,b,c){if(this.validateContentForOperation(a,b)){switch(a){case za.PrependHistory:this.handlePrependHistory(b,!!c);break;case za.AppendActive:this.handleAppendActive(b);break;case za.ReplaceHistory:case za.ReplaceActive:this.replaceContentInContainer(b,a);break;case za.InsertIntoLastActiveTurn:this.handleInsertIntoLastActiveTurn(b);break;case za.RemoveLastActiveTurn:var h;null===(h=this.elements.activeConversationContainer.lastElementChild)||void 0===h||h.remove();
break;case za.ReplaceInterruptedConversation:this.handleReplaceInterruptedConversation(b)}this.updateCache()}}},{key:"moveInterruptionRecoveryContainerToConversation",value:function(a){var b=this.elements.activeConversationContainer.children.length;0<b&&(this.elements.activeConversationContainer.children[b-1].appendChild(this.getInterruptionRecoveryContainer()),this.dispatch("lastActiveTurnContentUpdated",void 0),this.addInterruptionRecoveryButtonEventListener(a),this.toggleInterruptionRecoveryButtonVisibility(!0),
this.getInterruptionRecoveryContainer().classList.remove("aok-hidden"))}},{key:"getInterruptionRecoveryContainer",value:function(){return document.getElementById("rufus-interrupted-stream-affordance-container")}},{key:"dismissInterruptionRecoverySpinnerAndShowButton",value:function(){this.toggleInterruptionRecoverySpinnerVisibility(!1);this.toggleInterruptionRecoveryButtonVisibility(!0);this.getInterruptionRecoveryContainer().classList.remove("aok-hidden")}},{key:"checkInterruptionRecoveryButtonVisibility",
value:function(){return this.getInterruptionRecoveryButton()&&!this.getInterruptionRecoveryButton().classList.contains("aok-hidden")}},{key:"toggleLoadMoreHistoryButtonElementVisibility",value:function(a){var b;a&&m.addCount(p.RUFUS_HISTORY_BUTTON_SHOWN,1);null===(b=this.elements.loadMoreHistoryButton)||void 0===b||null===(b=b.parentElement)||void 0===b||b.classList.toggle("aok-hidden",!a)}},{key:"toggleBeginningOfHistoryElementVisibility",value:function(a){var b;a&&m.addCount(p.RUFUS_BEGINNING_HISTORY_SHOWN,
1);null===(b=this.elements.beginningOfHistoryContainer)||void 0===b||b.classList.toggle("aok-hidden",!a)}},{key:"isFtuxOrRuxOnScreen",value:function(){var a=Array.from(this.elements.activeConversationContainer.getElementsByClassName("conversation-turn-container")),b=Array.from(this.elements.historyContainer.getElementsByClassName("conversation-turn-container"));return 0<a.length&&(a[0].classList.contains("rufus-initial-stream-container")||a[0].classList.contains("PlaceholderMessage"))&&0===b.length}},
{key:"getActiveConversationContainerContent",value:function(){return this.elements.activeConversationContainer.innerHTML}},{key:"getHistoryContainerContent",value:function(){return this.elements.historyContainer.innerHTML}},{key:"createNewStreamContainer",value:function(a,b){this.handleInitialStream(!!a);var c=this.createAndAppendContainer(!!a);b&&(b===U.SEARCH||b===U.ASIN_CLICK)&&a&&c.classList.add("rufus-contextual-pills-container");this.elements.container.focus()}},{key:"removeTemporarySections",
value:function(){Array.from(this.elements.container.getElementsByClassName("rufus-remove-section")).forEach(function(a){var b;null===(b=a.parentElement)||void 0===b||b.removeChild(a)})}},{key:"getRemovableSectionsFromLatestActiveTurn",value:function(){var a,b;return Array.from(null!==(a=null===(b=this.elements.activeConversationContainer.lastElementChild)||void 0===b?void 0:b.getElementsByClassName("rufus-remove-section"))&&void 0!==a?a:[])}},{key:"startTopLoading",value:function(){this.isTopLoading||
(this.elements.container.insertBefore(this.elements.spinnerContainer,this.elements.container.firstChild),this.toggleLoadMoreHistorySpinnerElementVisibility(!0),this.isTopLoading=!0)}},{key:"endTopLoading",value:function(){this.isTopLoading&&(this.toggleLoadMoreHistorySpinnerElementVisibility(!1),this.isTopLoading=!1)}},{key:"toggleLoaderAndUpdateAnnouncer",value:function(a){var b=document.getElementById("rufus-status-announcer");switch(a){case Ya.VisibleWithAvatar:this.elements.loader.classList.remove("aok-hidden");
this.elements.loaderAvatar.classList.remove("rufus-visibility-hidden");b&&(b.textContent=this.currentGeneratingMessage);break;case Ya.VisibleWithoutAvatar:this.elements.loader.classList.remove("aok-hidden");this.elements.loaderAvatar.classList.add("rufus-visibility-hidden");b&&b.textContent!==this.currentGeneratingMessage&&(b.textContent=this.currentGeneratingMessage);break;case Ya.Hidden:this.elements.loader.classList.add("aok-hidden"),this.elements.loaderAvatar.classList.add("rufus-visibility-hidden"),
b&&(b.textContent=this.completedGeneratingMessage)}}},{key:"updateHtmlSections",value:function(a){var b=this,c=a.event,h=a.streamingStatusDetails,g=a.streamingEventType;if(c.data&&""!==c.data){var m=this.prepareNewHtmlContent(c.data);W.addListeners(m);this.refreshTruncation();a=this.getSectionGroupIdsFromSection(m);if(0!==a.length){var X=a.length-1;a.forEach(function(a,f){b.processSection(m,a,f,X,h,c,g)})}else this.handleNoSectionGroups(c.data)}}},{key:"updateHtmlSectionsV2",value:function(a){var b=
this,c=a.event,h=a.streamingStatusDetails,g=a.streamingEventType;if(c.data&&""!==c.data){a=this.asinFaceoutState;var m=a.expectAsinFaceoutChunkNext;a=a.faceoutAction;if(m&&a)this.handleASINFaceoutUpdate(c,h,g);else{a=ug.parseEventData(c);a=null==a?void 0:a.sections;var X=null==a?void 0:a.map(function(a){return a.target.groupId}).filter(function(a){return!!a}),Ha=X?X.length-1:void 0;this.refreshTruncation();null==a||a.forEach(function(a,f){if("AsinFaceoutList"!==a.target.type||m){var l=a.target.groupId;
if(l){var r=b.prepareNewHtmlContent(a.content.data);W.addListeners(r);b.processSectionV2(r,l,f,Ha,h,c,a.action,g)}else b.handleNoSectionGroups(a.content.data)}else b.asinFaceoutState={expectAsinFaceoutChunkNext:!0,faceoutAction:a.action}})}}}},{key:"removeHtml",value:function(a,b){var c=this;"Section"===a&&this.animationUtil.enqueueAnimation(function(){m.addCount(p.SECTION_REMOVED,1);O(G.REMOVE_SECTION);c.removeSection(b);c.streamingLifecycleEventLogger.recordPatchRenderEnd(Date.now())})}},{key:"removeSection",
value:function(a){var b;if(a){a=document.getElementById("section_groupId_"+a);var c=this.hasAvatar(a);null==a||null===(b=a.parentElement)||void 0===b||b.removeChild(a);c&&this.handleRemovedSectionHadAvatar()}}},{key:"hasAvatar",value:function(a){return null!=(null==a?void 0:a.querySelector(".rufus-avatar-img"))}},{key:"handleRemovedSectionHadAvatar",value:function(){this.toggleLoaderAndUpdateAnnouncer(Ya.VisibleWithAvatar)}},{key:"refreshTruncation",value:function(){ka.when("a-truncate").execute(function(a){a.refreshAutoTruncate()})}},
{key:"getPanelContentSnapshot",value:function(){var a=this,b=this.elements.rufusPanelContent.cloneNode(!0),c=b.querySelector("#".concat("rufus-conversation-loader-container")),f=b.querySelector("#".concat("rufus-load-history-spinner-container")),g=b.querySelector("#".concat("rufus-active-conversation-container")),m=b.querySelector("#".concat("rufus-history-container")),X=b.querySelector("#".concat("rufus-conversation-container")),Ha=b.querySelector("#".concat("rufus-scroll-button")),B=b.querySelector("#".concat("rufus-overflow-menu-container-webapp")),
p=b.querySelector(".".concat("rufus-asin-filter-pill")),t=b.querySelector(".".concat("rufus-asin-filter-shade"));X.style.removeProperty("scroll-behavior");this.handleAsinFilterPillSnapshot(p,t);this.purgeExcessConversations(g,m);m=Array.from(m.children);g.prepend.apply(g,m);g=function(b){var c=X.querySelector("#".concat(b));if(c){var h=a.sectionIdToScriptSectionsMap[b],f=h.getAttribute("data-section-class")||void 0,l="AsinFaceoutList"===f?c.cloneNode(!0):h;document.querySelectorAll("body \x3e script").forEach(function(a){a.text&&
a.text.includes("//".concat(b))&&l.appendChild(a)});"ReviewAspectPillCarousel"===f&&le.removeDataMixClaimedAttribute(l);c.replaceWith(l)}};for(var v in this.sectionIdToScriptSectionsMap)g(v);return c&&c.classList.add("aok-hidden"),f&&f.classList.add("aok-hidden"),Ha&&(Ha.style.display="none"),B&&(B.innerHTML=this.elements.overflowMenu.innerHTML),b}},{key:"updateInnerContainerHeight",value:function(){var a=0<arguments.length&&void 0!==arguments[0]&&arguments[0],b=this.elements.containerInner.getBoundingClientRect().height,
c=this.elements.rufusFlyoutDiv.style.getPropertyValue("--expanded-container-height");c=c?parseInt(c)-96:0;(a||(b>c||""===this.elements.historyContainer.innerHTML.trim())&&b!==c)&&(this.elements.containerInner.style.height="".concat(c,"px"))}},{key:"toggleLoadMoreHistorySpinnerElementVisibility",value:function(a){var b;null===(b=this.elements.spinnerContainer)||void 0===b||b.classList.toggle("aok-hidden",!a)}},{key:"getNumberOfConversationTurns",value:function(){if(!this.areContainersValid())return 0;
var a=this.getTurnsFromContainers(),b=a.activeTurns;a=a.historyTurns;var c=0<b.length&&b[0].classList.contains("rufus-initial-stream-container")&&0===a.length;return 1===b.length&&(0===a.length||1===a.length&&a[0].classList.contains("rufus-initial-stream-container"))||c?0:this.calculateTotalTurns(b,a)}},{key:"markLastTurnAnimationComplete",value:function(){var a;null===(a=this.elements.activeConversationContainer.lastElementChild)||void 0===a||a.classList.add("animation-complete")}},{key:"isLastTurnAnimationComplete",
value:function(){var a;return(null===(a=this.elements.activeConversationContainer.lastElementChild)||void 0===a?void 0:a.classList.contains("animation-complete"))||!1}},{key:"isLastTurnContentEmpty",value:function(){var a;return""===(null===(a=this.elements.activeConversationContainer.lastElementChild)||void 0===a?void 0:a.innerHTML)}},{key:"isFtuxPresent",value:function(){var a=document.querySelector('[id^\x3d"section_groupId_"]');return"PlaceholderMessage"===(null==a?void 0:a.getAttribute("data-section-class"))}},
{key:"isAffordancePresentInContainer",value:function(){var a,b=(null===(a=this.elements.activeConversationContainer.lastElementChild)||void 0===a?void 0:a.children)||[];return Array.from(b).some(function(a){return"CustomerText"===a.getAttribute("data-section-class")})}},{key:"purgeExcessConversations",value:function(a,b){zf(a);zf(b);Array.from(a.children).forEach(function(b){var c;b.classList.contains("rufus-contextual-pills-container")&&null!==(c=b.lastElementChild)&&void 0!==c&&c.classList.contains("rufus-remove-section")&&
a.removeChild(b)});yf(a,5);yf(b,5-a.children.length)}},{key:"moveActiveConversationTurnsToHistory",value:function(){var a=this;Array.from(this.elements.activeConversationContainer.children).forEach(function(b){return a.elements.historyContainer.append(b)});this.elements.activeConversationContainer.innerHTML="";this.dispatch("completeMovingActiveConversationTurnsToHistory",void 0)}},{key:"handleHidingLoaderAvatar",value:function(a){a=a!==V.AFFORDANCE;!this.elements.loaderAvatar.classList.contains("rufus-visibility-hidden")&&
a&&this.toggleLoaderAndUpdateAnnouncer(Ya.VisibleWithoutAvatar)}},{key:"toggleInterruptionRecoveryButtonVisibility",value:function(a){var b;a&&(m.addCount(p.INTERRUPTION_RECOVERY_BUTTON_SHOWN,1),O(G.INTERRUPTION_RECOVERY_BUTTON_SHOWN));null===(b=this.getInterruptionRecoveryButton())||void 0===b||b.classList.toggle("aok-hidden",!a)}},{key:"toggleInterruptionRecoverySpinnerVisibility",value:function(a){var b;null===(b=this.getInterruptionRecoverySpinner())||void 0===b||b.classList.toggle("aok-hidden",
!a)}},{key:"addInterruptionRecoveryButtonEventListener",value:function(a){var b,c=this;null===(b=this.getInterruptionRecoveryButton())||void 0===b||b.addEventListener("click",function(){return c.handleInterruptionRecoveryButtonClick(a)})}},{key:"getInterruptionRecoveryButton",value:function(){return document.getElementById("rufus-interrupted-stream-recovery-button-container")}},{key:"getInterruptionRecoverySpinner",value:function(){return document.getElementById("rufus-interrupted-stream-recovery-spinner-container")}},
{key:"appendSvgChartToContainer",value:function(a){var b=a.getElementsByClassName("rufus-pricing-chart-container");0!==b.length&&ka.now("pricing-chart-client").execute(function(a){void 0!==a?Array.from(b).forEach(function(b){var c=b.dataset.pricingChartJson,h=b.dataset.pricingWindowsEnabled;c&&h?(c="true"===h?a.rebuildData(Number(b.dataset.pricingDefaultWindowIndex),JSON.parse(c)):JSON.parse(c),(c=a.renderChart(c))||m.addCount(p.RUFUS_PRICING_RENDERING_ERROR,1),b.innerHTML=c):m.addCount(p.RUFUS_PRICING_INVALID_DATA,
1)}):m.addCount(p.RUFUS_PRICING_CLIENT_NOT_LOADED,1)})}},{key:"updateConversationLayerImageURL",value:function(a){var b=this;m.widgetBodyBegin(oa.UPDATE_CL_IMAGE_URL_TO_LOW_RES);a=a.querySelectorAll(this.MULTIMODAL_IMAGE_ID_SECTION_SELECTOR);0>=a.length||(a.forEach(function(a){!function(a,b){var h=b.getAttribute("data-a-modal");if(null!=h){var f,l,r,g=null===(f=JSON.parse(h))||void 0===f?void 0:f.imageUrl,F=null!==(l=null===(r=JSON.parse(h))||void 0===r?void 0:r.actionId)&&void 0!==l?l:"";null!=g?
(f=function(a){if(!a.includes("m.media-amazon.com"))return a;var b=Math.ceil(400*c.devicePixelRatio*(1>=c.devicePixelRatio?1:.6)),h=a.split(".");h=h[h.length-1];return a.replace(h,"".concat("_SL").concat(b.toString(),"_.").concat(h))}(g),l=a.src,a.onload=function(){m.widgetBodyEnd(oa.RUFUS_LOW_RESOLUTION_IMAGE_LOADED_LATENCY,!1);m.widgetBodyBegin(oa.RUFUS_LOW_RESOLUTION_IMAGE_RENDERED_LATENCY);a.decode().then(function(){m.widgetBodyEnd(oa.RUFUS_LOW_RESOLUTION_IMAGE_RENDERED_LATENCY,!1);m.addCount(p.RUFUS_MULTIMODAL_IMAGE_SHOWN,
1)})},a.src=f,m.widgetBodyBegin(oa.RUFUS_LOW_RESOLUTION_IMAGE_LOADED_LATENCY),a.onclick=function(){O(G.OPEN_MEDIA,F);m.addCount(p.RUFUS_MULTIMODAL_IMAGE_CLICKED,1)},a.onerror=function(a){tg("LOW","RENDER",a.toString())},b.setAttribute("data-a-modal",h.toString().replace(l,f))):m.logErrorWithLevel(H.ERROR,"High resolution image is empty.")}else m.logErrorWithLevel(H.ERROR,"DataModel for MultiModal is null.")}(a.querySelector(b.MULTIMODAL_IMAGE_ID_SELECTOR),a.parentElement)}),m.widgetBodyEnd(oa.UPDATE_CL_IMAGE_URL_TO_LOW_RES))}},
{key:"areContainersValid",value:function(){return this.elements.activeConversationContainer?!!this.elements.historyContainer||(m.addCount(p.RUFUS_HISTORY_CONTAINER_IN_HISTORY_NULL,1),!1):(m.addCount(p.RUFUS_ACTIVE_CONVERSATION_CONTAINER_IN_HISTORY_NULL,1),!1)}},{key:"getTurnsFromContainers",value:function(){return{activeTurns:Array.from(this.elements.activeConversationContainer.getElementsByClassName("conversation-turn-container")),historyTurns:Array.from(this.elements.historyContainer.getElementsByClassName("conversation-turn-container"))}}},
{key:"calculateTotalTurns",value:function(a,b){var c=0;return a.forEach(function(a){var b=a.classList.contains("rufus-initial-stream-container");""!==a.innerHTML.trim()&&(a.hasChildNodes()||b)||a.remove();c+=b?0:1}),b.forEach(function(a){c++;""!==a.innerHTML.trim()&&a.hasChildNodes()||a.remove()}),c}},{key:"handleInitialStream",value:function(a){a&&(this.removeFTUXIfNoInteraction(),this.moveActiveConversationTurnsToHistory())}},{key:"removeFTUXIfNoInteraction",value:function(){var a,b=this.elements.activeConversationContainer.lastElementChild;
this.shouldDedupeFTUX(b)&&(null==b||null===(a=b.parentElement)||void 0===a||a.removeChild(b))}},{key:"shouldDedupeFTUX",value:function(a){var b,c;if(null==a||!a.classList.contains("rufus-initial-stream-container"))return!1;var h=null==a||null===(b=a.firstElementChild)||void 0===b?void 0:b.getAttribute("data-section-class");a=null==a||null===(c=a.children)||void 0===c||null===(c=c[1])||void 0===c?void 0:c.getAttribute("data-section-class");return"PlaceholderMessage"===h&&"CustomerText"!==a}},{key:"createAndAppendContainer",
value:function(a){var b=document.createElement("div");return b.classList.add("conversation-turn-container"),a&&b.classList.add("rufus-initial-stream-container"),this.elements.activeConversationContainer.append(b),this.elements.currentStreamContainer=b,b}},{key:"prepareNewHtmlContent",value:function(a){var b=document.createElement("div");return b.innerHTML=this.fixUnsupportedSymbols(a),b}},{key:"handleNoSectionGroups",value:function(a){this.modifyContent(za.AppendActive,a);m.addCount(p.RUFUS_SECTION_WITHOUT_GROUP_SECTION_ID,
1)}},{key:"processSection",value:function(a,b,c,f,g,m,X){var h=this;this.animationUtil.enqueueAnimation(function(){var l=h.getSectionGroupIdsFromSection(h.elements.activeConversationContainer).includes(b)?h.updateExistingSection(a,b):h.addNewSection(a,b,g,X);return h.streamingLifecycleEventLogger.recordSectionRenderEnd(m,g,c,c===f),l})}},{key:"processSectionV2",value:function(a,b,c,f,g,m,X,B){var h=this;this.animationUtil.enqueueAnimation(function(){var l;return"ADD"===X?l=h.addNewSection(a,b,g,B):
"REPLACE"===X&&(l=h.updateExistingSection(a,b)),h.streamingLifecycleEventLogger.recordSectionRenderEnd(m,g,c,c===f),l})}},{key:"updateExistingSection",value:function(a,b){var c=this.selectSectionWithId(this.elements.activeConversationContainer,b);a=this.selectSectionWithId(a,b);return c&&a?this.replaceStreamingElement(c,a):void 0}},{key:"addNewSection",value:function(a,b,c,f){var h;return(a=a.querySelector("#".concat(b)))?this.appendElementToContainer(a,c.isInitialStream,f,null===(h=c.requestContext)||
void 0===h||null===(h=h.queryContext)||void 0===h?void 0:h.qis):void 0}},{key:"validateContentForOperation",value:function(a,b){var c=[za.AppendActive,za.PrependHistory,za.InsertIntoLastActiveTurn];return!(!b&&c.includes(a))}},{key:"handlePrependHistory",value:function(a,b){var c=this;this.elements.container.style.removeProperty("scroll-behavior");var h=this.elements.container.scrollHeight,l=this.createTempDiv(a);b&&this.removeActiveConversationTurnsFromHistory(l);this.updateConversationLayerImageURL(l);
this.appendSvgChartToContainer(l);Bd(l,function(){c.prependContentAndUpdateScroll(l,h)})}},{key:"prependContentAndUpdateScroll",value:function(a,b){var c;me(a);(c=this.elements.historyContainer).prepend.apply(c,Ad(a.children));W.addListeners(this.elements.historyContainer);this.endTopLoading();this.elements.container.scrollTop+=this.elements.container.scrollHeight-b;this.elements.container.style.scrollBehavior="smooth"}},{key:"createTempDiv",value:function(a){var b=document.createElement("div");return b.innerHTML=
a,b}},{key:"handleReplaceInterruptedConversation",value:function(a){var b=this.getInterruptionRecoveryContainer().parentElement;null!=b&&b.classList.contains("conversation-turn-container")&&(this.moveInterruptionRecoveryContainerOutOfConversation(),a=this.createTempDiv(a),this.updateConversationLayerImageURL(a),this.appendSvgChartToContainer(a),b.outerHTML=a.innerHTML,W.addListeners(this.elements.activeConversationContainer))}},{key:"handleAppendActive",value:function(a){var b;a=this.createTempDiv(a);
(b=this.elements.activeConversationContainer).append.apply(b,Ad(a.children));W.addListeners(this.elements.activeConversationContainer)}},{key:"handleInsertIntoLastActiveTurn",value:function(a){if(0<this.elements.activeConversationContainer.children.length){var b;a=this.createTempDiv(a);null===(b=this.elements.activeConversationContainer.lastElementChild)||void 0===b||b.append.apply(b,Ad(a.children));W.addListeners(this.elements.activeConversationContainer.lastElementChild);this.dispatch("lastActiveTurnContentUpdated",
void 0)}}},{key:"handleASINFaceoutUpdate",value:function(a,b,c){var h=this,l=this.prepareNewHtmlContent(a.data);W.addListeners(l);this.refreshTruncation();var r=this.getSectionGroupIdsFromSection(l);if(0!==r.length){var g=r.length-1;r.forEach(function(f,r){h.processSectionV2(l,f,r,g,b,a,h.asinFaceoutState.faceoutAction,c)});this.asinFaceoutState={expectAsinFaceoutChunkNext:!1,faceoutAction:void 0}}else this.handleNoSectionGroups(a.data)}},{key:"handleAsinFilterPillSnapshot",value:function(a,b){if(a&&
b){a.classList.remove("rufus-asin-filter-pill-show","rufus-asin-filter-pill-hide");a.classList.add("aok-hidden");a.removeAttribute("aria-label");var c=a.querySelector("#rufus-asin-filter-pill-content"),h=a.querySelector("#rufus-asin-filter-pill-preview-image");a=a.querySelector(".rufus-asin-filter-pill-title");c&&(c.href="");h&&(h.src="");a&&(a.textContent="");b.classList.remove("rufus-asin-filter-shade-show","rufus-asin-filter-shade-hide")}}},{key:"shouldAddRemoveSectionClass",value:function(a,b,
c,f){return(a||b===ua.NILE_ASIN_INGRESS)&&!0===c&&"PlaceholderMessage"!==f}}])}(Ia),Ii=function(){return x(function B(){z(this,B)},null,[{key:"buildPayload",value:function(a,b,c,r,f,g,m,X,p,Da){return{feedbackType:b,conversationId:c+r,turnRequestId:f,gmtTime:g,detailFeedback:m,freeformFeedback:X,mainFeedback:p,turnSessionId:Da,pageContext:this.buildFeedbackPageContext(a)}}},{key:"buildFeedbackPageContext",value:function(a){var b,c,r=a.getPanelViewContext();a=K.getCurrentPageUrl();r=Pa(r.pageType);
var f=null===(b=(c=K.metadataParsers)[r])||void 0===b?void 0:b.call(c,a);return{pageType:r,targetPageType:r,originPageType:r,targetUrl:K.getCurrentPageUrl(),originUrl:a,targetPageMetadata:f,pageMetadata:f,originPageMetadata:f}}}])}(),dd=function(b){function c(a,b,r){var h=3<arguments.length&&void 0!==arguments[3]?arguments[3]:new Set,l=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0;z(this,c);var g=c;var m=(g=v(g),C(this,df()?Reflect.construct(g,[],v(this).constructor):g.apply(this,void 0)));
return m.A=a,m.contextManager=b,m.panelContainer=r,m.checkedIndices=h,m.numberOfCheckBoxChecked=l,m.registerEventHandlers(),m.shouldUseRufusCommonModule=ta.getInstance().isWeblabTreatmentEnabledAndRecordTrigger("RUFUS_ORTELIUS_COMPLETE_DIALUP_1259431")||ta.getInstance().isWeblabTreatmentEnabledAndRecordTrigger("RUFUS_COMMON_ASSETS_MIGRATION_CL_1189218"),m}return N(c,b),x(c,[{key:"registerEventHandlers",value:function(){var a=this;this.A.declarative("rufus-thumbs-up-actions","mouseenter",function(){return a.handleThumbsUpMouseEnter()});
this.A.declarative("rufus-thumbs-up-actions","mouseleave",function(){return a.handleThumbsUpMouseLeave()});this.A.declarative("rufus-thumbs-up-actions","click",function(){return a.handleThumbsUpMouseClick(a.A,a.contextManager)});this.A.declarative("rufus-thumbs-down-actions","mouseenter",function(){return a.handleThumbsDownMouseEnter()});this.A.declarative("rufus-thumbs-down-actions","mouseleave",function(){return a.handleThumbsDownMouseLeave()});this.A.declarative("rufus-thumbs-down-actions","click",
function(){return a.handleThumbsDownMouseClick()});this.A.declarative("rufus-feedback-checkbox-actions","change",function(b){return a.handleCheckboxChange(b)});this.A.declarative("rufus-dismiss-button-actions","click",function(){return a.handleDismissButtonClick(a.A,a.contextManager)});this.A.declarative("rufus-submit-feedback-button-actions","click",function(){return a.handleSubmitButtonClick(a.A,a.contextManager)})}},{key:"handleThumbsUpMouseEnter",value:function(){var a=this.getVotingConfig(),
b=a.thumbsUpArea,c=a.isThumbsUpClicked;a.isThumbsDownClicked||c||this.updateThumbImage(b,"https://m.media-amazon.com/images/G/01/Rufus_Desktop/thumbs_up_hover-0c724742-dd32-471c-b488-94227df26330._CB559205155_._SY200_.png")}},{key:"handleThumbsUpMouseLeave",value:function(){var a=this.getVotingConfig(),b=a.thumbsUpArea,c=a.isThumbsUpClicked;a.isThumbsDownClicked||c||this.updateThumbImage(b,"https://m.media-amazon.com/images/G/01/Rufus_Desktop/thumbs_up-c1ca7881-13d4-4958-8b4c-f97108f6e11d.png")}},
{key:"handleThumbsUpMouseClick",value:function(a,b){var h=this.getVotingConfig(),f=h.thumbsUpArea,l=h.thumbsDownArea,g=h.isThumbsUpClicked;h.isThumbsDownClicked||g||(h=document.getElementById("rufus-feedback-text"),g=document.getElementById("rufus-thumbs-up-feedback-sent-text"),this.updateThumbImage(f,"https://m.media-amazon.com/images/G/01/Rufus_Desktop/thumbs_up_click-9ca6525e-fc19-41b9-b951-5c5f7bcb3f5a._CB559251617_._SY200_.png"),this.hideElement(l),this.hideElement(h),this.showElement(g),this.dispatch("onFeedbackSubmitted",
void 0),this.sendFeedback("MAIN_FEEDBACK","THUMBS_UP",c.EMPTY_FEEDBACK.detailFeedback,c.EMPTY_FEEDBACK.freeFormFeedback,a,c.FEEDBACK_SUCCESS_CALLBACK,c.FEEDBACK_FAILURE_CALLBACK,b),O(G.MAIN_FEEDBACK_REQUEST,ia.THUMBS_UP),m.addCount(p.RUFUS_THUMBSUP_CLICKED,1))}},{key:"handleThumbsDownMouseEnter",value:function(){var a=this.getVotingConfig(),b=a.thumbsDownArea;a.isThumbsDownClicked||this.updateThumbImage(b,"https://m.media-amazon.com/images/G/01/Rufus_Desktop/thumbs_down_hover-43572115-0a37-4aa3-ad4b-6e031a588612._CB559205155_._SY200_.png")}},
{key:"handleThumbsDownMouseLeave",value:function(){var a=this.getVotingConfig(),b=a.thumbsDownArea;a.isThumbsDownClicked||this.updateThumbImage(b,"https://m.media-amazon.com/images/G/01/Rufus_Desktop/thumbs_down-fd26b2f9-143b-468e-9e99-c020f17a6aa0._CB559205155_._SY200_.png")}},{key:"handleThumbsDownMouseClick",value:function(){var a=this.getVotingConfig(),b=a.thumbsDownArea;a.isThumbsDownClicked||(a=document.getElementById("rufus-thumbs-down-feedback-box"),this.updateThumbImage(b,"https://m.media-amazon.com/images/G/01/Rufus_Desktop/thumbs_down_click-a00e7dd1-e695-495e-b9f8-b462ef9adc71._CB559251617_._SY200_.png"),
this.showElement(a),this.scrollIntoViewElementWithId("rufus-thumbs-down-feedback-box"),O(G.MAIN_FEEDBACK_REQUEST,ia.THUMBS_DOWN),m.addCount(p.RUFUS_THUMBSDOWN_CLICKED,1))}},{key:"handleCheckboxChange",value:function(a){var b=a.$target.get(0).name;b=this.getIndexFromCheckboxId(b);a=a.$target.get(0).checked;var c=document.getElementById("rufus-text-area-".concat(b)),h=document.getElementById("rufus-thumbs-down-feedback-box");h=null==h?void 0:h.querySelector('input[name\x3d"rufus-checkbox-'.concat(b,
'"]'));a?this.checkedIndices.add(b):this.checkedIndices.delete(b);this.toggleTextAreaDisplay(c);this.toggleSubmitButton(h)}},{key:"handleDismissButtonClick",value:function(a,b){this.showThumbsDownFeedbackSentText();this.sendFeedback("MAIN_FEEDBACK","THUMBS_DOWN",c.EMPTY_FEEDBACK.detailFeedback,c.EMPTY_FEEDBACK.freeFormFeedback,a,c.FEEDBACK_SUCCESS_CALLBACK,c.FEEDBACK_FAILURE_CALLBACK,b)}},{key:"handleSubmitButtonClick",value:function(a,b){var h=this.extractFeedbackData(),f=h.detailFeedback;h=h.freeFormFeedback;
0<this.checkedIndices.size&&m.addCount(p.RUFUS_FEEDBACK_OPTION_SUBMITTED,1);this.checkedIndices=new Set;this.showThumbsDownFeedbackSentText();this.sendFeedback("DETAIL_FEEDBACK","THUMBS_DOWN",f,h,a,function(){m.widgetBodyEnd(oa.RUFUS_FEEDBACK_LATENCY,!1);m.addCount(p.RUFUS_FEEDBACK_TEXT_SUBMITTED,1)},c.FEEDBACK_FAILURE_CALLBACK,b);O(G.DETAIL_FEEDBACK_REQUEST,ia.THUMBS_DOWN)}},{key:"getVotingConfig",value:function(){var a=document.getElementById("rufus-thumbs-down"),b=document.getElementById("rufus-thumbs-up");
return{thumbsUpArea:b,thumbsDownArea:a,isThumbsDownClicked:a&&"https://m.media-amazon.com/images/G/01/Rufus_Desktop/thumbs_down_click-a00e7dd1-e695-495e-b9f8-b462ef9adc71._CB559251617_._SY200_.png"===a.src,isThumbsUpClicked:b&&"https://m.media-amazon.com/images/G/01/Rufus_Desktop/thumbs_up_click-9ca6525e-fc19-41b9-b951-5c5f7bcb3f5a._CB559251617_._SY200_.png"===b.src}}},{key:"updateThumbImage",value:function(a,b){a&&(a.src=b)}},{key:"hideElement",value:function(a){null==a||a.classList.add("aok-hidden")}},
{key:"showElement",value:function(a){null==a||a.classList.remove("aok-hidden")}},{key:"scrollIntoViewElementWithId",value:function(a){this.dispatch("onThumbsDownClick",a)}},{key:"toggleSubmitButton",value:function(a){a&&a.checked?(0===this.numberOfCheckBoxChecked&&this.enableSubmitButton(),this.numberOfCheckBoxChecked+=1):(1===this.numberOfCheckBoxChecked&&this.disableSubmitButton(),--this.numberOfCheckBoxChecked)}},{key:"enableSubmitButton",value:function(){var a=document.getElementById("rufus-submit-feedback-button"),
b=document.getElementById("rufus-submit-feedback-button-announce");a.classList.remove("a-button-disabled");b.removeAttribute("disabled")}},{key:"disableSubmitButton",value:function(){var a=document.getElementById("rufus-submit-feedback-button"),b=document.getElementById("rufus-submit-feedback-button-announce");a.classList.add("a-button-disabled");b.setAttribute("disabled","disabled")}},{key:"getIndexFromCheckboxId",value:function(a){return a.split("-").pop()||""}},{key:"toggleTextAreaDisplay",value:function(a){a&&
a.classList.toggle("aok-hidden")}},{key:"extractFeedbackData",value:function(){var a,b=[],c="",f=function(a,b){var c="undefined"!=typeof Symbol&&a[Symbol.iterator]||a["@@iterator"];if(!c){if(Array.isArray(a)||(c=function(a,b){if(a){if("string"==typeof a)return cf(a,b);var c={}.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?cf(a,b):void 0}}(a))||b&&a&&"number"==
typeof a.length){c&&(a=c);var h=0;b=function(){};return{s:b,n:function(){return h>=a.length?{done:!0}:{done:!1,value:a[h++]}},e:function(a){throw a;},f:b}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var f,l=!0,r=!1;return{s:function(){c=c.call(a)},n:function(){var a=c.next();return l=a.done,a},e:function(a){r=!0;f=a},f:function(){try{l||null==c.return||c.return()}finally{if(r)throw f;
}}}}(this.checkedIndices);try{for(f.s();!(a=f.n()).done;){var g=a.value,m=document.getElementsByName("rufus-checkbox-".concat(g)),X=null!=m?m[0]:null;X&&""!=X.value.trim()&&b.push(X.value);var p=document.getElementById("rufus-text-area-inner-".concat(g));p&&(c+=p.value)}}catch(Da){f.e(Da)}finally{f.f()}return{detailFeedback:b,freeFormFeedback:c}}},{key:"showThumbsDownFeedbackSentText",value:function(){var a,b=document.getElementById("rufus-thumbs-down-feedback-box"),c=document.getElementById("rufus-thumbs-up"),
f=document.getElementById("rufus-feedback-text"),g=document.getElementById("rufus-thumbs-down-feedback-sent-text");this.numberOfCheckBoxChecked=0;b.remove();null===(a=c.parentElement)||void 0===a||a.remove();this.hideElement(f);this.showElement(g);this.dispatch("onFeedbackSubmitted",void 0)}},{key:"sendFeedback",value:function(b,c,r,f,g,p,X,B){m.widgetBodyBegin(oa.RUFUS_FEEDBACK_LATENCY);var h=qe(),l=h.uxSessionId,F=h.nileRequestId,Z=h.sessionId;h=h.marketplaceId;var Ha=(new Date).toISOString();b=
{method:"POST",params:this.shouldUseRufusCommonModule?Ii.buildPayload(this.panelContainer,b,l,h,F,Ha,r,f,c,Z):{feedbackType:b,conversationId:l+h,turnRequestId:F,gmtTime:Ha,detailFeedback:r,freeformFeedback:f,mainFeedback:c,turnSessionId:Z,pageContext:B.buildFeedbackPageContext()},paramsFormat:"json",contentType:"application/json",success:p,error:X,headers:a({},eb.ANTI_CSRF_TOKEN,Dd())};g.post("".concat("/rufus/cl/","feedback?tabId\x3d").concat(l,"\x26ref\x3d").concat(tb.FEEDBACK),b)}}])}(Ia);a(dd,
"EMPTY_FEEDBACK",{detailFeedback:[],freeFormFeedback:""});a(dd,"FEEDBACK_SUCCESS_CALLBACK",function(){m.widgetBodyEnd(oa.RUFUS_FEEDBACK_LATENCY,!1)});a(dd,"FEEDBACK_FAILURE_CALLBACK",function(){m.widgetBodyEnd(oa.RUFUS_FEEDBACK_LATENCY,!0)});var Vb=function(a){return a.HANDLE_EXPAND="rufus-cl-handle-expand",a.HANDLE_STREAM="rufus-cl-handle-stream",a}({}),Ji=["heroBanner","rufusMarketing"],Ki={heroBanner:{actions:[{name:"HolidayShopRedirect",type:"stream",context:{qis:La.NILE_INGRESS_LINK}},{name:"GetStartedRedirect",
type:"stream",context:{qis:La.NILE_INGRESS_LINK}}]},rufusMarketing:{actions:[{name:"DealsRedirect",type:"stream",context:{qis:La.NILE_INGRESS_LINK}},{name:"GiftingRedirect",type:"stream",context:{qis:La.NILE_INGRESS_LINK}},{name:"CategoryRedirect",type:"stream",context:{qis:La.NILE_INGRESS_LINK}}]}},vg=function(a){a=(new URL(a)).searchParams;var b=a.get("rufus-action"),c=a.get("rufus-client");if(b||c){var l=function(a,b){if(a&&b&&(c=b,Ji.includes(c)))return function(a,b){return Ki[a].actions.find(function(a){return a.name===
b})}(b,a);var c}(b,c);if(l)return{action:b,client:c,query:a.get("rufus-query"),actionConfig:l};a="rufus-action: ".concat(b," is not defined as an available action for rufus-client: \n     ").concat(c," in the CL_EXTERNAL_CLIENT_CONFIGS");m.logErrorWithLevel(H.ERROR,a)}},Li=function(){var a=vg(c.location.href),b=null==a?void 0:a.actionConfig;return!(!a||"stream"!==(null==b?void 0:b.type))&&function(a){var b,c=null==a?void 0:a.actionConfig,h=a.client+"_"+a.action,g={query:null!==(b=a.query)&&void 0!==
b?b:"",qis:null==c?void 0:c.context.qis,metricName:h};ka.when(Vb.HANDLE_STREAM).execute(function(a){a(g)})}(a)},wg=c.location.hostname,Mi=(K.getUrlByDomain(wg,"www.amazon.com"===wg?"Rufus/b?node\x3d121214013011\x26ref_\x3dnl_cl_dsk_faq":""),{OPEN_FAQ:{actions:[{action:"GET_STARTED",payload:void 0}]}}),Ni=function(b){function c(){var b;z(this,c);a(b=function(a,b,c){return b=v(b),C(a,ef()?Reflect.construct(b,[],v(a).constructor):b.apply(a,c))}(this,c),"startPositionY",0);a(b,"handleAutoMinimizeToggleSwitchStateChange",
function(a){ka.when("a-switch").execute(function(b){var c=document.getElementById("rufus-overflow-menu-auto-minimize-toggle");c?b.getSwitch(c).isOn(a):m.logErrorWithLevel(H.ERROR,"Errors happened when auto-minimize toggle switch state changing, toggle switch was not found")})});a(b,"initializeAutoMinimizeToggleSwitchEvents",function(){var a=document.getElementById("rufus-overflow-menu-auto-minimize-toggle");a?(a.addEventListener("click",function(){m.addCount(p.RUFUS_PANEL_OVERFLOW_MENU_AUTO_MINIMIZE,
1);ka.when("a-switch").execute(function(b){b.getSwitch(a).isOn()?O(G.RUFUS_PANEL_OVERFLOW_MENU,ia.AUTO_MINIMIZE_ENABLE):O(G.RUFUS_PANEL_OVERFLOW_MENU,ia.AUTO_MINIMIZE_DISABLE)})}),ka.when("A").execute(function(a){a.on("a:switch:rufus-overflow-menu-auto-minimize-toggle:on",function(){b.dispatch("onAutoMinimizeClick",!0)});a.on("a:switch:rufus-overflow-menu-auto-minimize-toggle:off",function(){b.dispatch("onAutoMinimizeClick",!1)})})):m.logErrorWithLevel(H.ERROR,"Errors happened when auto-minimize toggle switch initialized, toggle switch was not found")});
a(b,"onOptionClicked",function(a){a.forEach(function(a){"GET_STARTED"===a.action?(b.overflowMenuContainer.style.transition="none",b.setElementState(b.overflowMenuContainer,"closed"),O(G.RUFUS_PANEL_OVERFLOW_MENU,ia.GET_STARTED),O(G.RUFUS_PANEL_OVERFLOW_MENU,ia.OVERFLOW_MENU_CLOSE),m.addCount(p.RUFUS_PANEL_OVERFLOW_MENU_GET_STARTED,1),b.dispatch("onGetStartedClicked",void 0)):m.logErrorWithLevel(H.ERROR,"Unsupported action:"+a.action)})});a(b,"overflowButtonClicked",function(a){a.preventDefault();
var c="closed"===b.overflowMenuContainer.getAttribute("data-state")?"open":"closed";b.setElementState(b.overflowMenuContainer,c);b.dispatch("onOverflowMenuStateChange",c);O(G.RUFUS_PANEL_OVERFLOW_MENU,"closed"===c?ia.OVERFLOW_MENU_CLOSE:ia.OVERFLOW_MENU_OPEN);b.handleOverflowMenuOutsideClicked();a.stopPropagation()});a(b,"setElementState",function(a,b){a.setAttribute("data-state",b)});a(b,"mousedown",function(a){a.target!==b.overflowButton&&(a.target===b.overflowMenuContainer||b.overflowMenuContainer.contains(a.target)||
(b.setElementState(b.overflowMenuContainer,"closed"),b.dispatch("onOverflowMenuStateChange","closed")))});a(b,"handleOverflowMenuOutsideClicked",function(){"open"===b.overflowMenuContainer.getAttribute("data-state")?document.body.addEventListener("mousedown",b.mousedown):document.body.removeEventListener("mousedown",b.mousedown)});a(b,"handleMouseenter",function(a){a.preventDefault();b.startPositionY=a.clientY;b.setElementState(b.overflowMenuContainer,"open");document.addEventListener("mousemove",
b.handleMousemove);O(G.RUFUS_PANEL_OVERFLOW_MENU,ia.OVERFLOW_MENU_OPEN)});a(b,"handleMousemove",function(a){a=a.clientY-b.startPositionY;"open"===b.overflowMenuContainer.getAttribute("data-state")&&-5>a&&(b.setElementState(b.overflowMenuContainer,"closed"),document.removeEventListener("mousemove",b.handleMousemove))});var l=new Zc;b.overflowButton=l.getElementOrRecordMissing("rufus-panel-header-overflow-button");b.overflowChervon=l.getElementOrRecordMissing("rufus-panel-header-overflow");b.overflowMenuContainer=
l.getElementOrRecordMissing("rufus-overflow-menu-container");b.overflowMenuInnerOptions=l.getElementOrRecordMissing("rufus-overflow-menu-container-webapp");l=l.getMissingElements();return 0<l.length?(l="[OverflowMenu] Errors happened when overflow menu initialized, Rufus element IDs were not found: "+l.join(", "),m.logErrorWithLevel(H.ERROR,l),C(b)):(b.initialize(),b)}return N(c,b),x(c,[{key:"renderOverflowMenu",value:function(){this.overflowMenuContainer.innerHTML=this.overflowMenuInnerOptions.innerHTML;
this.overflowMenuInnerOptions.innerHTML=""}},{key:"initialize",value:function(){this.renderOverflowMenu();this.bindOptionActions();this.overflowButton.addEventListener("click",this.overflowButtonClicked);this.overflowChervon.addEventListener("mouseenter",this.handleMouseenter);this.initializeAutoMinimizeToggleSwitchEvents()}},{key:"bindOptionActions",value:function(){var a=document.getElementById("rufus-overflow-menu-option-container-faq");a?(a.addEventListener("click",function(a){a.stopPropagation()}),
a.addEventListener("click",this.onOptionClicked.bind(this,Mi.OPEN_FAQ.actions))):m.logErrorWithLevel(H.ERROR,"Errors happened when bind option actions, overflow menu faq option container not found")}}])}(Ia),Oa=function(a){function b(){z(this,b);var a=b;var c=(a=v(a),C(this,ff()?Reflect.construct(a,[],v(this).constructor):a.apply(this,void 0)));return c.currentSearchFilterContext=null,c}return N(b,a),x(b,[{key:"setSearchFilterContext",value:function(a){var b;(null===(b=this.currentSearchFilterContext)||
void 0===b?void 0:b.asinId)!==(null==a?void 0:a.asinId)&&(this.currentSearchFilterContext&&m.addCount(p.RASIN_CONVERSATION_REFINEMENT_SWAPPED,1),this.currentSearchFilterContext=a,this.dispatch("contextUpdated",this.currentSearchFilterContext),null===a?(O(G.CONVERSATION_REFINEMENT_CLEARED,ia.ASIN_REFINEMENT),m.addCount(p.RASIN_CONVERSATION_REFINEMENT_CLEARED,1)):(O(G.CONVERSATION_REFINEMENT_SET,ia.ASIN_REFINEMENT),m.addCount(p.RASIN_CONVERSATION_REFINEMENT_SET,1)))}},{key:"getSearchFilterContext",
value:function(){return this.currentSearchFilterContext}}],[{key:"getInstance",value:function(){return b.instance||(b.instance=new b),b.instance}}])}(Ia),Oi=function(b){function g(b){var h,f,l,Z;z(this,g);a(f=function(a,b,c){return b=v(b),C(a,hf()?Reflect.construct(b,[],v(a).constructor):b.apply(a,c))}(this,g),"startPositionY",0);a(f,"startPositionX",0);a(f,"newHeight",0);a(f,"newWidth",0);a(f,"showAnimationRunning",!1);a(f,"closeAnimationRunning",!1);a(f,"panelInFocus",!1);a(f,"closeRufusPanelLabel",
"");a(f,"openRufusPanelLabel","");a(f,"isPanelClosed",function(){return"closed"===f.currentState});a(f,"isPanelExpanded",function(){return"expanded"===f.currentState});a(f,"applyAnimationAndStateUpdateWithDefault",function(a){var b;if(a){var c=null===(b=f.getPanelContainerState())||void 0===b?void 0:b.viewState;c&&f.applyAnimationAndStateUpdate(c,a)}});a(f,"updateStateAndContent",function(){var a,b=fc.panel.key;try{if(a=sessionStorage.getItem(b)){var c=a&&JSON.parse(a);c.content&&(f.rufusPanelContent.innerHTML=
c.content);c.state&&f.updatePanelStateOnNavigationBack(c.state)}}catch(nd){m.logErrorWithLevelWithException(H.ERROR,nd,"".concat("RufusPanelContainer"," - Error reading from ").concat(b," ").concat(nd instanceof Error?"(".concat(nd.message,")"):""))}});a(f,"updatePanelStateOnNavigationBack",function(a){f.dispatch("onPanelContainerStateChange",a);f.updatePanelViewStateOnNavigationBack(a);f.resizePanelOnNavigationBack(a)});a(f,"handleNavigateFromTeaserCX",function(a){m.addCount(p.RUFUS_RECOVERY_TEASER_CX_CLICK,
1);var b=f.getPanelContainerState().viewState;if("closed"===b||"minimized"===b){var c=f.getPanelViewContext();c.keyword=a;c.qis=La.NILE_TEASER_CX_RECOVERY;f.setPanelViewContext(c);f.applyAnimationAndStateUpdate(b,"expanded");m.addCount(p.RUFUS_RECOVERY_TEASER_CX_OPEN_PANEL,1)}});a(f,"applyAnimationAndStateUpdate",function(a,b,c,h){a===b||f.closeAnimationRunning||(f.A.trigger("rufus-panel-state-change",a,b),f.resetRufusFlyoutDivClassName(),f.applyPanelAnimation(a,b)&&f.handlePanelStateUpdate(b,c,h))});
a(f,"isShowAnimationRunning",function(){return f.showAnimationRunning});a(f,"setPanelViewContext",function(a){f.rufusPanelViewContext.value=JSON.stringify(a)});a(f,"updatePanelState",function(a,b){var c=f.currentState;c=c?"".concat(c,"_to_").concat(a):a;O(b?G.PANEL_RESIZE_RUFUS:G.PANEL_RESIZE,c);f.currentState=a;f.rufusFlyoutDiv.setAttribute("data-state",a);f.rufusButton.setAttribute("data-state",a);f.rufusButton.setAttribute("aria-label","expanded"===a?f.closeRufusPanelLabel:f.openRufusPanelLabel);
f.panelInFocus="expanded"===f.currentState;f.logPanelFocusMetrics();m.addCount(p.RUFUS_PANEL_STATE_PREFIX+f.currentState.toUpperCase(),1);f.onPanelContainerStateChange();"expanded"===a&&f.updateRQPillsWidth(gf())});a(f,"bindActions",function(){f.navbar&&f.rufusButton&&f.rufusFlyoutDiv&&f.rufusPanelMinimizeButton&&f.rufusPanelCloseButton&&f.rufusPanelHeader&&f.rufusPanelViewContext?(f.rufusButton.addEventListener("click",f.handleIngressClick),f.rufusPanelHeader.addEventListener("click",f.handlePanelHeaderClick),
f.rufusPanelMinimizeButton.addEventListener("click",f.handlePanelMinimizeClick),f.rufusPanelCloseButton.addEventListener("click",f.handlePanelCloseClick),f.rufusPanelResizeHandleTop&&f.rufusPanelResizeHandleRight&&f.rufusPanelResizeHandleTopRight&&f.rufusPanelGrabber?(f.rufusPanelResizeHandleTop.addEventListener("mousedown",f.mousedownHandler),f.rufusPanelResizeHandleRight.addEventListener("mousedown",f.mousedownHandler),f.rufusPanelResizeHandleTopRight.addEventListener("mousedown",f.mousedownHandler),
f.rufusPanelGrabber.addEventListener("mousedown",f.mousedownHandler),f.rufusFlyoutDiv.addEventListener("dragstart",f.dragstart),c.addEventListener("resize",function(){f.rufusFlyoutDiv.classList.add("rufus-no-transition");var a=f.rufusFlyoutDiv.offsetTop,b=f.navbar.offsetTop+f.navbar.offsetHeight+12;a<b&&(f.newHeight=Math.max(f.newHeight-(b-a),360),f.rufusFlyoutDiv.style.setProperty("--expanded-container-height",f.newHeight+"px"))}),c.addEventListener("click",function(a){var b=document.querySelector("#nav-rufus-content .rufus-container"),
c=a.target;b&&b.contains(a.target)?f.panelInFocus||(f.panelInFocus=!0,f.logPanelFocusMetrics()):f.panelInFocus&&!["rufus-panel-header-minimize","rufus-panel-header-close","nav-rufus-disco-avatar","nav-rufus-disco-text","nav-rufus-disco"].includes(c.id)&&(f.panelInFocus=!1,f.logPanelFocusMetrics())}),c.P&&ka.when("navbarJSLoaded").execute(function(){c.$Nav&&c.$Nav.getNow("cover")&&(c.$Nav.getNow("cover").isVisible()?f.hideRufusPanel():f.showRufusPanel(),c.$Nav.getNow("cover").onShow(function(){return f.hideRufusPanel()}),
c.$Nav.getNow("cover").onHide(function(){return f.showRufusPanel()}))})):m.logErrorWithLevel(H.ERROR,"Error binding resize actions in PanelContainer, resize div in Rufus card is missing")):m.logErrorWithLevel(H.ERROR,"Error binding actions in PanelContainer, some div in Rufus card is missing")});a(f,"hideRufusPanel",function(){f.rufusFlyoutDiv.style.zIndex=String(Number(c.getComputedStyle(f.navbar).zIndex)-3)});a(f,"showRufusPanel",function(){f.rufusFlyoutDiv.style.zIndex=""});a(f,"resizePanelOnNavigationBack",
function(a){f.newHeight=a.height;f.newWidth=a.width;f.rufusFlyoutDiv.style.setProperty("--expanded-container-height",f.newHeight+"px");f.rufusFlyoutDiv.style.setProperty("--expanded-container-width",f.newWidth+"px")});a(f,"updatePanelViewStateOnNavigationBack",function(a){f.applyAnimationAndStateUpdate(f.currentState,a.autoMinimize&&"closed"!=a.viewState?"minimized":a.viewState);f.dispatch("onAutoMinimizeToggleSwitchStateChange",a.autoMinimize)});a(f,"resetRufusFlyoutDivClassName",function(){f.rufusFlyoutDiv.className=
"rufus-panel-container"});a(f,"handlePanelStateUpdate",function(a,b,c){"closed"===a?(f.closeAnimationRunning=!0,f.addAnimationEndListener(function(){return f.onHideAnimationEnd(a,b,c)})):(f.showAnimationRunning=!0,f.addAnimationEndListener(function(){return f.onShowAnimationEnd(a)}),f.updatePanelState(a,b))});a(f,"addAnimationEndListener",function(a){f.rufusFlyoutDiv.addEventListener("animationend",a,{once:!0})});a(f,"onHideAnimationEnd",function(a,b,c){var h,l;f.updatePanelState(a,b);null===(null===
(h=Oa.getInstance())||void 0===h?void 0:h.getSearchFilterContext())||null!==(l=Oa.getInstance())&&void 0!==l&&l.setSearchFilterContext(null);f.closeAnimationRunning=!1;null!=c&&c||f.updateTruncateState(a);f.dispatch("onPanelAnimationEnd",a)});a(f,"onShowAnimationEnd",function(a){f.showAnimationRunning=!1;f.dispatch("onPanelAnimationEnd",a);"expanded"===a&&f.updateScrollButtonVisibility()});a(f,"handleIngressClick",function(){f.applyAnimationAndStateUpdate(f.currentState,"expanded"!==f.currentState?
"expanded":"closed")});a(f,"handlePanelCloseClick",function(a){switch(f.applyAnimationAndStateUpdate(f.currentState,"closed",void 0,void 0),f.getPanelContainerState().viewState){case "expanded":m.addCount(p.RUFUS_CLOSE_CLICK_FROM_EXPANDED,1);O(G.PANEL_CLOSE_CLICK);break;case "minimized":m.addCount(p.RUFUS_CLOSE_CLICK_FROM_MINIMIZED,1),O(G.PANEL_CLOSE_CLICK)}a.stopPropagation()});a(f,"handlePanelHeaderClick",function(){"minimized"===f.currentState&&(f.applyAnimationAndStateUpdate(f.currentState,"expanded"),
O(G.PANEL_EXPAND_CLICK))});a(f,"handlePanelMinimizeClick",function(a){var b="minimized"===f.currentState,c=b?"expanded":"minimized";O(b?G.PANEL_EXPAND_CLICK:G.PANEL_MINIMIZE_CLICK);f.applyAnimationAndStateUpdate(f.currentState,c,!1,!0);a.stopPropagation()});a(f,"disableTextSelection",function(a){a.preventDefault()});a(f,"mousedownHandler",function(a){if(0===a.button&&"expanded"===f.currentState){var b=a.target;f.startPositionY=a.clientY;f.startPositionX=a.clientX;"BUTTON"!==b.tagName&&(document.addEventListener("selectstart",
f.disableTextSelection),b===f.rufusPanelResizeHandleTopRight?(document.addEventListener("mousemove",f.mousemoveHeight),document.addEventListener("mousemove",f.mousemoveWidth),document.addEventListener("mouseup",f.mouseupHandler),f.rufusPanelResizeHandleTop.style.cursor="nesw-resize",f.rufusPanelResizeHandleRight.style.cursor="nesw-resize"):b===f.rufusPanelResizeHandleTop||b===f.rufusPanelGrabber?(document.addEventListener("mousemove",f.mousemoveHeight),document.addEventListener("mouseup",f.mouseupHandler),
f.rufusPanelResizeHandleTopRight.style.cursor="ns-resize",f.rufusPanelResizeHandleRight.style.cursor="ns-resize"):b===f.rufusPanelResizeHandleRight&&(document.addEventListener("mousemove",f.mousemoveWidth),document.addEventListener("mouseup",f.mouseupHandler),f.rufusPanelResizeHandleTopRight.style.cursor="ew-resize",f.rufusPanelResizeHandleTop.style.cursor="ew-resize"))}});a(f,"mousemoveHeight",function(a){f.rufusFlyoutDiv.style.transition="none";var b=a.clientY-f.startPositionY;f.rufusFlyoutDiv.offsetTop+
b<=f.navbar.offsetTop+f.navbar.offsetHeight+12||(f.newHeight=f.rufusFlyoutDiv.clientHeight-b,f.newHeight=Math.max(f.newHeight,360),f.rufusFlyoutDiv.style.setProperty("--expanded-container-height",f.newHeight+"px"),360==f.newHeight&&a.clientY>f.startPositionY||(f.startPositionY=a.clientY))});a(f,"mousemoveWidth",function(a){f.rufusFlyoutDiv.style.transition="none";f.newWidth=f.rufusFlyoutDiv.clientWidth-(f.startPositionX-a.clientX);f.newWidth=Math.max(f.newWidth,290);f.newWidth=Math.min(f.newWidth,
400);var b=400<=f.newWidth&&a.clientX>f.startPositionX,c=290>=f.newWidth&&a.clientX<f.startPositionX;f.rufusFlyoutDiv.style.setProperty("--expanded-container-width",f.newWidth+"px");b||c||(f.startPositionX=a.clientX,f.debouncedUpdateRQPillsWidth())});a(f,"mouseupHandler",function(){f.rufusFlyoutDiv.style.transition=f.rufusPanelTransition;f.rufusPanelResizeHandleTopRight.style.cursor="nesw-resize";f.rufusPanelResizeHandleTop.style.cursor="ns-resize";f.rufusPanelResizeHandleRight.style.cursor="ew-resize";
f.onPanelContainerStateChange();f.updateScrollButtonVisibility();document.removeEventListener("mousemove",f.mousemoveHeight);document.removeEventListener("mousemove",f.mousemoveWidth);document.removeEventListener("mouseup",f.mouseupHandler);document.removeEventListener("selectstart",f.disableTextSelection)});a(f,"dragstart",function(){f.mouseupHandler()});a(f,"onPanelContainerStateChange",function(){f.dispatch("onPanelContainerStateChange",f.getPanelContainerState())});a(f,"updateScrollButtonVisibility",
function(){f.dispatch("updateScrollButtonVisibility",void 0)});a(f,"mapBottomSheetSizeToPanelState",function(a){return"expanded"!==a?f.getPanelContainerState().viewState:a});a(f,"updateRQPillsWidth",function(a){document.querySelectorAll("button.rufus-pill key, button.rufus-web-pill key").forEach(function(b){return Af(b,a)})});a(f,"debouncedUpdateRQPillsWidth",(l=f.updateRQPillsWidth,Z=null,function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];clearTimeout(Z);Z=setTimeout(function(){l.apply(f,
b)},100)}));f.A=b;f.navbar=document.getElementById("navbar");f.rufusFlyoutDiv=document.getElementById("nav-flyout-rufus");f.rufusPanelContent=document.getElementById("nav-rufus-content");f.rufusButton=document.getElementById("nav-rufus-disco");f.rufusPanelMinimizeButton=document.getElementById("rufus-panel-header-minimize");f.rufusPanelCloseButton=document.getElementById("rufus-panel-header-close");f.rufusPanelHeader=document.getElementsByClassName("rufus-panel-header-container")[0];f.rufusPanelGrabber=
document.getElementById("rufus-panel-header-grabber-row");f.rufusPanelViewContext=document.getElementById("rufus-view-context");f.rufusPanelResizeHandleTop=document.getElementById("rufus-panel-resize-handle-top");f.rufusPanelResizeHandleRight=document.getElementById("rufus-panel-resize-handle-right");f.rufusPanelResizeHandleTopRight=document.getElementById("rufus-panel-resize-handle-top-right");f.currentState=null===(h=f.rufusFlyoutDiv)||void 0===h?void 0:h.getAttribute("data-state");b=f.rufusFlyoutDiv.style.getPropertyValue("--expanded-container-height");
h=f.rufusFlyoutDiv.style.getPropertyValue("--expanded-container-width");f.newHeight=b?parseInt(b):0;f.newWidth=h?parseInt(h):0;f.rufusPanelTransition=f.rufusFlyoutDiv.style.transition;f.panelInFocus=f.currentState&&"expanded"===f.currentState;f.panelInFocus&&f.logPanelFocusMetrics();f.bindActions();b=f.getPanelViewContext().panelStateOnIngressClick;return b&&("expanded"===b?O(G.RUFUS_OPEN,ia.RUFUS_ICON_TAP):"closed"===b&&O(G.RUFUS_CLOSE,ia.RUFUS_ICON_TAP)),m.addCount(p.RUFUS_PANEL_CONTAINER_INSTANTIATED,
1),f.recordWeblabIfNotAlreadyRecorded("RUFUS_DESKTOP_VISUAL_BRANDING_UPDATE_1201601","rufus_visual_branding_recorded"),f.recordWeblabIfNotAlreadyRecorded("NAV_RUFUS_DESKTOP_NEW_LOGO_1214746","rufus_new_logo_recorded"),f.initializeAccessibilityLabels(),f}return N(g,b),x(g,[{key:"getPanelContainerState",value:function(){return{height:this.newHeight,width:this.newWidth,viewState:this.currentState}}},{key:"getPanelViewContext",value:function(){try{var a=JSON.parse(this.rufusPanelViewContext.value)}catch(r){console.error("".concat("RufusPanelContainer",
" - Error parsing viewContext ").concat(this.rufusPanelViewContext.value," ").concat(r instanceof Error?"(".concat(r.message,")"):""))}return{pageType:a.pageType,keyword:a.keyword?a.keyword:"",asin:a.asin?a.asin:"",qis:a.qis?a.qis:"",metadata:a.metadata?a.metadata:"",panelStateOnIngressClick:a.panelStateOnIngressClick?a.panelStateOnIngressClick:""}}},{key:"handlePanelContainerViewStateUpdateWithCXZen",value:function(a){a=this.mapBottomSheetSizeToPanelState(a);this.applyAnimationAndStateUpdate(this.getPanelContainerState().viewState,
a,!0);m.addCount(p.RUFUS_PANEL_EXPANDED_BY_CX_ZEN,1)}},{key:"handleOverflowMenuStateChange",value:function(a){"open"===a?this.rufusFlyoutDiv.classList.add("rufus-panel-container-persistent-hover"):this.rufusFlyoutDiv.classList.remove("rufus-panel-container-persistent-hover")}},{key:"updateTruncateState",value:function(a){"expanded"===a&&(document.querySelectorAll("#rufus-conversation-container-inner .rufus-category-card-title .a-truncate").forEach(function(a){a.setAttribute("data-a-manual-update",
"true")}),c.P.when("A","a-truncate").execute(function(a,b){b.manualTruncate("#rufus-conversation-container-inner .rufus-category-card-title");b.switchToAutoTruncate("#rufus-conversation-container-inner .rufus-category-card-title")}))}},{key:"logPanelFocusMetrics",value:function(){this.panelInFocus?(m.addCount(p.RUFUS_PANEL_INFOCUS,1),O(p.RUFUS_PANEL_INFOCUS)):(m.addCount(p.RUFUS_PANEL_OUTFOCUS,1),O(p.RUFUS_PANEL_OUTFOCUS))}},{key:"applyPanelAnimation",value:function(a,b){a="".concat(a,"_").concat(b);
b=kh.get(a)||"";return""===b?(m.logErrorWithLevel(H.ERROR,"Error adding animation to panel due to invalid transitionKey: ".concat(a,", animationClass should not be empty")),!1):(this.rufusFlyoutDiv.classList.add(b),!0)}},{key:"recordWeblabIfNotAlreadyRecorded",value:function(a,b){if(!sessionStorage.getItem(b)){var c=ta.getInstance().getWeblabTreatment(a);c&&(m.recordTrigger(a,c),sessionStorage.setItem(b,"true"))}}},{key:"initializeAccessibilityLabels",value:(h=A(P().mark(function r(){var a,b;return P().wrap(function(c){for(;;)switch(c.prev=
c.next){case 0:return c.prev=0,c.next=1,zd(document.documentElement.lang);case 1:a=c.sent;this.closeRufusPanelLabel=a.getMessage("rufus_panel_close");this.openRufusPanelLabel=a.getMessage("rufus_panel_open");c.next=3;break;case 2:c.prev=2,b=c.catch(0),m.logErrorWithLevel(H.ERROR,"Error initializing accessibility labels: ".concat(b instanceof Error?b.message:"")),this.closeRufusPanelLabel="Close Rufus panel",this.openRufusPanelLabel="Open Rufus panel";case 3:case "end":return c.stop()}},r,this,[[0,
2]])})),function(){return h.apply(this,arguments)})}]);var h}(Ia),Pi=function(){return x(function h(b){z(this,h);a(this,"RUFUS_PANEL_IMAGE_MODAL_IMAGE",".rufus-panel-image-modal-image");a(this,"IMAGE_POPOVER_NAME","image-popover");a(this,"RUFUS_PANEL_IMAGE_MODAL_CLOSE_WRAPPER",".rufus-panel-image-modal-close-wrapper");a(this,"POPOVER_CLOSE_DATA_MODEL","data-a-popover-close");this.A=b;this.initialize()},[{key:"initialize",value:function(){this.registerOnImagePopoverShow(this.A)}},{key:"registerOnImagePopoverShow",
value:function(a){var b=this;a.on("a:popover:show:"+this.IMAGE_POPOVER_NAME,function(a){m.addCount(p.RUFUS_MULTIMODAL_POPOVER_SHOWN,1);a=a.popover.getContent();var c=a.find(b.RUFUS_PANEL_IMAGE_MODAL_IMAGE)[0];a=a.find(b.RUFUS_PANEL_IMAGE_MODAL_CLOSE_WRAPPER)[0];b.handleDismissButton(a);c.src.includes("_SL")&&(c.onload=function(){m.widgetBodyEnd(oa.RUFUS_HIGH_RESOLUTION_IMAGE_LOADED_LATENCY);m.widgetBodyBegin(oa.RUFUS_HIGH_RESOLUTION_IMAGE_RENDERED_LATENCY);c.decode().then(function(){m.widgetBodyEnd(oa.RUFUS_HIGH_RESOLUTION_IMAGE_RENDERED_LATENCY)})},
c.src=function(a){var b=a.split(".");if(2<=b.length&&a.includes("_SL")&&a.includes("m.media-amazon.com")){var c=b[b.length-1];return a.replace("".concat(b[b.length-2],".").concat(c),c)}return m.logErrorWithLevel(H.ERROR,"Image has a non-media central url or is not low res url."),a}(c.src),m.widgetBodyBegin(oa.RUFUS_HIGH_RESOLUTION_IMAGE_LOADED_LATENCY),c.onerror=function(a){tg("HIGH","RENDER",a.toString())})})}},{key:"handleDismissButton",value:function(a){var b=this;a.addEventListener("click",function(){m.addCount(p.RUFUS_MULTIMODAL_DISMISS_BUTTON_CLICKED,
1);var c=a.parentElement.getAttribute(b.POPOVER_CLOSE_DATA_MODEL);if(null!=c){var h,f;c=null!==(h=null===(f=JSON.parse(c))||void 0===f?void 0:f.actionId)&&void 0!==h?h:"";O(G.CLOSE_MEDIA,c)}})}}])}(),Qi=function(b){function g(){var b;return z(this,g),a(b=function(a,b,c){return b=v(b),C(a,jf()?Reflect.construct(b,[],v(a).constructor):b.apply(a,c))}(this,g),"isComposing",!1),a(b,"setFocus",function(){b.elements.textArea.focus()}),a(b,"handleCompositionStart",function(){b.isComposing=!0}),a(b,"handleCompositionEnd",
function(){b.isComposing=!1}),a(b,"handleInput",function(){b.adjustTextAreaHeight();b.isInputEmpty()?(O(G.INPUT_TEXT_ERASE),b.elements.submitButton.classList.add("aok-hidden")):b.elements.submitButton.classList.remove("aok-hidden")}),a(b,"adjustTextAreaHeight",function(){var a=c.getComputedStyle(b.elements.textArea),h=parseFloat(a.paddingTop),f=parseFloat(a.paddingBottom),g=parseFloat(a.lineHeight);b.elements.textArea.style.height="auto";b.elements.textArea.rows=1;a=b.elements.textArea.scrollHeight;
h=4*g+(h+f);a>h?(b.elements.scrollButton.style.bottom="".concat(h+26,"px"),b.elements.textArea.style.overflowY="auto",b.elements.textArea.style.height="".concat(h,"px"),b.elements.textArea.scrollTop=b.elements.textArea.scrollHeight):(b.elements.scrollButton.style.bottom="".concat(a+26,"px"),b.elements.textArea.style.overflowY="hidden",b.elements.textArea.style.height="".concat(a,"px"));b.elements.submitButtonContainer.style.paddingRight="".concat(b.elements.textArea.offsetWidth-b.elements.textArea.clientWidth+
20,"px")}),a(b,"handleKeyDown",function(a){"Enter"!==a.key||a.shiftKey||b.isIMEComposing(a)||(a.preventDefault(),m.addCount(p.RUFUS_ENTER_PRESSED_ON_INPUT_TEXT,1),b.onQuery())}),a(b,"handleSubmitMouseUp",function(){b.elements.submitButton.classList.remove("clicked")}),a(b,"handleSubmitMouseDown",function(){b.elements.submitButton.classList.add("clicked")}),a(b,"submitButtonClicked",function(){m.addCount(p.RUFUS_SUBMIT_ON_INPUT_TEXT,1);b.onQuery()}),a(b,"onQuery",function(){b.isInputEmpty()||(O(G.INPUT_TEXT_TRIGGER),
b.dispatch("onQuery",{query:b.elements.textArea.value}),b.reset(),b.adjustTextAreaHeight())}),a(b,"logTextFocus",function(){O(G.INPUT_TEXT_FOCUS)}),a(b,"isInputEmpty",function(){return""===b.elements.textArea.value.trim()}),a(b,"reset",function(){b.elements.textArea.value="";b.elements.submitButton.classList.add("aok-hidden")}),b.elements=b.readHtmlElementsFromDom(),b.reset(),b.attachEventListeners(),b}return N(g,b),x(g,[{key:"refreshOnBfCacheNavigation",value:function(){Object.assign(this.elements,
this.readHtmlElementsFromDom());this.attachEventListeners()}},{key:"readHtmlElementsFromDom",value:function(){var a,b=document.querySelector(".nav-rufus-content");return{textArea:document.getElementById("rufus-text-area"),submitButton:document.getElementById("rufus-submit-button"),scrollButton:document.getElementById("rufus-scroll-button"),submitButtonContainer:null!==(a=null==b?void 0:b.querySelector(".rufus-submit-icon-container"))&&void 0!==a?a:null==b?void 0:b.querySelector(".rufus-web-submit-icon-container")}}},
{key:"attachEventListeners",value:function(){this.elements.textArea.addEventListener("keydown",this.handleKeyDown);this.elements.textArea.addEventListener("input",this.handleInput);this.elements.textArea.addEventListener("click",this.logTextFocus);this.elements.textArea.addEventListener("compositionstart",this.handleCompositionStart);this.elements.textArea.addEventListener("compositionend",this.handleCompositionEnd);this.elements.submitButton.addEventListener("click",this.submitButtonClicked);this.elements.submitButton.addEventListener("mousedown",
this.handleSubmitMouseDown);this.elements.submitButton.addEventListener("mouseup",this.handleSubmitMouseUp);this.elements.submitButton.addEventListener("mouseleave",this.handleSubmitMouseUp)}},{key:"isIMEComposing",value:function(a){return a.isComposing||229===a.keyCode||this.isComposing}}])}(Ia),oe=function(a){return a.ShouldDelayThickClientInitialization="shouldDelayThickClientInitialization",a.ShouldDelayThickClientInitialStreaming="shouldDelayThickClientInitialStreaming",a}({}),hb=x(function B(){z(this,
B)});a(hb,"RASIN_WIDGET_NAME","RufusAsinIngressButton");a(hb,"RASIN_WIDGET_TYPE","AsinFaceoutComponent");a(hb,"RASIN_WIDGET_LOCATION","actions-recipe");a(hb,"RASIN_FEATURE_NAME","rasin");var xg=function(){function a(){z(this,a)}return x(a,[{key:"buildEnhancedContext",value:function(a){var b,c,f,h=Oa.getInstance().getSearchFilterContext();return h?(this.logRasinQisMetric(null==a||null===(b=a.queryContext)||void 0===b?void 0:b.qis),cb(cb({},a),{},{queryContext:this.buildQueryContext(a.queryContext,
h),pageContext:this.buildPageContext(a.pageContext,h,(null==a||null===(c=a.queryContext)||void 0===c?void 0:c.actionType)===U.ASIN_CLICK),metaDataMap:this.buildMetaDataMap(null==a||null===(f=a.queryContext)||void 0===f?void 0:f.actionType)})):a}},{key:"buildQueryContext",value:function(a,b){if(void 0!==a)return(null==a?void 0:a.actionType)===U.ASIN_CLICK?cb(cb({},a),{},{actionType:U.ASIN_CLICK,clickedAsinId:b.asinId,query:"",qis:ua.NILE_ASIN_INGRESS}):cb(cb({},a),{},{actionType:U.SEARCH,query:null==
a?void 0:a.query,qis:null==a?void 0:a.qis})}},{key:"buildPageContext",value:function(a,b,c){if(void 0!==a){var f=[{type:"ASIN",value:b.asinId}],h=K.extractBaseUrl(a.targetUrl);c=c?"?ref_\x3d".concat(tb.RASIN_INGRESS_BUTTON_CLICK):"";b="".concat(h,"/dp/").concat(b.asinId).concat(c);return cb(cb({},a),{},{pageType:xa.DETAIL_PAGE,targetPageType:xa.DETAIL_PAGE,originPageType:null==a?void 0:a.originPageType,targetUrl:b,pageMetadata:f,targetPageMetadata:f,originPageMetadata:f})}}},{key:"buildMetaDataMap",
value:function(a){if(a)return{rawOriginPageType:xa.SEARCH_RESULTS,rawTargetPageType:xa.SEARCH_RESULTS,widgetName:hb.RASIN_WIDGET_NAME,widgetType:hb.RASIN_WIDGET_TYPE,widgetLocation:hb.RASIN_WIDGET_LOCATION,refmarker:a===U.ASIN_CLICK?tb.RASIN_INGRESS_BUTTON_CLICK:"",featureName:hb.RASIN_FEATURE_NAME}}},{key:"logRasinQisMetric",value:function(a){if(a&&Object.values(ua).includes(a))switch(a){case ua.NILE_CL_TEXT_INPUT:m.addCount(p.RASIN_CL_INPUT_QUERY,1);break;case ua.NILE_RELATED_QUESTION:case ua.NILE_DEALS_RELATED_QUESTION:case ua.NILE_NDSWDCS_RELATED_QUESTION:m.addCount(p.RASIN_RQ_PILL_CLICK,
1)}}}],[{key:"getInstance",value:function(){return this.instance||(this.instance=new a),this.instance}}])}(),Ri=function(){return x(function h(){z(this,h)},null,[{key:"buildContext",value:function(a,b,c,f,g,m,p,t,v,x){var h=this.buildQueryContext(f,g,m,t,v,10<arguments.length&&void 0!==arguments[10]?arguments[10]:"");h={queryContext:h,pageContext:this.buildPageContext(a,c,f,h.query,p,x,t),bottomSheetContext:this.buildBottomSheetContext(b,c,f),impressionsContext:this.buildImpressionsContext(a,g,p),
requestCancellationTokens:this.buildRequestCancellationTokens(a),isDebug:"n"};return Oa.getInstance().getSearchFilterContext()?xg.getInstance().buildEnhancedContext(h):h}},{key:"buildQueryContext",value:function(a,b,c,f,g){var h,l,r,F=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"",t=K.extractQueryFromUrl(K.getCurrentPageUrl());return void 0!==(h=f&&Object.values(La).includes(f)?b||g:b||t||F)&&500<(null===(l=h)||void 0===l?void 0:l.length)&&(m.addCount(p.INPUT_QUERY_MAX_LIMIT_REACHED,1),
h=null===(r=h)||void 0===r?void 0:r.slice(0,500)),{query:h,actionType:a,qis:f||this.getQueryInputSourceByActionType(a,b),clickedAsinId:c}}},{key:"buildPageContext",value:function(a,b,c,f,g,m,p){var h,l,r,F,Z=b.getPanelViewContext(),t=a.getPanelState();a=K.getCurrentPageUrl();m=K.setReftagAndQisInTargetUrl(a,null==m?void 0:m.url);b=K.getOriginUrl();Z=Pa(Z.pageType);f=Z!==xa.SEARCH_RESULTS||f?Z:xa.UNKNOWN;t=Pa(b&&null!=t&&t.originPageType?t.originPageType:"");Z=null===(h=(l=K.metadataParsers)[f])||
void 0===h?void 0:h.call(l,a);h=null===(r=(F=K.metadataParsers)[t])||void 0===r?void 0:r.call(F,b);c=this.isNavigationQuery(c,g,p);return{pageType:f,targetPageType:f,originPageType:c?t:f,targetUrl:m,originUrl:c?b:a,targetPageMetadata:Z,pageMetadata:Z,originPageMetadata:c?h:Z}}},{key:"buildBottomSheetContext",value:function(a,b,c){b=b.getPanelContainerState();return{bottomSheetEmpty:""===a.getActiveConversationContainerContent().trim()&&c===U.SWIPE_UP,previousTurnsBottomSheetSize:this.mapPanelViewStateToBottomSheetSize(b.viewState)}}},
{key:"buildImpressionsContext",value:function(a,b,c){var f={},h=fa("impressionsContextKey");h&&(f.IMPRESSIONS_CONTEXT_KEY=h);b=b&&0<b.length&&!c;return(a.hasCustomerSeenFTUX()||b)&&(a.markCustomerSeenFTUX(),f[tf.FIRST_TIME_USER_MESSAGE_SEEN_STATUS]=uf.SEEN),f}},{key:"buildRequestCancellationTokens",value:function(a){var b;if(a=null===(b=a.getPanelState())||void 0===b?void 0:b.requestContext)return[a]}},{key:"getQueryInputSourceByActionType",value:function(a,b){switch(a){case U.SEARCH:return b&&0<
b.length?ua.NILE_CL_TEXT_INPUT:K.extractQis(K.getCurrentPageUrl());case U.SWIPE_UP:return K.extractQis(K.getCurrentPageUrl())}}},{key:"mapPanelViewStateToBottomSheetSize",value:function(a){switch(a){case "closed":return sb.HIDDEN;case "minimized":return sb.COLLAPSED;case "expanded":return sb.EXPANDED}}},{key:"isNavigationQuery",value:function(a){var b=2<arguments.length?arguments[2]:void 0;return 1<arguments.length&&void 0!==arguments[1]&&arguments[1]&&(a===U.SEARCH||a===U.ASIN_CLICK)&&b!==La.NILE_OPTION_IN_AUTOCOMPLETE}}])}(),
Si=function(){return x(function f(b,c,g){var h=this;z(this,f);a(this,"searchBarQuery","");a(this,"setSearchBarQuery",function(a){h.searchBarQuery=a});a(this,"setIsRufusStayBehaviorRequired",function(a){h.isRufusStayBehaviorRequired=""===a?void 0:"true"===a});this.panelContainer=b;this.cacheManager=c;this.conversationList=g;this.searchFilterContextBuilder=xg.getInstance()},[{key:"buildContext",value:function(a,b,c,f,g,m,p){if(7<arguments.length&&void 0!==arguments[7]&&arguments[7])return Ri.buildContext(this.cacheManager,
this.conversationList,this.panelContainer,a,b,c,f,g,m,p,this.getSearchBarQuery());var h=this.buildQueryContext(a,b,c,g,m);h={queryContext:h,pageContext:this.buildPageContext(a,h.query,f,p,g),bottomSheetContext:this.buildBottomSheetContext(a),impressionsContext:this.buildImpressionsContext(b,f,g===ua.NILE_ASIN_INGRESS),requestCancellationTokens:this.buildRequestCancellationTokens(),isDebug:"n"};return Oa.getInstance().getSearchFilterContext()?this.searchFilterContextBuilder.buildEnhancedContext(h):
h}},{key:"buildFeedbackPageContext",value:function(){var a,b,c=this.panelContainer.getPanelViewContext(),f=K.getCurrentPageUrl();c=Pa(c.pageType);var g=null===(a=(b=K.metadataParsers)[c])||void 0===a?void 0:a.call(b,f);return{pageType:c,targetPageType:c,originPageType:c,targetUrl:K.getCurrentPageUrl(),originUrl:f,targetPageMetadata:g,pageMetadata:g,originPageMetadata:g}}},{key:"getSearchBarQuery",value:function(){return this.searchBarQuery}},{key:"getIsRufusStayBehaviorRequired",value:function(){return this.isRufusStayBehaviorRequired}},
{key:"buildQueryContext",value:function(a,b,c,f,g){var h,l,r,F=K.extractQueryFromUrl(K.getCurrentPageUrl()),t=this.getSearchBarQuery();return void 0!==(h=f&&Object.values(La).includes(f)?b||g:b||F||t)&&500<(null===(l=h)||void 0===l?void 0:l.length)&&(m.addCount(p.INPUT_QUERY_MAX_LIMIT_REACHED,1),h=null===(r=h)||void 0===r?void 0:r.slice(0,500)),{query:h,actionType:a,qis:f||this.getQueryInputSourceByActionType(a,b),clickedAsinId:c}}},{key:"buildPageContext",value:function(a,b,c,f,g){var h,l,r,m,F=
this.panelContainer.getPanelViewContext(),p=this.cacheManager.getPanelState(),t=K.getCurrentPageUrl();f=K.setReftagAndQisInTargetUrl(t,null==f?void 0:f.url);var v=K.getOriginUrl();F=Pa(F.pageType);b=F!==xa.SEARCH_RESULTS||b?F:xa.UNKNOWN;p=Pa(v&&null!=p&&p.originPageType?p.originPageType:"");F=null===(h=(l=K.metadataParsers)[b])||void 0===h?void 0:h.call(l,t);h=null===(r=(m=K.metadataParsers)[p])||void 0===r?void 0:r.call(m,v);a=this.isNavigationQuery(a,c,g);return{pageType:b,targetPageType:b,originPageType:a?
p:b,targetUrl:f,originUrl:a?v:t,targetPageMetadata:F,pageMetadata:F,originPageMetadata:a?h:F}}},{key:"buildBottomSheetContext",value:function(a){var b=this.panelContainer.getPanelContainerState();return{bottomSheetEmpty:""===this.conversationList.getActiveConversationContainerContent().trim()&&a===U.SWIPE_UP,previousTurnsBottomSheetSize:this.mapPanelViewStateToBottomSheetSize(b.viewState)}}},{key:"buildImpressionsContext",value:function(a,b,c){var f={},h=fa("impressionsContextKey");h&&(f.IMPRESSIONS_CONTEXT_KEY=
h);a=a&&0<a.length&&!b;return(this.cacheManager.hasCustomerSeenFTUX()||a||c)&&(this.cacheManager.markCustomerSeenFTUX(),f[tf.FIRST_TIME_USER_MESSAGE_SEEN_STATUS]=uf.SEEN),f}},{key:"buildRequestCancellationTokens",value:function(){var a,b=null===(a=this.cacheManager.getPanelState())||void 0===a?void 0:a.requestContext;if(b)return[b]}},{key:"getQueryInputSourceByActionType",value:function(a,b){switch(a){case U.SEARCH:return b&&0<b.length?ua.NILE_CL_TEXT_INPUT:K.extractQis(K.getCurrentPageUrl());case U.SWIPE_UP:return K.extractQis(K.getCurrentPageUrl())}}},
{key:"mapPanelViewStateToBottomSheetSize",value:function(a){switch(a){case "closed":return sb.HIDDEN;case "minimized":return sb.COLLAPSED;case "expanded":return sb.EXPANDED}}},{key:"isNavigationQuery",value:function(a){var b=2<arguments.length?arguments[2]:void 0;return 1<arguments.length&&void 0!==arguments[1]&&arguments[1]&&(a===U.SEARCH||a===U.ASIN_CLICK)&&b!==La.NILE_OPTION_IN_AUTOCOMPLETE}}])}(),Ti=function(){return x(function r(b,c){var f=this;z(this,r);a(this,"RUFUS_EVENT_METRIC_SUFFIX",a({},
Vb.HANDLE_EXPAND,"_expand_rufus"));this.panelContainer=b;this.conversationOrchestrator=c;this.events=a(a({},Vb.HANDLE_EXPAND,function(a){return f.handleExpand(a)}),Vb.HANDLE_STREAM,function(a){return f.handleStreamForCL(a)})},[{key:"init",value:function(){this.registerEvents(this.events)}},{key:"registerEvents",value:function(a){Object.entries(a).forEach(function(a){var b=Ca(a,2);a=b[0];b=b[1];c.P&&ka.declare(a,b)})}},{key:"handleExpand",value:function(a){a?(m.addCount(a+this.RUFUS_EVENT_METRIC_SUFFIX[Vb.HANDLE_EXPAND],
1),this.updatePanelState("expanded")):m.logErrorWithLevel(H.ERROR,"Error handling rufus panel expand with empty rufusClient name")}},{key:"handleStreamForCL",value:function(a){this.validateDataBeforeHandlingRufusStream(a)?(a.metricName&&m.addCount(a.metricName,1),this.conversationOrchestrator.stream(a),this.updatePanelState("expanded")):(a="Error handling rufus stream with params: "+JSON.stringify(a),m.logErrorWithLevel(H.ERROR,a))}},{key:"validateDataBeforeHandlingRufusStream",value:function(a){return!!(a.qis&&
a.query&&a.metricName)}},{key:"updatePanelState",value:function(a){var b=this.panelContainer.getPanelContainerState().viewState;this.panelContainer.applyAnimationAndStateUpdate(b,a)}}])}(),Ui=function(){return x(function h(){z(this,h);a(this,"localStorage",!1);a(this,"sessionStorage",!1);a(this,"webCrypto",!1);a(this,"flexbox",!1);a(this,"browserName","");this.checkCapabilities()},[{key:"areAllFeaturesSupported",value:function(){return this.localStorage&&this.sessionStorage&&this.webCrypto&&this.flexbox}},
{key:"checkIsStreamingInterruptedBehaviorDifferent",value:function(){return this.browserName=ye.getInstance().browserName,"Safari"===this.browserName}},{key:"checkCapabilities",value:function(){this.checkLocalStorage();this.checkSessionStorage();this.checkFlexbox();this.checkWebCrypto()}},{key:"checkLocalStorage",value:function(){try{localStorage.setItem("test","test"),localStorage.removeItem("test"),this.localStorage=!0}catch(h){this.localStorage=!1}}},{key:"checkSessionStorage",value:function(){try{sessionStorage.setItem("test",
"test"),sessionStorage.removeItem("test"),this.sessionStorage=!0}catch(h){this.sessionStorage=!1}}},{key:"checkWebCrypto",value:function(){this.webCrypto=!(!c.crypto||!c.crypto.subtle)}},{key:"checkFlexbox",value:function(){var a=document.createElement("div");a.style.display="flex";this.flexbox="flex"===a.style.display}}])}(),ed=function(){function a(){z(this,a)}return x(a,[{key:"handleActionChunk",value:function(b,c){if(null!=b&&b.action){var h=b.action;b=h.actionType;var f=h.actionId;h=h.payload;
f?b===Kb.UPDATE_CART_COUNT?this.handleUpdateCartCount(h,f,c):m.logErrorWithLevel(H.ERROR,"Unknown NTSActionType: ".concat(b)):m.logErrorWithLevel(H.ERROR,a.ERROR_MISSING_ACTION_ID)}else m.logErrorWithLevel(H.ERROR,a.ERROR_INVALID_ACTION_CHUNK)}},{key:"handleUpdateCartCount",value:function(b,l,g){try{var f,h=this.isUpdateCartCountPayload(b)?b:null;b=!1;if(g===xa.CART?(c.location.reload(),m.addCount(p.RUFUS_CART_PAGE_REFRESHED,1),b=!0):h&&null!==(f=c.navbar)&&void 0!==f&&f.setCartCount&&Number.isFinite(h.totalCartCount)&&
(c.navbar.setCartCount(h.totalCartCount),m.addCount(p.RUFUS_CART_COUNT_UPDATED,1),b=!0),b){var r=null!=h&&h.asinToQuantity?{asinToQuantity:JSON.stringify(h.asinToQuantity)}:void 0;O(a.UPDATE_CART_COUNT_METRIC_NAME,l,r)}}catch(X){m.logErrorWithLevel(H.ERROR,"Error updating cart count for ".concat(l,": ").concat(X))}}},{key:"isUpdateCartCountPayload",value:function(a){return null!=a&&"object"===g(a)&&"totalCartCount"in a&&"number"==typeof a.totalCartCount&&"asinToQuantity"in a}}])}();a(ed,"UPDATE_CART_COUNT_METRIC_NAME",
"UPDATE_CART_COUNT");a(ed,"ERROR_INVALID_ACTION_CHUNK","Invalid action chunk data");a(ed,"ERROR_MISSING_ACTION_ID","Missing actionId in action chunk");var yg=function(){function b(c,l){var h=this;z(this,b);a(this,"onDismissClick",function(a){a.preventDefault();O(G.FILTER_PILL_DISMISS_CLICK,ia.ASIN_REFINEMENT);m.addCount(p.RASIN_FILTER_PILL_DISMISS_CLICK,1);Oa.getInstance().setSearchFilterContext(null);h.hide()});a(this,"onPillClick",function(){var a;O(G.FILTER_PILL_CLICK,ia.ASIN_REFINEMENT);O(Kb.OPEN_URL,
"".concat(ia.FILTER_PILL_INGRESS_PREFIX).concat(null===(a=Oa.getInstance())||void 0===a||null===(a=a.getSearchFilterContext())||void 0===a?void 0:a.asinId));m.addCount(p.RASIN_FILTER_PILL_CLICK,1)});this.elements={container:c,link:c.querySelector("#rufus-asin-filter-pill-content"),image:c.querySelector("#rufus-asin-filter-pill-preview-image"),title:c.querySelector(".rufus-asin-filter-pill-title"),dismissButton:c.querySelector(".rufus-asin-filter-pill-dismiss")};this.shade=document.querySelector(".".concat("rufus-asin-filter-shade"));
this.updateContent(l);this.show();this.attachHandlers()}return x(b,[{key:"hide",value:function(){b.hideFilterPillAndShadeElements(this.elements.container,this.shade)}},{key:"updateContent",value:function(a){this.elements.link.href="/dp/".concat(a.asinId,"/").concat(tb.DP_FROM_FILTER_PILL);this.elements.image.src=a.productImageUrl||"";this.elements.image.alt=a.asinTitle;this.elements.title.textContent=a.asinTitle}},{key:"show",value:function(){b.toggleElementVisibility(this.elements.container,!0,"rufus-asin-filter-pill-show",
"rufus-asin-filter-pill-hide");b.toggleElementVisibility(this.shade,!0,"rufus-asin-filter-shade-show","rufus-asin-filter-shade-hide");this.elements.container.setAttribute("aria-label","Conversation filter set to: ".concat(this.elements.title.textContent))}},{key:"attachHandlers",value:function(){this.elements.dismissButton.onclick=this.onDismissClick;this.elements.link.onclick=this.onPillClick}}],[{key:"createIfPossible",value:function(a){var c=document.getElementById("rufus-asin-filter-pill");return c?
new b(c,a):(m.logErrorWithLevel(H.WARN,"No filter pill element found in DOM"),null)}},{key:"cleanupRasinFilterPill",value:function(){var a=document.getElementById("rufus-asin-filter-pill"),c=document.querySelector(".".concat("rufus-asin-filter-shade"));a&&c&&!a.classList.contains("aok-hidden")&&b.hideFilterPillAndShadeElements(a,c)}},{key:"toggleElementVisibility",value:function(a,b,c,f){a&&(b?(a.classList.remove("aok-hidden",f),a.classList.add(c)):(a.classList.remove(c),a.classList.add(f),a.addEventListener("animationend",
function(){a.classList.add("aok-hidden");a.classList.remove(f)},{once:!0})))}},{key:"hideFilterPillAndShadeElements",value:function(a,c){b.toggleElementVisibility(a,!1,"rufus-asin-filter-pill-show","rufus-asin-filter-pill-hide");b.toggleElementVisibility(c,!1,"rufus-asin-filter-shade-show","rufus-asin-filter-shade-hide")}}])}(),Vi=function(){return x(function r(b,c){var f=this;z(this,r);a(this,"handleRufusAwareAsinCtaClick",function(a){f.panelContainer.applyAnimationAndStateUpdate(f.panelContainer.getPanelContainerState().viewState,
"expanded");var b=Oa.getInstance().getSearchFilterContext();a.asinId!==(null==b?void 0:b.asinId)&&(Oa.getInstance().setSearchFilterContext({asinId:a.asinId,productImageUrl:a.productImageURL,asinTitle:a.asinTitle,dpLink:a.dpLink}),f.streamingClient.startStream({actionType:U.ASIN_CLICK,inputQuery:"",isInitialStream:!1,qis:ua.NILE_ASIN_INGRESS}))});a(this,"handleAsinContextChange",function(a){a?yg.createIfPossible(a):(yg.cleanupRasinFilterPill(),f.streamForSearch())});this.panelContainer=b;this.streamingClient=
c},[{key:"initialize",value:function(){var a=Oa.getInstance(),b=!!document.getElementById("rufus-asin-filter-pill");return a&&b?(a.on("contextUpdated",this.handleAsinContextChange),this.registerRasinCtaClickHandler(),m.addCount(p.RASIN_INITIALIZE_SUCCESS,1),!0):(m.addCount(p.RASIN_INITIALIZATION_ERROR,1),!1)}},{key:"registerRasinCtaClickHandler",value:function(){var a=this;ka.when("A").execute(function(b){b.on("rufus-asin-context",function(b){a.handleRufusAwareAsinCtaClick(b)})})}},{key:"streamForSearch",
value:function(){var a=this.panelContainer.getPanelViewContext();this.streamingClient.startStream({actionType:U.SEARCH,isInitialStream:!1,qis:a.qis,metadata:a.metadata,reftag:K.extractNileReftagFromUrl(K.getCurrentPageUrl())})}}])}(),zg=function(a){return a.COLLAPSED="collapsed",a.HALF="half",a.EXPANDED="expanded",a.TEASER="teaser",a.TEASER_AUTO_EXPAND="teaserAutoExpand",a}({}),Ag=R(8295),Bg=function(a,b){if(b&&a){try{var c=JSON.parse(a)}catch(r){a="Error parsing rufusTriggerMarkerMappingString: ".concat(a,
". ").concat(r),c=void m.logErrorWithLevel(H.ERROR,a)}return null==c?void 0:c[b]}},Cg=function(){var a=A(P().mark(function r(a){var b,c,g,l,p,t=arguments;return P().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(b=1<t.length&&void 0!==t[1]?t[1]:3E3,c=2<t.length?t[2]:void 0,g=!1,l=3<t.length?t[3]:void 0,p=function(){var b=A(P().mark(function ld(){var b;return P().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(g){c.next=4;break}return g=!0,c.prev=1,c.next=2,a();case 2:c.next=4;break;
case 3:c.prev=3,b=c.catch(1),m.logErrorWithLevelWithException(H.ERROR,b);case 4:case "end":return c.stop()}},ld,null,[[1,3]])}));return function(){return b.apply(this,arguments)}}(),M.startTimeout(l,p,b),!c){f.next=1;break}return f.next=1,new Promise(function(a){ka.when(c).execute(A(P().mark(function ld(){return P().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(!M.hasTimeout(l)){b.next=1;break}return M.clear(l),b.next=1,p();case 1:a();case 2:case "end":return b.stop()}},ld)})))});case 1:case "end":return f.stop()}},
r)}));return function(b){return a.apply(this,arguments)}}(),Ka=function(a){return a.ActiveWithActiveContainerAnchor="ActiveWithActiveContainerAnchor",a.ActiveWithAnchor="ActiveWithAnchor",a.ActiveWithoutAnchor="ActiveWithoutAnchor",a.Inactive="Inactive",a}({}),Wi=function(b){function c(b){var h;return z(this,c),a(h=function(a,b,c){return b=v(b),C(a,lf()?Reflect.construct(b,[],v(a).constructor):b.apply(a,c))}(this,c),"topAlignmentTolerance",1),a(h,"autoScrollAnchorTopOffset",12),a(h,"firstScrollEventLogged",
!1),a(h,"SHOW_SCROLL_BAR_CLASS","show-scroll-bar"),a(h,"autoScroll",function(){h.autoScrollingState!==Ka.Inactive&&h.toggleScrollBarVisibility(!1);h.autoScrollingState===Ka.ActiveWithoutAnchor?h.scrollToBottom():h.autoScrollingState===Ka.ActiveWithAnchor?h.scrollToLatestConversationTurn():h.autoScrollingState===Ka.ActiveWithActiveContainerAnchor&&h.scrollToTopOfActiveConversationContainer();h.toggleScrollButtonVisibility()}),a(h,"scrollToBottom",function(){h.toggleScrollBarVisibility(!1);h.elements.container.scrollTop=
h.elements.container.scrollHeight-h.elements.container.clientHeight}),a(h,"scrollToLatestConversationTurn",function(){var a=h.getLatestConversationTurnOrContainer();h.elements.container.scrollTop=h.calculateScrollPositionToLatestConversationTurnWithOffset(a)}),a(h,"scrollToTopOfActiveConversationContainer",function(){h.elements.container.scrollTop=h.elements.activeConversationContainer.offsetTop-h.autoScrollAnchorTopOffset}),a(h,"handleScroll",function(a){a.stopPropagation();h.toggleScrollButtonVisibility()}),
a(h,"toggleScrollButtonVisibility",function(){h.updateScrollButtonBottomPosition();h.elements.scrollButton.style.display=h.shouldDisplayScrollButton()?"flex":"none"}),a(h,"shouldDisplayScrollButton",function(){var a=h.panelContainer.isPanelExpanded(),b=h.panelContainer.isShowAnimationRunning(),c=h.elements.container.clientHeight<h.elements.container.scrollHeight,g=(h.autoScrollingState===Ka.ActiveWithActiveContainerAnchor||h.autoScrollingState===Ka.ActiveWithAnchor)&&h.isCurrentConversationContainerAtTopOfPanel();
g=h.autoScrollingState===Ka.Inactive||g;var l=h.elements.container.scrollTop,r=h.calculateScrollPositionToShowScrollButton(h.isRasinVisible());return a&&!b&&c&&g&&l<r}),a(h,"calculateScrollPositionToShowScrollButton",function(a){var b=h.elements.container.scrollHeight-h.elements.container.clientHeight-75;return a?b-104:b}),a(h,"updateScrollButtonBottomPosition",function(){var a=h.elements.scrollButton,b=document.querySelector(".rufus-textarea-container");h.isRasinVisible()&&b?a.style.bottom="".concat(116,
"px"):a.style.bottom="".concat(64,"px")}),a(h,"isRasinVisible",function(){var a=document.querySelector(".".concat("rufus-asin-filter-pill")),b=document.querySelector(".".concat("rufus-asin-filter-shade"));a=!!a&&a.classList.contains("rufus-asin-filter-pill-show");b=!!b&&b.classList.contains("rufus-asin-filter-shade-show");return a&&b}),a(h,"handleKeyDownOnContainer",function(a){ph.includes(a.key)&&h.onManualScroll()}),a(h,"handleKeyDown",function(a){"Enter"===a.key&&h.handleArrowDownButtonClick()}),
a(h,"toggleScrollBarVisibility",function(a){h.elements.container.classList.toggle(h.SHOW_SCROLL_BAR_CLASS,a)}),a(h,"onManualScroll",function(){h.setAutoScrollingState(Ka.Inactive);h.toggleScrollBarVisibility(!0);h.firstScrollEventLogged||(O(G.SCROLL_VIEW),h.firstScrollEventLogged=!0);100>h.elements.container.scrollTop&&h.dispatch("onTopReached",void 0)}),a(h,"handleArrowDownButtonClick",function(){h.setAutoScrollingState(Ka.ActiveWithoutAnchor);h.elements.scrollButton.style.display="none";h.scrollToBottom();
O(G.SCROLL_VIEW_END);m.addCount(p.RUFUS_SCROLL_DOWN_CLICKED,1)}),h.missingElementsRecorder=new Zc("ScrollingUtil"),h.elements=h.readHtmlElementsFromDom(),h.autoScrollingState=Ka.Inactive,h.panelContainer=b,h.attachEventListeners(),h}return N(c,b),x(c,[{key:"refreshOnBfCacheNavigation",value:function(){Object.assign(this.elements,this.readHtmlElementsFromDom());this.attachEventListeners()}},{key:"readHtmlElementsFromDom",value:function(){var a={container:this.missingElementsRecorder.getElementOrRecordMissing("rufus-conversation-container"),
activeConversationContainer:this.missingElementsRecorder.getElementOrRecordMissing("rufus-active-conversation-container"),scrollButton:this.missingElementsRecorder.getElementOrRecordMissing("rufus-scroll-button")};return this.missingElementsRecorder.logMissingElementsAndThrowError(),a}},{key:"attachEventListeners",value:function(){var a=this;this.elements.container.addEventListener("wheel",this.onManualScroll);this.elements.container.addEventListener("touchstart",this.onManualScroll);this.elements.container.addEventListener("scroll",
this.handleScroll);this.elements.container.addEventListener("keydown",this.handleKeyDownOnContainer);this.elements.container.addEventListener("pointerup",this.onManualScroll);this.elements.container.addEventListener("pointercancel",this.onManualScroll);(new MutationObserver(function(){a.toggleScrollButtonVisibility()})).observe(this.elements.container,{childList:!0,subtree:!0});this.elements.scrollButton.addEventListener("click",this.handleArrowDownButtonClick);this.elements.scrollButton.addEventListener("keydown",
this.handleKeyDown);this.panelContainer.on("updateScrollButtonVisibility",this.toggleScrollButtonVisibility)}},{key:"scrollIntoView",value:function(a){this.setAutoScrollingState(Ka.Inactive);(a=document.getElementById(a))&&a.scrollIntoView({block:"nearest"})}},{key:"setAutoScrollingState",value:function(a){this.autoScrollingState=a}},{key:"getAutoScrollingState",value:function(){return this.autoScrollingState}},{key:"getElementVerticalDistanceRelativeToScrollContainer",value:function(a){var b=this.elements.container.getBoundingClientRect();
return a.getBoundingClientRect().top-b.top}},{key:"isCurrentConversationContainerAtTopOfPanel",value:function(){var a=this.getLatestConversationTurnOrContainer();a=this.calculateScrollPositionToLatestConversationTurnWithOffset(a);return this.isScrollPositionClose(this.elements.container.scrollTop,a)}},{key:"getLatestConversationTurnOrContainer",value:function(){var a=this.elements.activeConversationContainer.children;return 0<a.length?a[a.length-1]:this.elements.activeConversationContainer}},{key:"calculateScrollPositionToLatestConversationTurnWithOffset",
value:function(a){return this.getElementVerticalDistanceRelativeToScrollContainer(a)+this.elements.container.scrollTop-this.autoScrollAnchorTopOffset}},{key:"isScrollPositionClose",value:function(a,b){return Math.abs(a-b)<=(2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.topAlignmentTolerance)}}])}(Ia),Xi=function(b){function h(b,f,g,l,r,t,x,B,E,D,J,N,R,Q){var q;return z(this,h),a(q=function(a,b,c){return b=v(b),C(a,nf()?Reflect.construct(b,[],v(a).constructor):b.apply(a,c))}(this,h),
"startInitialStreamingCallback",function(){if(q.shouldSkipStreamingOnSearchResults())return ka.declare("rufus-teaser-cx-bsr-teaser",!0),m.addCount(p.RUFUS_TEASER_RECOVERY_WIDGET_SENT_TO_SEARCH,1),void O(G.TEASER_RECOVERY_WIDGET_SENT_TO_SEARCH);if(q.isJSMigration){if(vg(c.location.href))return;var a;if(ka.now("rufus-cl-disable-default-initial-streaming").execute(function(b){a=b}),a)return}(q.needsRemovePartialFTUE()||q.needsRemoveEmptyConversationTurn())&&q.conversationList.modifyContent(za.RemoveLastActiveTurn);
q.streamingClient.startInitialStreamingCall(q.panelContainer.getPanelViewContext())}),a(q,"needsRemovePartialFTUE",function(){return!q.conversationList.isLastTurnAnimationComplete()&&!q.conversationList.isAffordancePresentInContainer()}),a(q,"needsRemoveEmptyConversationTurn",function(){return q.conversationList.isLastTurnContentEmpty()}),a(q,"handleRetryRequest",function(){var a=q.cacheManager.getRequestMetadata();a&&q.streamingClient.startStream(a)}),a(q,"saveRequestMetadataToPanelCache",function(a){q.cacheManager.setRequestMetadata(a)}),
a(q,"handleThumbsDownClick",function(a){q.scrollingUtil.scrollIntoView(a)}),a(q,"handleOfflineError",function(){m.addCount(p.RUFUS_OFFLINE,1);(M.clearTimeouts(["initial_chunk_timeout","midstream_timeout"]),q.cacheManager.getRequestMetadata())?(q.streamingClient.getStreamingStatus().streamingStatus===ya.OPEN||ya.STREAMING,q.renderOfflineError()):q.renderOfflineError()}),a(q,"handleOnlineEvent",function(){gb.removeError(nb.OFFLINE)}),a(q,"renderOfflineError",function(){gb.renderError({errorCode:nb.OFFLINE,
errorMessage:"offline_error_message"});q.scrollingUtil.scrollToBottom()}),a(q,"onPageUnload",function(){q.isPageUnload=!0}),a(q,"handleStreamingStatusUpdate",function(a){var b,f=a.streamingStatus,h=a.isInitialStream,g=a.actionType,l=a.requestContext;a=q.capabilityManager.checkIsStreamingInterruptedBehaviorDifferent();if(f!==ya.OPEN&&f!==ya.STREAMING||(q.conversationList.toggleLoaderAndUpdateAnnouncer(Ya.VisibleWithAvatar),a&&f===ya.STREAMING&&(c.removeEventListener("beforeunload",q.onPageUnload),
c.addEventListener("beforeunload",q.onPageUnload))),f===ya.STREAMING&&(q.conversationList.removeTemporarySections(),q.animationUtil.stopAnimating(),q.conversationList.createNewStreamContainer(h,g),h?(q.scrollingUtil.scrollToBottom(),q.scrollingUtil.setAutoScrollingState(Ka.ActiveWithActiveContainerAnchor)):(q.scrollingUtil.setAutoScrollingState(Ka.ActiveWithAnchor),q.scrollingUtil.autoScroll(),q.conversationList.getInterruptionRecoveryContainer()&&(q.conversationList.moveInterruptionRecoveryContainerOutOfConversation(),
q.updateCache())),l&&(null==l||null===(b=l.queryContext)||void 0===b?void 0:b.qis)===ua.NILE_CL_TEXT_INPUT)){var r;b=null!==(r=l.queryContext.query)&&void 0!==r?r:"";""!==b&&(r=function(a){var b=ta.getInstance().getWeblabTreatment("RUFUS_DESKTOP_VISUAL_BRANDING_UPDATE_1201601");return"T1"===b||"T2"===b?function(a){var b=ta.getInstance().getWeblabTreatment("RUFUS_DESKTOP_VISUAL_BRANDING_UPDATE_1201601");return'\x3cdiv class\x3d"rufus-sections-container" data-section-class\x3d"CustomerText"\x3e\n        \x3cdiv class\x3d"a-section rufus-conversation-branding-update rufus-customer-text rufus-dialog-customer"\x3e\n            \x3cdiv class\x3d"'.concat("T2"===
b?"rufus-speech-bubble-lighter":"rufus-speech-bubble",'"\x3e\n                    \x3cspan class\x3d"rufus-customer-text-wrap"\x3e').concat(a?(0,Ag.encoder)().encodeForHTML(a):"","\x3c/span\x3e\n            \x3c/div\x3e\n        \x3c/div\x3e\n    \x3c/div\x3e")}(a):function(a){var b=ta.getInstance().getWeblabTreatment("RUFUS_DESKTOP_COLOR_UPDATE_1168668");return b&&m.recordTrigger("RUFUS_DESKTOP_COLOR_UPDATE_1168668",b),'\x3cdiv class\x3d"rufus-sections-container" data-section-class\x3d"CustomerText"\x3e\n            \x3cdiv class\x3d"a-section rufus-conversation rufus-customer-text"\x3e\n                \x3cimg alt\x3d"" src\x3d"'.concat("T1"===
b?"https://m.media-amazon.com/images/G/01/Rufus_Desktop/Avatar-Customer-Rio-V2-1-2.svg":"https://m.media-amazon.com/images/G/01/Rufus_Desktop/Avatar-Customer.png",'" class\x3d"rufus-avatar-img" height\x3d"20" width\x3d"20"\x3e\n                \x3cdiv class\x3d"a-section rufus-text-subsections-with-avatar"\x3e\n                    \x3cdiv style\x3d"text-align: left;display:inline-block;"\x3e\n                        \x3cspan class\x3d"rufus-color-onyx rufus-font-size-default rufus-text-wrap"\x3e').concat(a?
(0,Ag.encoder)().encodeForHTML(a):"","\x3c/span\x3e\n                    \x3c/div\x3e\n                \x3c/div\x3e\n            \x3c/div\x3e\n        \x3c/div\x3e")}(a)}(b),q.conversationList.modifyContent(za.InsertIntoLastActiveTurn,r))}q.textInput.setFocus();f!==ya.CLOSED&&f!==ya.ERROR||(c.removeEventListener("beforeunload",q.onPageUnload),1>q.animationUtil.getQueue().length&&q.conversationList.toggleLoaderAndUpdateAnnouncer(Ya.Hidden),a&&q.isPageUnload||q.cacheManager.setPanelRequestCompleted(!0))}),
a(q,"removeLoader",function(){var a=q.streamingClient.getStreamingStatus().streamingStatus;a!==ya.CLOSED&&a!==ya.ERROR||q.conversationList.toggleLoaderAndUpdateAnnouncer(Ya.Hidden);a===ya.CLOSED&&q.streamingLifecycleEventLogger.emitStreamRenderEnd()}),a(q,"markAnimationComplete",function(){q.streamingClient.getStreamingStatus().streamingStatus===ya.CLOSED&&q.conversationList.markLastTurnAnimationComplete()}),a(q,"stream",function(a){navigator.onLine?q.streamingClient.startStream({actionType:U.SEARCH,
inputQuery:a.query,qis:a.qis,metadata:a.metadata,reftag:tb.CUSTOMER_SUBMITTED_QUERY}):q.handleOfflineError()}),a(q,"handleEventReceived",function(a){var b,c;switch(null!==(b=a.streamingEventType)&&void 0!==b?b:a.event.type){case V.CONTEXT:q.handleContextChunk(a.event);break;case V.AFFORDANCE:if((null===(c=a.streamingStatusDetails.requestContext)||void 0===c||null===(c=c.queryContext)||void 0===c?void 0:c.qis)===ua.NILE_CL_TEXT_INPUT)break;q.handleContentChunk(a);break;case V.REMOVE:q.handleRemoveEvent(a.event);
break;case V.ACTION:q.handleActionChunk(a.event);break;default:q.handleContentChunk(a)}}),a(q,"handleEventReceivedV2",function(a){var b,c;switch(null!==(b=a.streamingEventType)&&void 0!==b?b:a.event.type){case V.CONTEXT:q.handleContextChunk(a.event);break;case V.AFFORDANCE:if((null===(c=a.streamingStatusDetails.requestContext)||void 0===c||null===(c=c.queryContext)||void 0===c?void 0:c.qis)===ua.NILE_CL_TEXT_INPUT)break;q.handleContentChunkV2(a);break;case V.REMOVE:q.handleRemoveEventV2(a.event);
break;case V.ACTION:q.handleActionChunk(a.event);break;default:q.handleContentChunkV2(a)}}),a(q,"handleLoadMoreHistory",A(P().mark(function yi(){var a;return P().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(!q.historyClient.isLoading()&&q.historyClient.hasMoreHistory()){b.next=1;break}return b.abrupt("return");case 1:return b.prev=1,b.next=2,q.fetchHistory(za.PrependHistory);case 2:b.next=4;break;case 3:b.prev=3,a=b.catch(1),m.logErrorWithLevelWithException(H.ERROR,a,"Could not load more history");
case 4:case "end":return b.stop()}},yi,null,[[1,3]])}))),a(q,"handleInterruptionRecoveryButtonClick",function(){var a=A(P().mark(function cd(a){var b;return P().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=1,q.recoverInterruptedConversationFromHistory(a);case 1:c.next=3;break;case 2:c.prev=2,b=c.catch(0),q.conversationList.dismissInterruptionRecoverySpinnerAndShowButton(),m.logErrorWithLevelWithException(H.ERROR,b,"Failed to call history endpoint to load interrupted conversation"),
m.addCount(p.INTERRUPTION_RECOVERY_FAILED,1);case 3:case "end":return c.stop()}},cd,null,[[0,2]])}));return function(b){return a.apply(this,arguments)}}()),a(q,"handleTopReached",function(){m.addCount(p.RUFUS_SCROLL_TO_TOP,1);var a=q.historyClient.hasMoreHistory(),b=q.historyClient.isLoading(),c=q.conversationList.isFtuxOrRuxOnScreen();q.conversationList.toggleLoadMoreHistoryButtonElementVisibility(!q.conversationList.isFtuxPresent()&&5<=q.conversationList.getNumberOfConversationTurns()&&a&&!b&&!q.conversationList.isSpinnerShowing());
q.conversationList.toggleBeginningOfHistoryElementVisibility(!a&&!b&&!c)}),a(q,"handleCompleteMovingActiveConversationTurnsToHistory",A(P().mark(function zi(){return P().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=1,q.invalidateCache(!0);case 1:case "end":return a.stop()}},zi)}))),a(q,"handleConversationListCompleteReplacingContent",function(){q.updateCache();q.cacheManager.updateLastCacheInvalidatedTimestamp()}),a(q,"invalidateCache",function(){var a=A(P().mark(function Za(a){var b;
return P().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!q.isInvalidatingCache){c.next=1;break}return c.abrupt("return");case 1:if(q.isInvalidatingCache=!0,q.conversationList.toggleLoadMoreHistoryButtonElementVisibility(!1),c.prev=2,q.cacheManager.shouldInvalidatePanelCache()){c.next=3;break}return m.addCount(p.RUFUS_PANEL_CACHE_VALID,1),c.abrupt("return");case 3:return c.next=4,q.replaceCache(a);case 4:q.cacheManager.setRequestMetadata(void 0);m.addCount(p.RUFUS_PANEL_CACHE_INVALID,1);
c.next=6;break;case 5:c.prev=5,b=c.catch(2),m.logErrorWithLevelWithException(H.ERROR,b,"Could not invalidate cache");case 6:return c.prev=6,q.isInvalidatingCache=!1,c.finish(6);case 7:case "end":return c.stop()}},Za,null,[[2,5,6,7]])}));return function(b){return a.apply(this,arguments)}}()),a(q,"updateCache",function(){q.cacheManager.setPanelContent(q.conversationList.getPanelContentSnapshot())}),a(q,"handlePanelStateChange",function(a){if("expanded"===a.viewState&&q.twisterClicked){var b=ta.getInstance().getWeblabTreatment("RUFUS_1152798");
b&&(m.recordTrigger("RUFUS_1152798",b),q.twisterClicked=!1)}q.updateContainerStateCache(a);q.logInterruptStreamMetric(a)}),a(q,"handlePanelAnimationEnd",function(a){"expanded"===a&&q.textInput.setFocus()}),a(q,"logInterruptStreamMetric",function(a){"minimized"!==a.viewState&&"closed"!==a.viewState||q.streamingClient.getStreamingStatus().streamingStatus!==ya.STREAMING&&q.streamingClient.getStreamingStatus().streamingStatus!==ya.OPEN||(O(G.CONVERSATION_ABANDONMENT,"closed"===a.viewState?G.PANEL_CLOSE_CLICK:
G.PANEL_MINIMIZE_CLICK),m.addCount(p.RUFUS_STREAM_INTERRUPT,1))}),a(q,"updateContainerStateCache",function(a){var b=q.cacheManager.getPanel();b&&(a=ec(ec({},b.state),a),q.cacheManager.setPanelState(a))}),a(q,"updatePanelContainerState",function(){var a,b=q.panelContainer.getPanelContainerState();b.originPageType=null===(a=q.cacheManager.getPanelState())||void 0===a?void 0:a.targetPageType;b.targetPageType=q.panelContainer.getPanelViewContext().pageType;b.autoMinimize=q.determineAutoMinimizeState();
q.updateContainerStateCache(b)}),a(q,"handleContextChunk",function(a){try{var b=JSON.parse(a.data);pb.getInstance().nileRequestId=b.requestContext.requestId;q.handleBSR(b.bsr.bottomSheetSize);O(G.INVOKE_NILE);q.cacheManager.setPanelRequestContext(ec(ec({},b.requestContext),{},{requestCompleted:!1}))}catch(cd){gb.renderError({errorCode:nb.HANDLE_CONTEXT_CHUNK_ERROR}),m.logErrorWithLevelWithException(H.ERROR,cd,"".concat("ConversationOrchestrator"," - Error handling context chunk ","(".concat(cd.message,
")")))}}),a(q,"handleBSR",function(a){switch(a){case zg.TEASER:q.isEligibleToShowTeaser()&&(ka.declare("rufus-teaser-cx-bsr-teaser",pb.getInstance().nileRequestId),m.addCount(p.RUFUS_TEASER_WIDGET_BSR_SENT_TO_SEARCH,1),O(G.TEASER_WIDGET_BSR_SENT_TO_SEARCH));break;case zg.TEASER_AUTO_EXPAND:q.isEligibleToShowTeaser()&&(a=q.panelContainer.getPanelContainerState().viewState,q.panelContainer.applyAnimationAndStateUpdate(a,"expanded"),O(G.TEASER_AUTO_EXPANDS_CL),m.addCount(p.RUFUS_TEASER_AUTO_EXPANDS_CL,
1));break;default:q.panelContainer.handlePanelContainerViewStateUpdateWithCXZen(a)}}),a(q,"handleContentChunk",function(a){q.conversationList.updateHtmlSections(a);q.updateAnimationUtilPanelState(q.panelContainer.getPanelContainerState())}),a(q,"handleContentChunkV2",function(a){q.conversationList.updateHtmlSectionsV2(a);q.updateAnimationUtilPanelState(q.panelContainer.getPanelContainerState())}),a(q,"updateAnimationUtilPanelState",function(a){q.animationUtil.setViewState(a)}),a(q,"handleActionChunk",
function(a){try{var b=JSON.parse(a.data),c=Pa(q.panelContainer.getPanelViewContext().pageType);q.actionChunkHandler.handleActionChunk(b,c)}catch(Za){m.logErrorWithLevelWithException(H.ERROR,Za,"".concat("ConversationOrchestrator"," - Error handling action chunk: ").concat(Za instanceof Error?"(".concat(Za.message,")"):""))}}),a(q,"handleRemoveEvent",function(a){var b,c;try{var f=JSON.parse(a.data)}catch(ne){return void m.logErrorWithLevelWithException(H.ERROR,ne,"".concat("ConversationOrchestrator",
" - Error handling remove event: ").concat(ne instanceof Error?"(".concat(ne.message,")"):""))}q.conversationList.removeHtml(null===(b=f)||void 0===b?void 0:b.type,null===(c=f)||void 0===c?void 0:c.groupId)}),a(q,"handleRemoveEventV2",function(a){var b;try{var c=JSON.parse(a.data)}catch(Za){return void m.logErrorWithLevelWithException(H.ERROR,Za,"".concat("ConversationOrchestrator"," - Error handling remove event: ").concat(Za instanceof Error?"(".concat(Za.message,")"):""))}c&&null!==(b=c.sections[0])&&
void 0!==b&&b.target.groupId&&q.conversationList.removeHtml(c.sections[0].target.type,c.sections[0].target.groupId)}),a(q,"handleOverflowMenuGetStartedClick",function(){var a=q.cacheManager.getPanelState();!0===(null==a?void 0:a.autoMinimize)&&q.panelContainer.applyAnimationAndStateUpdate("expanded","minimized")}),a(q,"handleAutoMinimizeToggleSwitchEvent",function(a){q.cacheManager.toggleAutoMinimize(a)}),a(q,"handleAutoMinimizeToggleSwitchStateChange",function(a){q.overflowMenu.handleAutoMinimizeToggleSwitchStateChange(a)}),
a(q,"initializeAutoMinimizeToggleSwitch",function(){var a,b=q.cacheManager.getPanelState();q.handleAutoMinimizeToggleSwitchStateChange(null===(a=null==b?void 0:b.autoMinimize)||void 0===a||a)}),a(q,"handleOverflowMenuStateChange",function(a){q.panelContainer.handleOverflowMenuStateChange(a)}),a(q,"registerSearchPageAjaxEventHandler",function(){var a=q.cacheManager.getPreviousPageUrl()===K.getCurrentPageUrl();ka.when("Rush","s-actions").execute(function(b,c){b.on(c.LOAD_SEARCH_PAGE_STARTING,function(){var b=
q.cacheManager.getPanelState();!0!==(null==b?void 0:b.autoMinimize)||"expanded"!==(null==b?void 0:b.viewState)||a||q.panelContainer.applyAnimationAndStateUpdate(null==b?void 0:b.viewState,"minimized");a=!1});b.on(c.LOAD_SEARCH_PAGE_COMPLETE,function(){q.cacheManager.setPreviousPageUrl()})})}),a(q,"handleNavigateOnClickFromRecoveryTeaserCX",function(){var a=K.getCurrentPageUrl();(a=K.getTeaserCXCustomerQueryFromURLQueryParam(a))&&q.panelContainer.handleNavigateFromTeaserCX(a)}),a(q,"isEligibleToShowTeaser",
function(){var a,b,c=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],f="Search"===q.panelContainer.getPanelViewContext().pageType,h=q.panelContainer.isPanelExpanded(),g=ta.getInstance().getWeblabTreatment("RUFUS_NAVONLY_INGRESS_1200814");f=!q.isBfcacheNavigation&&f&&!h&&"T1"!==g;if(!c)return f;c=null!==(a=null===(b=q.cacheManager.getPanelState())||void 0===b||null===(b=b.requestMetadata)||void 0===b?void 0:b.isInitialStream)&&void 0!==a&&a;return f&&c}),a(q,"isEligibleForRasin",function(){var a=
ta.getInstance().getWeblabTreatment("RUFUS_NAVONLY_INGRESS_1200814");return"T1"===ta.getInstance().getWeblabTreatment("SEARCH_RUFUS_ASIN_INGRESS_1207023")&&"T1"!==a}),a(q,"initializeTwisterStateChange",function(){ka.when("A").execute(function(a){a.on("PageRefresh:ATF",function(){q.handleTwisterVariationSelection()})})}),a(q,"handleTwisterVariationSelection",function(){var a=ta.getInstance().getWeblabTreatment("RUFUS_1152798");a&&("T1"==a&&(q.streamingClient.startInitialStreamingCall(q.panelContainer.getPanelViewContext()),
m.addCount(p.RUFUS_TWISTER_STREAMING_REQUEST,1),O(G.RUFUS_TWISTER_STREAMING_REQUEST_SENT)),q.panelContainer.isPanelExpanded()?m.recordTrigger("RUFUS_1152798",a):q.twisterClicked=!0)}),q.cacheManager=b,q.historyClient=f,q.conversationList=g,q.panelContainer=l,q.streamingClient=r,q.textInput=t,q.overflowMenu=x,q.feedbackControl=B,q.scrollingUtil=E,q.animationUtil=D,q.actions=J,q.actionsHandler=N,q.actionChunkHandler=new ed,q.streamingLifecycleEventLogger=R,q.isInvalidatingCache=!1,q.capabilityManager=
Q,q.isPageUnload=!1,q.twisterClicked=!1,q.isJSMigration=!1,q}return N(h,b),x(h,[{key:"initialize",value:function(a){var b,f=this;this.isJSMigration=null!==(b=null==a?void 0:a.isJSMigration)&&void 0!==b&&b;this.textInput.on("onQuery",this.stream);this.scrollingUtil.on("onTopReached",this.handleTopReached);this.streamingClient.on("onEventReceived",this.handleEventReceived);this.streamingClient.on("onEventReceivedV2",this.handleEventReceivedV2);this.streamingClient.on("onStreamingStatusChange",this.handleStreamingStatusUpdate);
this.streamingClient.on("submitRetryRequest",this.handleRetryRequest);this.panelContainer.on("onPanelContainerStateChange",this.handlePanelStateChange);this.panelContainer.on("onPanelAnimationEnd",this.handlePanelAnimationEnd);this.panelContainer.on("onAutoMinimizeToggleSwitchStateChange",this.handleAutoMinimizeToggleSwitchStateChange);this.overflowMenu.on("onGetStartedClicked",this.handleOverflowMenuGetStartedClick);this.overflowMenu.on("onAutoMinimizeClick",this.handleAutoMinimizeToggleSwitchEvent);
this.overflowMenu.on("onOverflowMenuStateChange",this.handleOverflowMenuStateChange);this.animationUtil.on("sectionAnimationComplete",this.updateCache);this.animationUtil.on("allAnimationsInQueueComplete",this.markAnimationComplete);this.animationUtil.on("animationQueueComplete",this.removeLoader);this.feedbackControl.on("onThumbsDownClick",this.handleThumbsDownClick);this.feedbackControl.on("onFeedbackSubmitted",this.updateCache);this.conversationList.on("onLoadMoreHistoryButtonClick",this.handleLoadMoreHistory);
this.conversationList.on("onInterruptionRecoveryButtonClick",this.handleInterruptionRecoveryButtonClick);this.conversationList.on("lastActiveTurnContentUpdated",this.scrollingUtil.autoScroll);this.actions.on("onAction",this.actionsHandler.handleAction);this.isEligibleForRasin()&&(new Vi(this.panelContainer,this.streamingClient)).initialize();this.cacheManager.initialize();(b=this.cacheManager.getPanelState())&&b.requestContext&&b.requestContext.requestId&&(pb.getInstance().nileRequestId=b.requestContext.requestId,
this.updateAnimationUtilPanelState(b));this.handleNavigateOnClickFromRecoveryTeaserCX();this.handleStreamingInterruption();this.conversationList.on("completeMovingActiveConversationTurnsToHistory",this.handleCompleteMovingActiveConversationTurnsToHistory);this.conversationList.on("completeReplacingContentInContainer",this.handleConversationListCompleteReplacingContent);this.streamingClient.on("invalidatePanelCache",this.invalidateCache);this.streamingClient.on("saveRequestMetadataToPanelCache",this.saveRequestMetadataToPanelCache);
this.actionsHandler.on("applyAnimationAndStateUpdateWithDefault",this.panelContainer.applyAnimationAndStateUpdateWithDefault);this.dispatch("cacheInvalidated",void 0);this.updatePanelContainerState();b=Bg(null==a?void 0:a.rufusTriggerMarkerMapping,null==a?void 0:a.pageType);(null==a?void 0:a.latencyRegressionMitigationStrategy)===oe.ShouldDelayThickClientInitialStreaming&&b&&"YourOrders"!==a.pageType?Cg(this.startInitialStreamingCallback,a.rufusLatencyMarkerFallbackTimeout,b,oe.ShouldDelayThickClientInitialStreaming):
this.startInitialStreamingCallback();this.initializeAutoMinimizeToggleSwitch();c.addEventListener("hashchange",function(){f.cacheManager.setPreviousPageUrl()});Pa(this.panelContainer.getPanelViewContext().pageType)===xa.SEARCH_RESULTS&&this.registerSearchPageAjaxEventHandler();this.textInput.setFocus();c.addEventListener("pagehide",function(){f.terminateOngoingStreaming();Oa.getInstance().setSearchFilterContext(null)});c.addEventListener("offline",this.handleOfflineError);c.addEventListener("online",
this.handleOnlineEvent);this.initializeTwisterStateChange()}},{key:"handleBfCacheNavigation",value:function(){this.isBfcacheNavigation=!0;this.streamingLifecycleEventLogger.setIsBfcacheNavigation(!0);this.streamingClient.setIsBfcacheNavigation(!0);this.conversationList.refreshOnBfCacheNavigation();this.scrollingUtil.refreshOnBfCacheNavigation();this.textInput.refreshOnBfCacheNavigation()}},{key:"shouldSkipStreamingOnSearchResults",value:function(){var a=ta.getInstance().getWeblabTreatment("RUFUS_DESKTOP_TEASER_WIDGET_1017061"),
b=ta.getInstance().getWeblabTreatment("RUFUS_DESKTOP_TEASER_RECOVERY_WIDGET_1148246");return this.isEligibleToShowTeaser(!1)&&!0===this.streamingClient.getIsRufusStayBehaviorRequired()&&"C"!==a&&"T1"===b}},{key:"recoverInterruptedConversationFromHistory",value:(f=A(P().mark(function X(a){var b;return P().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return m.addCount(p.FETCH_HISTORY_INTERRUPTION_RECOVERY,1),c.next=1,this.historyClient.fetchHistory(0,a);case 1:(b=c.sent)?this.conversationList.modifyContent(za.ReplaceInterruptedConversation,
b):(this.conversationList.dismissInterruptionRecoverySpinnerAndShowButton(),m.addCount(p.INTERRUPTION_RECOVERY_FAILED,1));case 2:case "end":return c.stop()}},X,this)})),function(a){return f.apply(this,arguments)})},{key:"fetchHistory",value:(r=A(P().mark(function Ha(a){var b,c;return P().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return m.addCount(p.FETCH_HISTORY,1),this.conversationList.startTopLoading(),this.conversationList.toggleLoadMoreHistoryButtonElementVisibility(!1),(b=this.historyClient.isFirstTimeLoadHistory())&&
m.addCount(p.FIRST_TIME_FETCH_HISTORY,1),f.next=1,this.historyClient.fetchHistory(b?this.conversationList.getNumberOfConversationTurns():0);case 1:c=f.sent,this.conversationList.modifyContent(a,c,b);case 2:case "end":return f.stop()}},Ha,this)})),function(a){return r.apply(this,arguments)})},{key:"replaceCache",value:(g=A(P().mark(function Da(a){var b;return P().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=1,this.historyClient.fetchHistory(0);case 1:b=c.sent,a?this.conversationList.modifyContent(za.ReplaceHistory,
b):this.conversationList.modifyContent(za.ReplaceActive,b);case 2:case "end":return c.stop()}},Da,this)})),function(a){return g.apply(this,arguments)})},{key:"determineAutoMinimizeState",value:function(){var a,b=null===(a=this.cacheManager.getPanelState())||void 0===a?void 0:a.autoMinimize;if(null!=b)return b;a=ta.getInstance().getWeblabTreatment("RUFUS_DESKTOP_DISABLE_AUTOMINIMIZE_LAUNCH_1260409");return a&&m.recordTrigger("RUFUS_DESKTOP_DISABLE_AUTOMINIMIZE_LAUNCH_1260409",a),"T1"!==a}},{key:"terminateOngoingStreaming",
value:function(){this.streamingClient.abortCurrentStream($c.PAGE_NAVIGATION);this.conversationList.toggleLoaderAndUpdateAnnouncer(Ya.Hidden)}},{key:"handleStreamingInterruption",value:function(){var a;this.conversationList.getInterruptionRecoveryContainer()&&this.conversationList.checkInterruptionRecoveryButtonVisibility()&&(this.conversationList.moveInterruptionRecoveryContainerOutOfConversation(),this.updateCache());var b=null===(a=this.cacheManager.getPanelState())||void 0===a?void 0:a.requestContext;
b&&!b.requestCompleted&&0===this.conversationList.getRemovableSectionsFromLatestActiveTurn().length&&(this.conversationList.getInterruptionRecoveryContainer()?(a=b.requestId)&&(this.conversationList.moveInterruptionRecoveryContainerToConversation(a),this.scrollingUtil.scrollToBottom()):(a=document.createElement("div"),a.innerHTML="Response interrupted",a.className="rufus-interrupted-stream-text",b=document.createElement("div"),b.classList.add("rufus-interrupted-stream-affordance"),b.appendChild(a),
this.conversationList.modifyContent(za.InsertIntoLastActiveTurn,b.outerHTML)),this.cacheManager.setPanelRequestCompleted(!0),this.updateCache())}}]);var g,r,f}(Ia),Dg=x(function h(){z(this,h)});a(Dg,"recordAssetsLoad",function(){var a,b;if(null!==(a=c.performance)&&void 0!==a&&a.getEntriesByType){var g=["RufusPanelWebAssets","RufusCriticalAssets"];(null===(b=performance)||void 0===b?void 0:b.getEntriesByType("resource")).filter(function(a){return a.name.includes(".js")&&g.some(function(b){return a.name.includes(b)})}).forEach(function(a){var b=
Date.now(),c=a.transferSize<a.encodedBodySize;c=0===a.transferSize||c;var f=g.find(function(b){return a.name.includes(b)});f+=c?"Cached":"Cold";m.addCount("".concat(f,"JS"),1);m.widgetBodyBegin("".concat(f,"JSLoadTime"),b);m.widgetBodyEnd("".concat(f,"JSLoadTime"),!1,b+a.duration)})}});var Yi=function(b){function c(b){z(this,c);var f=c;var h=(f=v(f),C(this,of()?Reflect.construct(f,[],v(this).constructor):f.apply(this,void 0)));return a(h,"queue",[]),a(h,"isAnimating",!1),a(h,"typewriterAnimationDelay",
125),h.scrollingUtil=b,h}return N(c,b),x(c,[{key:"setViewState",value:function(a){this.panelState=a}},{key:"enqueueAnimation",value:function(a){this.queue.push(a);this.isAnimating||this.animateNextSection()}},{key:"getQueue",value:function(){return this.queue}},{key:"getIsAnimating",value:function(){return this.isAnimating}},{key:"stopAnimating",value:function(){this.isAnimating=!1;this.queue=[]}},{key:"prepareSectionForReplaceAnimation",value:function(a,b){var c=parseInt(a.dataset.currentAnimatedKey||
"0");a=b.querySelectorAll("key, .rufus-markdown-animation-support");a=Ca(Array.from(a).reduce(function(a,b,f){return(f>c-1?a[0]:a[1]).push(b),a},[[],[]]),2);b=a[1];this.hideElements(a[0]);Ub(b)}},{key:"prepareSectionForAppendAnimation",value:function(a){var b=Array.from(a.querySelectorAll("key, .rufus-markdown-animation-support"));this.hideElements(b);a.classList.add("rufus-visibility-hidden")}},{key:"animateNextSection",value:function(){var a=this,b=this.queue.shift();if(void 0!==b){this.isAnimating=
!0;var c=b();0===this.queue.length&&this.dispatch("animationQueueComplete",void 0);c?Bd(c,function(){a.animateSection(c);0===a.queue.length&&a.dispatch("allAnimationsInQueueComplete",void 0)}):this.animateNextSection()}else this.isAnimating=!1}},{key:"animateSection",value:function(a){var b=this,c=parseInt(a.dataset.currentAnimatedKey||"0"),h=this.panelState&&"expanded"===this.panelState.viewState;h||(Ub([a]),function(a){for(var b=function(){var b=f[c];a.querySelectorAll("."+b).forEach(function(a){a.classList.remove(b)})},
c=0,f=["fade-in","rufus-fade-in","rufus-web-fade-in"];c<f.length;c++)b()}(a));Array.from(a.querySelectorAll("button.rufus-pill")).forEach(function(a){var b=ta.getInstance().getWeblabTreatment("RUFUS_DESKTOP_RQ_PILL_RESIZE_EXPERIMENT_1146390");b&&(m.recordTrigger("RUFUS_DESKTOP_RQ_PILL_RESIZE_EXPERIMENT_1146390",b),"T1"===b&&a.classList.add("rufus-related-question-pill-resize-experiment"))});var g=Array.from(a.querySelectorAll("key, .rufus-markdown-animation-support"));if(this.scrollingUtil.autoScroll(),
this.showElement(a),g.forEach(function(a){(a.classList.contains("rufus-related-question-pill")||a.classList.contains("rufus-web-related-question-pill"))&&Af(a,gf())}),c<g.length)if(this.showElement(g[c]),c++,a.dataset.currentAnimatedKey=c.toString(),h)setTimeout(function(){return b.animateSection(a)},this.typewriterAnimationDelay);else{for(;c<g.length;c++)this.showElement(g[c]);this.cleanUpAnimationsAndDispatchCacheEvent(a,g);this.animateNextSection()}else{if(!h)return this.cleanUpAnimationsAndDispatchCacheEvent(a,
g),void this.animateNextSection();var l;(a&&"function"==typeof a.getAnimations?l=a.getAnimations({subtree:!0}):m.logErrorWithLevel(H.WARN,"The section element does not support getAnimations."),l&&0<l.length)?(c=l[l.length-1],h=c.currentTime,l=c.effect,l=null==l?void 0:l.getTiming().duration,null!=h&&null!=l&&h<l?c.finished.finally(function(){b.cleanUpAnimationsAndDispatchCacheEvent(a,g);b.animateNextSection()}).catch(function(a){a&&"name"in a&&"AbortError"!==a.name&&m.logErrorWithLevelWithException(H.ERROR,
a,"[AnimationUtil.animateSection] exception thrown from currentAnimation.finished promise")}):(this.cleanUpAnimationsAndDispatchCacheEvent(a,g),this.animateNextSection())):(this.cleanUpAnimationsAndDispatchCacheEvent(a,g),this.animateNextSection())}}},{key:"cleanUpAnimationsAndDispatchCacheEvent",value:function(a,b){Ub([a]);Ub(b);this.dispatch("sectionAnimationComplete",void 0)}},{key:"showElement",value:function(a){a.classList.remove("rufus-visibility-hidden")}},{key:"hideElements",value:function(a){a.forEach(function(a){a.classList.add("rufus-visibility-hidden")})}}])}(Ia),
Zi=function(){return x(function l(){z(this,l)},null,[{key:"cleanup",value:function(){sessionStorage.removeItem(fc.panel.key);var a=document.getElementById("nav-rufus-disco"),b=document.getElementById("nav-flyout-rufus");null==a||a.remove();null==b||b.remove()}}])}(),$i=function(){return x(function l(){z(this,l)},null,[{key:"recordLatencyStats",value:function(a,b,c){var f=this.calculateInterSectionLatencyStats(a);a=f.min;var g=f.max,l=f.avg;f=f.median;var r=Date.now();null!=a&&null!=g&&null!=l&&null!=
f&&(m.widgetBodyBegin("".concat(b,"_MIN_").concat(c,"_LATENCY"),r),m.widgetBodyEnd("".concat(b,"_MIN_").concat(c,"_LATENCY"),!1,r+a),m.widgetBodyBegin("".concat(b,"_MAX_").concat(c,"_LATENCY"),r),m.widgetBodyEnd("".concat(b,"_MAX_").concat(c,"_LATENCY"),!1,r+g),m.widgetBodyBegin("".concat(b,"_AVG_").concat(c,"_LATENCY"),r),m.widgetBodyEnd("".concat(b,"_AVG_").concat(c,"_LATENCY"),!1,r+l),m.widgetBodyBegin("".concat(b,"_MEDIAN_").concat(c,"_LATENCY"),r),m.widgetBodyEnd("".concat(b,"_MEDIAN_").concat(c,
"_LATENCY"),!1,r+f))}},{key:"calculateInterSectionLatencyStats",value:function(a){if(2>a.length)return{};a.sort(function(a,b){return a-b});for(var b=[],c=1;c<a.length;c++)b.push(a[c]-a[c-1]);b.sort(function(a,b){return a-b});a=b.reduce(function(a,b){return a+b},0)/b.length;return{min:b[0],median:b[Math.ceil(.5*(b.length-1))],max:b[b.length-1],avg:a}}}])}(),aj=function(){return x(function l(){z(this,l)},null,[{key:"validateAndRecordLatencyStats",value:function(a,b,c,g){b&&a.length-1!==b||1<a.length&&
$i.recordLatencyStats(a,c,g)}},{key:"recordAllLatencyStats",value:function(a,b,c,g){var f=this;this.validateAndRecordLatencyStats(a.renderingTimestamps,c,g,"RENDER");this.validateAndRecordLatencyStats(a.networkTimestamps,c,g,"ROUND_TRIP_NETWORK");this.validateAndRecordLatencyStats(a.backendTimestamps,c,g,"BACKEND");b.forEach(function(a,b){f.validateAndRecordLatencyStats(a.renderingTimestamps,void 0,g,"".concat(b,"_RENDER"));f.validateAndRecordLatencyStats(a.networkTimestamps,void 0,g,"".concat(b,
"_ROUND_TRIP_NETWORK"));f.validateAndRecordLatencyStats(a.backendTimestamps,void 0,g,"".concat(b,"_BACKEND"))})}},{key:"batchRecordLatencyMarkersMetrics",value:function(a){var b=this,c=new og,g=new Map,l=a.requestStartTime;if(l&&a.backendProcessingStartTime){c.renderingTimestamps.push(l);c.networkTimestamps.push(l);c.backendTimestamps.push(a.backendProcessingStartTime);var m=a.patchMap,p=a.cxType,t=0;Object.entries(m).forEach(function(f){f=Ca(f,2);var r=f[0];f=f[1];var v=f.tagType,x="".concat(f.tagType,
"_").concat(f.occurrenceCount);if(null!=v){var F,A,z,C,E;r=b.getSectionStartTime(Number(r),m);var q=f.backendProcessingEndTime,D=a.backendProcessingStartTime,Z=f.renderEndTime,G=null!==(F=g.get(v))&&void 0!==F?F:g.set(v,new og).get(v);null!=Z&&(c.renderingTimestamps.push(Z),null==G||G.renderingTimestamps.push(Z));null!=r&&(c.networkTimestamps.push(r),null==G||G.networkTimestamps.push(r));null!=q&&(c.backendTimestamps.push(q),null==G||G.backendTimestamps.push(q));b.recordTagLevelLatency(x,p,l,r,Z,
D,q,null===(A=a.generationModelMetadata)||void 0===A?void 0:A.agentName);b.recordTagLevelLatency(v,p,l,r,Z,D,q,null===(z=a.generationModelMetadata)||void 0===z?void 0:z.agentName);1!==f.occurrenceCount?b.recordTagLevelLatency("".concat(v,"_SUBSEQUENT"),p,l,r,Z,D,q,null===(C=a.generationModelMetadata)||void 0===C?void 0:C.agentName):0==t&&b.recordTagLevelLatency("".concat(v,"_TOP_TAG"),p,l,r,Z,D,q,null===(E=a.generationModelMetadata)||void 0===E?void 0:E.agentName);t++}});this.recordAllLatencyStats(c,
g,t,p)}}},{key:"recordCsmTagLevelLatencyMetrics",value:function(a,b,c,g){if(m.widgetBodyBegin(a,b),m.widgetBodyEnd(a,!1,c),g)a="".concat(g,"-").concat(a),m.widgetBodyBegin(a,b),m.widgetBodyEnd(a,!1,c)}},{key:"recordTagLevelLatency",value:function(a,b,c,g,m,p,t,v){this.recordCsmTagLevelLatencyMetrics("".concat(a,"_").concat(b,"_RENDER_LATENCY"),c,m,v);this.recordCsmTagLevelLatencyMetrics("".concat(a,"_").concat(b,"_NETWORK_LATENCY"),c,g,v);this.recordCsmTagLevelLatencyMetrics("".concat(a,"_").concat(b,
"_RENDER_NETWORK_LATENCY"),g,m,v);this.recordCsmTagLevelLatencyMetrics("".concat(a,"_").concat(b,"_BACKEND_LATENCY"),p,t,v);this.recordBackendFEDeltaLatency(a,b,c,g,p,t,v)}},{key:"getSectionStartTime",value:function(a,b){if(0==a)return b[String(a)].renderStartTime;for(var c=a,g=--c;null!=b[c]&&null==b[c].backendProcessingEndTime&&0<c;)g=c,c--;return null!=b[c]&&null==b[c].backendProcessingEndTime?b[String(c)].renderStartTime:null!=b[g]&&null==b[g].backendProcessingEndTime?b[String(g)].renderStartTime:
b[String(a)].renderStartTime}},{key:"recordBackendFEDeltaLatency",value:function(a,b,c,g,m,p,t){if(g&&p&&m){var f=Date.now();c=g-c-(p-m);this.recordCsmTagLevelLatencyMetrics("".concat(a,"_").concat(b,"_BACKEND_FE_DELTA"),f,f+c,t)}}}])}(),fd=function(a){return a.REQUEST_START="request-start",a.REQUEST_INTERRUPTED="request-interrupted",a.RENDER_START="render-start",a.RENDER_END="render-end",a}({}),Ab=function(a){return a.INPUT_BOX="inputBox",a.SWIPE_UP="swipeUp",a.RELATED_QUESTION_PILLS="relatedQuestionPills",
a.NAVIGATION="navigation",a.RETRY_BUTTON="retryButton",a.ASIN_CLICK="asinClick",a}({}),Bb=function(a){return a.MESSAGE_FTUX="message-ftux",a.MESSAGE_RUX="message-rux",a.INFERENCE_PILLS="inference-pills",a.INFERENCE_ANSWERING="inference-answering",a.CURATED="curated",a.AFFORDANCE="affordance",a}({}),Eg=function(a){return a.ASIN_FACEOUT="AsinFaceout",a}(Eg||{}),Fg=function(a){return a.ASIN_RECOMMENDATIONS="ASINRecommendations",a}(Fg||{}),bj=function(){return x(function r(b){var c=this;z(this,r);a(this,
"reset",function(){c.state=new pg(c.tabId)});this.tabId=b;this.isBfcacheNavigation=!1;this.state=new pg(b)},[{key:"setIsBfcacheNavigation",value:function(a){this.isBfcacheNavigation=a}},{key:"startStreamingRequest",value:function(a){this.state.requestInterrupted&&this.sendCSA_BIMetric(this.state.activeChunkType);m.addCount(ha.STREAM_START,1);this.reset();null!=a?(this.state.trigger=a,this.state.latencyData.requestStartTime=Date.now()):m.addCount(ha.STREAM_WITHOUT_ACTION,1)}},{key:"openStreamingRequest",
value:function(){m.addCount(ha.SSE_STREAM_OPEN,1);this.logCSMLatency(ha.SSE_STREAM_OPEN)}},{key:"closeStreamingRequest",value:function(){m.addCount(ha.SSE_STREAM_CLOSE,1);this.logCSMLatency(ha.SSE_STREAM_CLOSE)}},{key:"handleRequestInterrupted",value:function(a){this.state.requestInterrupted||(m.addCount(ha.STREAM_INTERRUPTION,1),this.state.interruptionReason=a,this.logCSMLatency(ha.STREAM_INTERRUPTION),this.state.requestInterrupted=!0,this.state.latencyData.requestInterruptTime=Date.now(),O(G.CONVERSATION_ABANDONMENT,
a))}},{key:"handleStreamError",value:function(a,b){this.state.requestInterrupted||(m.addCount(ha.STREAM_ERROR,1),m.logErrorWithLevel(H.ERROR,"Stream closed due to error. InterruptionReason: ".concat(a,", ResponseCode: ").concat(b)),this.state.interruptionReason=a,this.logCSMLatency(ha.STREAM_ERROR),this.state.requestInterrupted=!0,this.state.latencyData.requestInterruptTime=Date.now())}},{key:"setChunkReceived",value:function(a,b){var c,g=2<arguments.length&&void 0!==arguments[2]&&arguments[2];a.data&&
(this.state.latencyData.activeChunk.renderStartTime=Date.now(),this.state.activeChunkType=a.type,g&&(c=a.data,!/^\s*</.test(c))?this.updateStreamStateFromEventDataV2(a):this.updateStreamStateFromEventData(a),this.state.isUplChunk=this.getIsUplMeasure(a.type),this.state.isUplChunk)&&(c=this.getUplType(a,b))&&this.logCSMLatency(c+ha.RECEIVE_SUFFIX,!0)}},{key:"setChunkReceivedV2",value:function(a,b){a.data&&(this.state.latencyData.activeChunk.renderStartTime=Date.now(),this.state.activeChunkType=a.type,
this.updateStreamStateFromEventDataV2(a),this.state.isUplChunk=this.getIsUplMeasure(a.type),this.state.isUplChunk)&&(a=this.getUplType(a,b))&&this.logCSMLatency(a+ha.RECEIVE_SUFFIX,!0)}},{key:"emitStreamRenderEnd",value:function(){this.logCSMLatency(ha.STREAM_LAST_RENDERED_CHUNK,!0)}},{key:"recordSectionRenderEnd",value:function(a,b,c,g){var f=Date.now();this.recordFirstInferenceChunkRenderLatency(a);0===c&&this.emitChunkFirstSectionRenderEndMetrics(a,b,f);g&&(this.emitChunkLastSectionRenderEndMetric(a),
this.recordPatchRenderEnd(f),this.batchRecordLatencyOnceLastPatchWasProcessed())}},{key:"recordFirstInferenceChunkRenderLatency",value:function(a){a.type!==V.INFERENCE||this.state.latencyData.firstInferenceChunkProcessed||(this.logCSMLatency(ha.FIRST_INFERENCE_CHUNK_RENDER_SUFFIX,!0),this.state.latencyData.firstInferenceChunkProcessed=!0)}},{key:"recordPatchRenderEnd",value:function(a){var b=this;this.state.activeChunkPatchIds.forEach(function(c){(c=b.state.latencyData.patchMap[c])&&(c.renderEndTime=
a)})}},{key:"emitChunkFirstSectionRenderEndMetrics",value:function(a,b,c){if(a.data){var f=this.isBfcacheNavigation?rg.configName:bd.configName;f=zb.getInstance().getLogger(f);(f&&!f.markerProcessed("initial_streaming_first_chunk_received")&&(f.setMarker("initial_streaming_first_chunk_received"),f.emitMetrics()),this.state.latencyData.activeChunk.renderEndTime=c,this.state.isUplChunk)&&(c=this.getUplType(a,b))&&this.logCSMLatency(c+ha.RENDER_SUFFIX,!0);this.state.isRequestTriggerUplLogged||(b=this.getRequestTriggerValue(b,
a))&&(this.state.isRequestTriggerUplLogged=!0,this.logCSMLatency(b+ha.RENDER_SUFFIX,!0));this.logCSMLatency(a.type+ha.CHUNK_FIRST_SECTION_RENDER_SUFFIX,!0);this.sendCSA_BIMetric(a.type)}}},{key:"emitChunkLastSectionRenderEndMetric",value:function(a){a.data&&this.logCSMLatency(a.type+ha.CHUNK_LAST_SECTION_RENDER_SUFFIX,!0)}},{key:"sendCSA_BIMetric",value:function(a){var b,f;a={nileRequestId:pb.getInstance().nileRequestId,groupId:this.state.groupId,sequenceId:this.state.sequenceId,contentId:this.state.contentId,
slotId:this.state.slotId,requestType:null!==(b=this.state.trigger)&&void 0!==b?b:U.UNKNOWN,interruptionReason:null!==(f=this.state.interruptionReason)&&void 0!==f?f:"",chunkType:null!=a?a:"unknown"};b=c.csa?c.csa("Content",{element:a}):void 0;b&&(b("mark",fd.REQUEST_START,this.state.latencyData.requestStartTime),b("mark",fd.RENDER_START,this.state.latencyData.activeChunk.renderStartTime),b("mark",fd.RENDER_END,this.state.latencyData.activeChunk.renderEndTime),this.state.latencyData.requestInterruptTime&&
b("mark",fd.REQUEST_INTERRUPTED,this.state.latencyData.requestInterruptTime))}},{key:"logCSMLatency",value:function(a){var b,c=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(this.state.latencyData.requestStartTime){m.widgetBodyBegin(a,this.state.latencyData.requestStartTime);m.widgetBodyEnd(a,!1);var g=null===(b=this.state.latencyData.generationModelMetadata)||void 0===b?void 0:b.agentName;c&&g&&(b="".concat(g,"-").concat(a),m.widgetBodyBegin(b,this.state.latencyData.requestStartTime),
m.widgetBodyEnd(b,!1))}}},{key:"getUplType",value:function(a,b){var c;switch(a.type){case V.MESSAGE:return"SEEN"===(null===(c=b.requestContext)||void 0===c||null===(c=c.impressionsContext)||void 0===c?void 0:c.FIRST_TIME_USER_MESSAGE_SEEN_STATUS)?Bb.MESSAGE_RUX:Bb.MESSAGE_FTUX;case V.CURATED_ANSWER:return Bb.CURATED;case V.AFFORDANCE:return Bb.AFFORDANCE;case V.INFERENCE:return b.isInitialStream&&!0!==this.state.isQuestionAnswering?Bb.INFERENCE_PILLS:Bb.INFERENCE_ANSWERING}}},{key:"updateStreamStateFromEventData",
value:function(a){var b=this.createTempElement(a.data);this.updateStateFromSection(b);this.handleTelemetryData(b,a);this.handleGenerationModelMetadata(b)}},{key:"handleGenerationModelMetadata",value:function(a){a=a.querySelector('script[type\x3d"a-state"][data-a-state*\x3d"generationModelMetadata"]');var b=this.state.latencyData.generationModelMetadata;if(a&&(!b||!b.agentName))try{this.state.latencyData.generationModelMetadata=JSON.parse(a.innerHTML)}catch(f){m.logErrorWithLevelWithException(H.ERROR,
f,"".concat("StreamingLifecycleEventLogger"," - Error parsing event Generation Model Metadata:"))}}},{key:"handleTelemetryData",value:function(a,b){var c;b.type===V.REMOVE&&(c={chunk:{2:{last:!1}}});if(a=a.querySelector('script[type\x3d"a-state"][data-a-state*\x3d"telemetryInfo"]'))try{c=JSON.parse(a.innerHTML)}catch(F){m.logErrorWithLevelWithException(H.ERROR,F,"".concat("StreamingLifecycleEventLogger"," - Error parsing event telemetry data:"))}this.processEventTelemetryData(c)}},{key:"updateStateFromSection",
value:function(a){var b,c,g,l;(a=a.querySelector('[id^\x3d"section_groupId_"]'))&&(this.state=rf(rf({},this.state),{},{groupId:null!==(b=a.getAttribute("data-csa-c-group-id"))&&void 0!==b?b:"",sequenceId:null!==(c=a.getAttribute("data-csa-c-sequence-id"))&&void 0!==c?c:"",contentId:null!==(g=a.getAttribute("data-csa-c-content-id"))&&void 0!==g?g:"",slotId:null!==(l=a.getAttribute("data-csa-c-slot-id"))&&void 0!==l?l:""}))}},{key:"createTempElement",value:function(a){var b=document.createElement("div");
return b.innerHTML=a,b}},{key:"updateStreamStateFromEventDataV2",value:function(a){var b,c=this,g=ug.parseEventData(a);null==g||null===(b=g.sections)||void 0===b||b.forEach(function(b){var f;"HTML"===(null==b||null===(f=b.content)||void 0===f?void 0:f.format)&&(b=c.createTempElement(b.content.data),c.updateStateFromSection(b),c.handleTelemetryData(b,a),c.handleGenerationModelMetadata(b))})}},{key:"isFtuxPlaceholderChunk",value:function(a){var b=document.createElement("div");b.innerHTML=a.data;a=b.querySelector('[id^\x3d"section_groupId_"]');
return!!a&&"PlaceholderMessage"===a.getAttribute("data-section-class")}},{key:"getIsUplMeasure",value:function(a){switch(a){case V.MESSAGE:if(!this.state.chunkFirstReceivedMap.has(V.MESSAGE))return this.state.chunkFirstReceivedMap.set(V.MESSAGE,!0),!0;break;case V.CURATED_ANSWER:if(!this.state.chunkFirstReceivedMap.has(V.CURATED_ANSWER))return this.state.chunkFirstReceivedMap.set(V.CURATED_ANSWER,!0),!0;break;case V.AFFORDANCE:if(!this.state.chunkFirstReceivedMap.has(V.AFFORDANCE))return this.state.chunkFirstReceivedMap.set(V.AFFORDANCE,
!0),!0;break;case V.INFERENCE:if(!this.state.chunkFirstReceivedMap.has(V.INFERENCE))return this.state.chunkFirstReceivedMap.set(V.INFERENCE,!0),!0}return!1}},{key:"getRequestTriggerValue",value:function(a,b){var c,g;if(V.AFFORDANCE!==b.type){if(b.type!==V.MESSAGE||!this.isFtuxPlaceholderChunk(b))switch(this.state.trigger){case U.SEARCH:if(a.isInitialStream)return!0===this.state.isQuestionAnswering?Ab.NAVIGATION:Ab.ASIN_CLICK;var l;if((null===(c=a.requestContext)||void 0===c||null===(c=c.queryContext)||
void 0===c?void 0:c.qis)===ua.NILE_RELATED_QUESTION||(null===(g=a.requestContext)||void 0===g||null===(g=g.queryContext)||void 0===g?void 0:g.qis)===ua.NILE_DEALS_RELATED_QUESTION)return(null===(l=a.requestContext)||void 0===l?void 0:l.queryContext.qis)===ua.NILE_DEALS_RELATED_QUESTION&&m.addCount(p.RUFUS_DEALS_PILL_PRESENTED,1),Ab.RELATED_QUESTION_PILLS;if(a.inputQuery&&0<a.inputQuery.length)return Ab.INPUT_BOX;break;case U.SWIPE_UP:return Ab.SWIPE_UP;case U.ASIN_CLICK:return Ab.ASIN_CLICK}}else this.state.isQuestionAnswering=
!0}},{key:"processEventTelemetryData",value:function(a){a?(this.state.activeChunkPatchIds=Object.keys(a.chunk),this.processChunkTelemetryData(a.chunk),a.backfill&&this.processChunkBackfillData(a.backfill)):this.state.activeChunkPatchIds=[]}},{key:"processChunkTelemetryData",value:function(a){for(var b in a)b in this.state.latencyData.patchMap||(this.state.latencyData.patchMap[b]={isLast:a[b].last,renderStartTime:this.state.latencyData.activeChunk.renderStartTime})}},{key:"processChunkBackfillData",
value:function(a){for(var b in a)if(b in this.state.latencyData.patchMap){var c=a[b],g=this.state.latencyData.patchMap[b];g.tagType=c.tagType;g.backendProcessingEndTime=c.lastCompletedPatchProcessedAt;g.occurrenceCount=c.occurrenceCount;this.state.latencyData.backendProcessingStartTime||(this.state.latencyData.backendProcessingStartTime=c.processingStartedAt);c.tagType==Eg.ASIN_FACEOUT&&(this.state.latencyData.cxType=Fg.ASIN_RECOMMENDATIONS);this.state.latencyData.cxType||(this.state.latencyData.cxType=
c.cxType)}else m.addCount(p.UNKNOWN_PATCH_ID_IN_BACKFILL_DATA,1)}},{key:"batchRecordLatencyOnceLastPatchWasProcessed",value:function(){var a,b=function(a,b){var c="undefined"!=typeof Symbol&&a[Symbol.iterator]||a["@@iterator"];if(!c){if(Array.isArray(a)||(c=function(a,b){if(a){if("string"==typeof a)return pf(a,b);var c={}.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?
pf(a,b):void 0}}(a))||b&&a&&"number"==typeof a.length){c&&(a=c);var f=0;b=function(){};return{s:b,n:function(){return f>=a.length?{done:!0}:{done:!1,value:a[f++]}},e:function(a){throw a;},f:b}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var g,l=!0,m=!1;return{s:function(){c=c.call(a)},n:function(){var a=c.next();return l=a.done,a},e:function(a){m=!0;g=a},f:function(){try{l||null==c.return||
c.return()}finally{if(m)throw g;}}}}(this.state.activeChunkPatchIds);try{for(b.s();!(a=b.n()).done;)if(this.isLastJsonPatch(this.state.latencyData.patchMap[a.value])){aj.batchRecordLatencyMarkersMetrics(this.state.latencyData);this.state.latencyData.patchMap={};break}}catch(f){b.e(f)}finally{b.f()}}},{key:"isLastJsonPatch",value:function(a){return a&&a.isLast&&null!=a.backendProcessingEndTime}}])}(),cj=function(){var a=A(P().mark(function F(a,b){var f,h,g,r,t,v,x,A,z,C,D,E,J,q,M,N,R,Q,T,V,W,S,Y,U;
return P().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if((g=ta.getInstance().getWeblabTreatment("TEST_1056934"))&&m.recordTrigger("TEST_1056934",g),r=function(a){return a===ub.AUTHENTICATED},(t=rh.getInstance()).on("authStatusChanged",function(a){r(a)||Zi.cleanup()}),r(t.checkAuthStatus())){F.next=1;break}return F.abrupt("return");case 1:if(gb.initialize(),document.getElementById("rufus-container")||m.logErrorWithLevel(H.ERROR,"RufusPanelWebAssets is initializing without rufus-container."),
(v=new Ui).areAllFeaturesSupported()){F.next=2;break}return m.addCount(p.RUFUS_INSUFFICIENT_BROWSER_CAPABILITIES,1),gb.renderError({errorCode:nb.INSUFFICIENT_BROWSER_CAPABILITIES}),F.abrupt("return");case 2:if(b.hasRufusPanelAutoMinimized&&O(G.PANEL_RESIZE_RUFUS,ia.EXPANDED_TO_MINIMIZED),x=new sh(b.uniqueId,b.cacheEnabled),Ae.getInstance().tabId=x.getTabId(),Db(),A=new Ni,z=new Oi(a),C=new Bf(a,x.getTabId()),D=new Wi(z),E=new Yi(D),J=new bj(x.getTabId()),q=new Hi(E,J,x),M=new Qi,N=new Si(z,x,q),R=
K.extractQueryFromUrl(K.getCurrentPageUrl()),Pa(z.getPanelViewContext().pageType)!==xa.SEARCH_RESULTS){F.next=3;break}return F.next=3,ka.when("s-metadata").execute(function(a){N.setIsRufusStayBehaviorRequired(a.isRufusStayBehaviorRequired);R||N.setSearchBarQuery(a.keywords)});case 3:return Q=new sg(a,N,x.getTabId(),J),T=new dd(a,N,z),V=new Di(a),new Pi(a),W=new qh(Q),S=new Xi(x,C,q,z,Q,M,A,T,D,E,V,W,J,v),b.isJSMigration&&((new Ti(z,S)).init(),Li()),S.initialize(b),Y=function(){c.P&&(ka.declare("rufus-thick-client",
!0),ka.declare("rufus-stream",function(a){S.stream(a);Gg(z)}),ka.declare("rufus-expand",function(){Gg(z)}),Dg.recordAssetsLoad())},(null==b?void 0:b.thickClientLoaded)&&(null==b||b.thickClientLoaded()),U=bd.configName,null===(f=zb.getInstance().getLogger(U))||void 0===f||f.setMarker("initialized"),null===(h=zb.getInstance().getLogger(U))||void 0===h||h.emitMetrics(),F.abrupt("return",{conversationOrchestrator:S,panelContainer:z,callback:Y});case 4:case "end":return F.stop()}},F)}));return function(b,
c){return a.apply(this,arguments)}}(),Gg=function(a){var b=a.getPanelContainerState().viewState;a.applyAnimationAndStateUpdate(b,"expanded")},pe=function(){var a=A(P().mark(function F(a,b){var f;return P().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return ka.now("rufus-panel-first-visible").execute(function(a){void 0!==a&&zb.getInstance().initialize(bd,a)}),g.next=1,cj(a,b);case 1:(f=g.sent)&&f.callback(),c.addEventListener("pageshow",function(a){a.persisted&&(null==f||f.panelContainer.updateStateAndContent(),
(null==f?void 0:f.panelContainer.isPanelClosed())||zb.getInstance().initialize(rg),null==f||f.conversationOrchestrator.handleBfCacheNavigation(),null==f||f.conversationOrchestrator.startInitialStreamingCallback())});case 2:case "end":return g.stop()}},F)}));return function(b,c){return a.apply(this,arguments)}}();c.P&&(ka.when("A","sp.load.rufus.critical.assets.js","sp.load.rufus.panel.assets.js","rufus-common-modules").execute(function(){var a=A(P().mark(function X(a,b,c,g){var f;return P().wrap(function(h){for(;;)switch(h.prev=
h.next){case 0:return f=Cd(Cd(Cd({},b),c),{},{isJSMigration:!0},g),h.next=1,pe(a,f);case 1:case "end":return h.stop()}},X)}));return function(b,c,g,h){return a.apply(this,arguments)}}()),ka.when("A","rufus-thin-client").execute(function(){var a=A(P().mark(function F(a,b){var c,f;return P().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(c=Bg(null==b?void 0:b.rufusTriggerMarkerMapping,null==b?void 0:b.pageType),"shouldDelayThickClientInitialization"!==b.latencyRegressionMitigationStrategy||
!c||"YourOrders"===b.pageType){g.next=2;break}return f=function(){var c=A(P().mark(function Ng(){return P().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=1,pe(a,b);case 1:case "end":return c.stop()}},Ng)}));return function(){return c.apply(this,arguments)}}(),g.next=1,Cg(f,b.rufusLatencyMarkerFallbackTimeout,c,oe.ShouldDelayThickClientInitialization);case 1:g.next=3;break;case 2:return g.next=3,pe(a,b);case 3:case "end":return g.stop()}},F)}));return function(b,c){return a.apply(this,
arguments)}}()))})()}()});